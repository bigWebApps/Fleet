<html>
<head>
<title>SQL Delta Structure Comparison Report</title>
<script language="javascript">
   function ShowComparison(oLink, oDisplay) {
      if (oDisplay.style.display == 'none') {
         oDisplay.style.display = '';
         oLink.innerText = '-';
      } else {
         oDisplay.style.display = 'none';
         oLink.innerText = '+';
      }
   }
</script>
<style>
.headingtxt {font:16pt,verdana, Arial, Helvetica, sans-serif; font-weight: bold; background-color: #E8A623; color: #FFFFFF; line-height: 35px; BORDER-TOP: black 1px solid; BORDER-BOTTOM: black 1px solid}
.sectiontxt {font:12pt,verdana, Arial, Helvetica, sans-serif; font-weight: bold; color: #000000}
.datalink {font:12pt,verdana, Arial, Helvetica, sans-serif; font-weight: bold; text-decoration:none; color: blue}
.headertxt {font: 10pt, verdana, Arial, Helvetica, sans-serif; font-weight: bold; color: #000000}
.itemtxt {font: 10pt, verdana, Arial, Helvetica, sans-serif; color: #E8A623}
.bodytxt {font: 10pt, verdana, Arial, Helvetica, sans-serif; text-decoration:none; color: #000000}
.normlink {font: 10pt, verdana, Arial, Helvetica, sans-serif; text-decoration:none; color: blue}
.added {font: 10pt, verdana, Arial, Helvetica, sans-serif; color: red}
.deleted {font: 10pt, verdana, Arial, Helvetica, sans-serif; color: blue}
.smltxt {font: 8pt, Arial, Helvetica, sans-serif; color: #000000}
.modified {font: 8pt, Arial, Helvetica, sans-serif; color: red}
</style>
</head>
<body>
<P align="center" class="headingtxt">SQL Delta Structure Comparison Report</P>
<P align="left">
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="sectiontxt"><td>Databases</td></tr>
</table>
<table border="0" cellspacing="0" cellpadding="0" width="80%">
<tr height="4"><td colspan="3"></td></tr>
<tr><td width="1%"></td><td width="19%" nowrap class="itemtxt">Database A:</td><td width="80%" nowrap class="bodytxt">largo.BFS_Beta</td></tr>
<tr height="4"><td colspan="3"></td></tr>
<tr><td></td><td nowrap class="itemtxt">Database B:</td><td nowrap class="bodytxt">largo.BFS_Temp</td></tr>
<tr height="4"><td colspan="3"></td></tr>
<tr><td></td><td nowrap class="itemtxt">Comparison Date:</td><td nowrap class="bodytxt">4/17/2006</td></tr>
</table></P>
<P align="left"><div class="sectiontxt">Comparison Summary</div>
<table border="0" cellspacing="0" cellpadding="0" width="80%">
<tr height="15"><td colspan="2"></td></tr>
<tr><td width="1%"></td><td width="99%">
<table class="bodytxt" border="1" cellpadding="2" width="100%" bordercolordark="#FFFFFF">
<tr height="25" class="headertxt"><td width="30%" nowrap>Object Type</td><td width="17%" nowrap align="center">Identical</td><td width="18%" nowrap align="center">Missing From A</td><td width="18%" nowrap align="center">Missing From B</td><td width="17%" nowrap align="center">Modified</td></tr>
<tr height="25"><td nowrap><a href="#tables" class="normlink">Tables</a></td><td nowrap align="right">66&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">2&nbsp;</td></tr>
<tr height="25"><td nowrap><a href="#views" class="normlink">Views</a></td><td nowrap align="right">1&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap><a href="#procedures" class="normlink">Procedures</a></td><td nowrap align="right">148&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">72&nbsp;</td><td nowrap align="right">4&nbsp;</td></tr>
<tr height="25"><td nowrap><a href="#triggers" class="normlink">Triggers</a></td><td nowrap align="right">13&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap><a href="#functions" class="normlink">Functions</a></td><td nowrap align="right">3&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Defaults</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Rules</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>User Types</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Users</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Roles</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Full-Text Catalogs</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
</table></td></tr></table></P>
<P align="left"><div class="sectiontxt">Comparison Results</div><table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr height="8"><td colspan="2"></td></tr>
<tr height="15"><td width="1%"></td><td><a name="tables" class="itemtxt">Tables</a></td></tr>
<tr height="8"><td colspan="2"></td></tr>
<tr><td></td><td width="99%">
<table class="bodytxt" border="1" cellpadding="2" width="100%" bordercolordark="#FFFFFF">
<tr height="25" class="headertxt"><td width="5%">&nbsp;</td><td width="30%" nowrap>Name</td><td width="10%" nowrap align="center">Status</td><td width="55%" nowrap align="center">Action</td></tr>
<tr height="25"><td nowrap align="center"><a id="V0" class="bodytxt" href="javascript:ShowComparison(V0, T0)">+</a></td><td nowrap>dbo.OperatorInstructions</td><td nowrap align="center"><font class="added"><</font><font class="deleted">></font></td><td nowrap>Update on largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T0"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%">-- Table Structure</td><td width="4%" align="center">==</td><td width="48%">-- Table Structure</td></tr>
<tr><td>CREATE TABLE [dbo].[OperatorInstructions] (</td><td align="center">==</td><td>CREATE TABLE [dbo].[OperatorInstructions] (</td></tr>
<tr><td>   [OrgId] [int] NOT NULL,</td><td align="center">==</td><td>   [OrgId] [int] NOT NULL,</td></tr>
<tr><td>   [Id] [int] IDENTITY (1, 1) NOT NULL,</td><td align="center">==</td><td>   [Id] [int] IDENTITY (1, 1) NOT NULL,</td></tr>
<tr><td>   [TypeId] [int] NOT NULL,</td><td align="center">==</td><td>   [TypeId] [int] NOT NULL,</td></tr>
<tr><td>   [vchNote] [varchar] (8000) NOT NULL DEFAULT ('')</td><td align="center">==</td><td>   [vchNote] [varchar] (8000) NOT NULL DEFAULT ('')</td></tr>
<tr><td>)</td><td align="center">==</td><td>)</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>-- Indexes & Constraints</td><td align="center">==</td><td>-- Indexes & Constraints</td></tr>
<tr><td>ALTER TABLE [dbo].[OperatorInstructions] ADD CONSTRAINT [PK_OperatorInstructions] PRIMARY KEY CLUSTERED ([Id], [OrgId])</td><td align="center">==</td><td>ALTER TABLE [dbo].[OperatorInstructions] ADD CONSTRAINT [PK_OperatorInstructions] PRIMARY KEY CLUSTERED ([Id], [OrgId])</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="added"><<</font></td><td><font class="modified">-- Foreign Keys</font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="added"><<</font></td><td><font class="modified">ALTER TABLE [dbo].[OperatorInstructions] ADD CONSTRAINT [FK_OperatorInstructions_OperatorInstructionTypes] FOREIGN KEY ([TypeId], [OrgId]) REFERENCES [dbo].[OperatorInstructionTypes] ([Id], [OrgId])</font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="added"><<</font></td><td><font class="modified">GO</font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V1" class="bodytxt" href="javascript:ShowComparison(V1, T1)">+</a></td><td nowrap>dbo.OperatorInstructionTypes</td><td nowrap align="center"><font class="added"><</font><font class="deleted">></font></td><td nowrap>Update on largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T1"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%">-- Table Structure</td><td width="4%" align="center">==</td><td width="48%">-- Table Structure</td></tr>
<tr><td>CREATE TABLE [dbo].[OperatorInstructionTypes] (</td><td align="center">==</td><td>CREATE TABLE [dbo].[OperatorInstructionTypes] (</td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="added"><<</font></td><td><font class="modified">   [OrgId] [int] NOT NULL,</font></td></tr>
<tr><td>   [Id] [int] IDENTITY (1, 1) NOT NULL,</td><td align="center">==</td><td>   [Id] [int] IDENTITY (1, 1) NOT NULL,</td></tr>
<tr><td>   [vchName] [varchar] (50) NOT NULL DEFAULT ('')</td><td align="center">==</td><td>   [vchName] [varchar] (50) NOT NULL DEFAULT ('')</td></tr>
<tr><td>)</td><td align="center">==</td><td>)</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>-- Indexes & Constraints</td><td align="center">==</td><td>-- Indexes & Constraints</td></tr>
<tr><td><font class="modified">ALTER TABLE [dbo].[OperatorInstructionTypes] ADD CONSTRAINT [PK_OperatorInstructionTypes] PRIMARY KEY CLUSTERED ([Id])</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">ALTER TABLE [dbo].[OperatorInstructionTypes] ADD CONSTRAINT [PK_UserInstructionTypes] PRIMARY KEY CLUSTERED ([Id], [OrgId])</font></td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
</table></td></tr>
</table></td></tr>
<tr height="8"><td colspan="2"></td></tr>
<tr height="15"><td width="1%"></td><td><a name="procedures" class="itemtxt">Procedures</a></td></tr>
<tr height="8"><td colspan="2"></td></tr>
<tr><td></td><td width="99%">
<table class="bodytxt" border="1" cellpadding="2" width="100%" bordercolordark="#FFFFFF">
<tr height="25" class="headertxt"><td width="5%">&nbsp;</td><td width="30%" nowrap>Name</td><td width="10%" nowrap align="center">Status</td><td width="55%" nowrap align="center">Action</td></tr>
<tr height="25"><td nowrap align="center"><a id="V2" class="bodytxt" href="javascript:ShowComparison(V2, T2)">+</a></td><td nowrap>dbo.dt_addtosourcecontrol</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T2"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_addtosourcecontrol</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchSourceSafeINI varchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchProjectName   varchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment       varchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName     varchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword      varchar(255) =''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iStreamObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchDatabaseName varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @vchDatabaseName = db_name()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchParentId varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iObjectCount int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectCount = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = master.dbo.sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* Create Project in SS */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec @iReturn = master.dbo.sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											'AddProjectToSourceSafe',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@vchProjectName output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@@SERVERNAME,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@vchComment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* Set Database Properties */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    begin tran SetProperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* add high level object */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iPropertyObjectId = dbo.dt_adduserobject_vcs 'VCSProjectID'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @vchParentId = CONVERT(varchar(255),@iPropertyObjectId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSProjectID', @vchParentId , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSProject' , @vchProjectName , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSSourceSafeINI' , @vchSourceSafeINI , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSSQLServer', @@SERVERNAME, NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSSQLDatabase', @vchDatabaseName, NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @@error <> 0 GOTO E_General_Error</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    commit tran SetProperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iObjectCount = 0;</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @vchProjectName</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iObjectCount</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_General_Error:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    /* this is an all or nothing.  No specific error messages */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V3" class="bodytxt" href="javascript:ShowComparison(V3, T3)">+</a></td><td nowrap>dbo.dt_addtosourcecontrol_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T3"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_addtosourcecontrol_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchSourceSafeINI nvarchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchProjectName   nvarchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment       nvarchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName     nvarchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword      nvarchar(255) =''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- This procedure should no longer be called;  dt_addtosourcecontrol should be called instead.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- Calls are forwarded to dt_addtosourcecontrol to maintain backward compatibility</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	exec dbo.dt_addtosourcecontrol</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V4" class="bodytxt" href="javascript:ShowComparison(V4, T4)">+</a></td><td nowrap>dbo.dt_adduserobject</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T4"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Add an object to the dtproperties table</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_adduserobject</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	** Create the user object if it does not exist already</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin transaction</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert dbo.dtproperties (property) VALUES ('DtgSchemaOBJECT')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update dbo.dtproperties set objectid=@@identity</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where id=@@identity and property='DtgSchemaOBJECT'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	commit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return @@identity</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V5" class="bodytxt" href="javascript:ShowComparison(V5, T5)">+</a></td><td nowrap>dbo.dt_adduserobject_vcs</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T5"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_adduserobject_vcs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchProperty varchar(64)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    /*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    ** Create the user object if it does not exist already</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin transaction</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @iReturn = objectid from dbo.dtproperties where property = @vchProperty</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn IS NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            insert dbo.dtproperties (property) VALUES (@vchProperty)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            update dbo.dtproperties set objectid=@@identity</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    where id=@@identity and property=@vchProperty</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iReturn = @@identity</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    commit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V6" class="bodytxt" href="javascript:ShowComparison(V6, T6)">+</a></td><td nowrap>dbo.dt_checkinobject</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T6"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_checkinobject</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchObjectName varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment    varchar(255)='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   varchar(255)='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iVCSFlags     int = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iActionFlag   int = 0,   /* 0 => AddFile, 1 => CheckIn */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream1     Text = '', /* drop stream   */ /* There is a bug that if items are NULL they do not pass to OLE servers */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream2     Text = '', /* create stream */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream3     Text = ''  /* grant stream  */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iPropertyObjectId  = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @iReturnValue	  int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @pos			  int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchProcLinePiece varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            /* Procedure Can have up to three streams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            Drop Stream, Create Stream, GRANT stream */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            begin tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            /* try to compile the streams */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec (@txStream1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec (@txStream2)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec (@txStream3)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OAGetProperty @iObjectId, 'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iStreamLength int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @pos=1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @iStreamLength = datalength(@txStream2)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if @iStreamLength > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				while @pos < @iStreamLength</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @vchProcLinePiece = substring(@txStream2, @pos, 255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					exec @iReturn = master.dbo.sp_OAMethod @iStreamObjectId, 'AddStream', @iReturnValue OUT, @vchProcLinePiece</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            		if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @pos = @pos + 255</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				exec @iReturn = master.dbo.sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														'CheckIn_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@iActionFlag = @iActionFlag,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">														@sStream = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select colid, text into #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            from syscomments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            where id = object_id(@vchObjectName)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            order by colid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            declare @iCurProcLine int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iProcLines int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iCurProcLine = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iProcLines = (select count(*) from #ProcLines)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            while @iCurProcLine <= @iProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @pos = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                declare @iCurLineSize int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @iCurLineSize = len((select text from #ProcLines where colid = @iCurProcLine))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                while @pos <= @iCurLineSize</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    select @vchProcLinePiece = convert(varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                        substring((select text from #ProcLines where colid = @iCurProcLine),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                  @pos, 255 ))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    exec @iReturn = master.dbo.sp_OAMethod @iStreamObjectId, 'AddStream', @iReturnValue OUT, @vchProcLinePiece</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    select @pos = @pos + 255</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @iCurProcLine = @iCurProcLine + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            drop table #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec @iReturn = master.dbo.sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													'CheckIn_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@iActionFlag = @iActionFlag,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">													@sStream = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            commit tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_Compile_Fail:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @lerror int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @lerror = @@error</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	rollback tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	RAISERROR (@lerror,16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @iActionFlag = 1 rollback tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V7" class="bodytxt" href="javascript:ShowComparison(V7, T7)">+</a></td><td nowrap>dbo.dt_checkinobject_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T7"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_checkinobject_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchObjectName nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment    nvarchar(255)='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   nvarchar(255)='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iVCSFlags     int = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iActionFlag   int = 0,   /* 0 => AddFile, 1 => CheckIn */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream1     text = '',  /* drop stream   */ /* There is a bug that if items are NULL they do not pass to OLE servers */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream2     text = '',  /* create stream */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream3     text = ''   /* grant stream  */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- This procedure should no longer be called;  dt_checkinobject should be called instead.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- Calls are forwarded to dt_checkinobject to maintain backward compatibility.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	exec dbo.dt_checkinobject</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@chObjectType,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@iActionFlag,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@txStream1,		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@txStream2,		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@txStream3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V8" class="bodytxt" href="javascript:ShowComparison(V8, T8)">+</a></td><td nowrap>dbo.dt_checkoutobject</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T8"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_checkoutobject</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchObjectName varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment    varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iVCSFlags     int = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iActionFlag   int = 0/* 0 => Checkout, 1 => GetLatest, 2 => UndoCheckOut */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @vchTempText varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	/* this is for our strings */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iStreamObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        /* Procedure Can have up to three streams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">           Drop Stream, Create Stream, GRANT stream */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												'CheckOut_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@iActionFlag = @iActionFlag</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OAGetProperty @iObjectId, 'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        create table #commenttext (id int identity, sourcecode varchar(255))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchTempText = 'STUB'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        while @vchTempText is not null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec @iReturn = master.dbo.sp_OAMethod @iStreamObjectId, 'GetStream', @iReturnValue OUT, @vchTempText OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if (@vchTempText = '') set @vchTempText = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if (@vchTempText is not null) insert into #commenttext (sourcecode) select @vchTempText</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select 'VCS'=sourcecode from #commenttext order by id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select 'SQL'=text from syscomments where id = object_id(@vchObjectName) order by colid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V9" class="bodytxt" href="javascript:ShowComparison(V9, T9)">+</a></td><td nowrap>dbo.dt_checkoutobject_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T9"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_checkoutobject_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchObjectName nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment    nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iVCSFlags     int = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iActionFlag   int = 0/* 0 => Checkout, 1 => GetLatest, 2 => UndoCheckOut */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	-- This procedure should no longer be called;  dt_checkoutobject should be called instead.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- Calls are forwarded to dt_checkoutobject to maintain backward compatibility.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	exec dbo.dt_checkoutobject</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@chObjectType,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@iActionFlag</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V10" class="bodytxt" href="javascript:ShowComparison(V10, T10)">+</a></td><td nowrap>dbo.dt_displayoaerror</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T10"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE PROCEDURE dbo.dt_displayoaerror</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iObject int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iresult int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchOutput      varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @hr             int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchSource      varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchDescription varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @hr = master.dbo.sp_OAGetErrorInfo @iObject, @vchSource OUT, @vchDescription OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @vchOutput = @vchSource + ': ' + @vchDescription</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    raiserror (@vchOutput,16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V11" class="bodytxt" href="javascript:ShowComparison(V11, T11)">+</a></td><td nowrap>dbo.dt_displayoaerror_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T11"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE PROCEDURE dbo.dt_displayoaerror_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iObject int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iresult int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- This procedure should no longer be called;  dt_displayoaerror should be called instead.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- Calls are forwarded to dt_displayoaerror to maintain backward compatibility.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	exec dbo.dt_displayoaerror</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@iObject,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@iresult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V12" class="bodytxt" href="javascript:ShowComparison(V12, T12)">+</a></td><td nowrap>dbo.dt_droppropertiesbyid</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T12"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Drop one or all the associated properties of an object or an attribute</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_dropproperties objid, null or '' -- drop all properties of the object itself</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_dropproperties objid, property -- drop the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_droppropertiesbyid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		delete from dbo.dtproperties where objectid=@id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		delete from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V13" class="bodytxt" href="javascript:ShowComparison(V13, T13)">+</a></td><td nowrap>dbo.dt_dropuserobjectbyid</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T13"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Drop an object from the dbo.dtproperties table</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_dropuserobjectbyid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	delete from dbo.dtproperties where objectid=@id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V14" class="bodytxt" href="javascript:ShowComparison(V14, T14)">+</a></td><td nowrap>dbo.dt_generateansiname</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T14"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Generate an ansi name that is unique in the dtproperties.value column</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_generateansiname(@name varchar(255) output)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @prologue varchar(20)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @indexstring varchar(20)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @index integer</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @prologue = 'MSDT-A-'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @index = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	while 1 = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set @indexstring = cast(@index as varchar(20))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set @name = @prologue + @indexstring</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists (select value from dtproperties where value = @name)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			break</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set @index = @index + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if (@index = 10000)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			goto TooMany</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">Leave:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">TooMany:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @name = 'DIAGRAM'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	goto Leave</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V15" class="bodytxt" href="javascript:ShowComparison(V15, T15)">+</a></td><td nowrap>dbo.dt_getobjwithprop</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T15"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Retrieve the owner object(s) of a given property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getobjwithprop</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(30),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@value varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		raiserror('Must specify a property name.',-1,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return (1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@value is null)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select objectid id from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select objectid id from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where property=@property and value=@value</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V16" class="bodytxt" href="javascript:ShowComparison(V16, T16)">+</a></td><td nowrap>dbo.dt_getobjwithprop_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T16"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Retrieve the owner object(s) of a given property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getobjwithprop_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(30),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@uvalue nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		raiserror('Must specify a property name.',-1,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return (1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@uvalue is null)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select objectid id from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select objectid id from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where property=@property and uvalue=@uvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V17" class="bodytxt" href="javascript:ShowComparison(V17, T17)">+</a></td><td nowrap>dbo.dt_getpropertiesbyid</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T17"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Retrieve properties by id's</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_getproperties objid, null or '' -- retrieve all properties of the object itself</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_getproperties objid, property -- retrieve the property specified</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getpropertiesbyid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select property, version, value, lvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where  @id=objectid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select property, version, value, lvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where  @id=objectid and @property=property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V18" class="bodytxt" href="javascript:ShowComparison(V18, T18)">+</a></td><td nowrap>dbo.dt_getpropertiesbyid_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T18"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Retrieve properties by id's</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_getproperties objid, null or '' -- retrieve all properties of the object itself</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_getproperties objid, property -- retrieve the property specified</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getpropertiesbyid_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select property, version, uvalue, lvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where  @id=objectid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select property, version, uvalue, lvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where  @id=objectid and @property=property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V19" class="bodytxt" href="javascript:ShowComparison(V19, T19)">+</a></td><td nowrap>dbo.dt_getpropertiesbyid_vcs</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T19"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getpropertiesbyid_vcs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @id       int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @property varchar(64),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @value    varchar(255) = NULL OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @value = (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select value</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                where @id=objectid and @property=property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                )</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V20" class="bodytxt" href="javascript:ShowComparison(V20, T20)">+</a></td><td nowrap>dbo.dt_getpropertiesbyid_vcs_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T20"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getpropertiesbyid_vcs_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @id       int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @property varchar(64),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @value    nvarchar(255) = NULL OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    -- This procedure should no longer be called;  dt_getpropertiesbyid_vcsshould be called instead.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- Calls are forwarded to dt_getpropertiesbyid_vcs to maintain backward compatibility.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@id,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@property,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@value output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V21" class="bodytxt" href="javascript:ShowComparison(V21, T21)">+</a></td><td nowrap>dbo.dt_isundersourcecontrol</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T21"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_isundersourcecontrol</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName varchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword  varchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iWhoToo      int = 0 /* 0 => Just check project; 1 => get list of objs */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iStreamObjectId   = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @vchTempText varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if (@vchProjectName = '')	set @vchProjectName		= null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if (@vchSourceSafeINI = '') set @vchSourceSafeINI	= null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if (@vchServerName = '')	set @vchServerName		= null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if (@vchDatabaseName = '')	set @vchDatabaseName	= null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if (@vchProjectName is null) or (@vchSourceSafeINI is null) or (@vchServerName is null) or (@vchDatabaseName is null)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        RAISERROR('Not Under Source Control',16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @iWhoToo = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        /* Get List of Procs in the project */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												'GetListOfObjects',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OAGetProperty @iObjectId, 'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        create table #ObjectList (id int identity, vchObjectlist varchar(255))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchTempText = 'STUB'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        while @vchTempText is not null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec @iReturn = master.dbo.sp_OAMethod @iStreamObjectId, 'GetStream', @iReturnValue OUT, @vchTempText OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if (@vchTempText = '') set @vchTempText = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if (@vchTempText is not null) insert into #ObjectList (vchObjectlist ) select @vchTempText</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select vchObjectlist from #ObjectList order by id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V22" class="bodytxt" href="javascript:ShowComparison(V22, T22)">+</a></td><td nowrap>dbo.dt_isundersourcecontrol_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T22"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_isundersourcecontrol_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName nvarchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword  nvarchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iWhoToo      int = 0 /* 0 => Just check project; 1 => get list of objs */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- This procedure should no longer be called;  dt_isundersourcecontrol should be called instead.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- Calls are forwarded to dt_isundersourcecontrol to maintain backward compatibility.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	exec dbo.dt_isundersourcecontrol</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@iWhoToo</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V23" class="bodytxt" href="javascript:ShowComparison(V23, T23)">+</a></td><td nowrap>dbo.dt_removefromsourcecontrol</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T23"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_removefromsourcecontrol</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec dbo.dt_droppropertiesbyid @iPropertyObjectId, null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* -1 is returned by dt_droppopertiesbyid */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @@error <> 0 and @@error <> -1 return 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V24" class="bodytxt" href="javascript:ShowComparison(V24, T24)">+</a></td><td nowrap>dbo.dt_setpropertybyid</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T24"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	If the property already exists, reset the value; otherwise add property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		id -- the id in sysobjects of the object</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		property -- the name of the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		value -- the text value of the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		lvalue -- the binary value of the property (image)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_setpropertybyid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@value varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@lvalue image</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @uvalue nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @uvalue = convert(nvarchar(255), @value)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists (select * from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- bump the version count for this row as we update it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update dbo.dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- version count is auto-set to 0 on initial insert</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert dbo.dtproperties (property, objectid, value, uvalue, lvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values (@property, @id, @value, @uvalue, @lvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V25" class="bodytxt" href="javascript:ShowComparison(V25, T25)">+</a></td><td nowrap>dbo.dt_setpropertybyid_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T25"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	If the property already exists, reset the value; otherwise add property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		id -- the id in sysobjects of the object</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		property -- the name of the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		uvalue -- the text value of the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		lvalue -- the binary value of the property (image)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_setpropertybyid_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@uvalue nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@lvalue image</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- If we are writing the name property, find the ansi equivalent.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- If there is no lossless translation, generate an ansi name.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @avalue varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @avalue = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if (@uvalue is not null)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set @avalue = convert(varchar(255), @uvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if 'DtgSchemaNAME' = @property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				exec dbo.dt_generateansiname @avalue output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists (select * from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- bump the version count for this row as we update it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update dbo.dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- version count is auto-set to 0 on initial insert</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert dbo.dtproperties (property, objectid, value, uvalue, lvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values (@property, @id, @avalue, @uvalue, @lvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V26" class="bodytxt" href="javascript:ShowComparison(V26, T26)">+</a></td><td nowrap>dbo.dt_validateloginparams</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T26"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_validateloginparams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = master.dbo.sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = master.dbo.sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											'ValidateLoginParams',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">											@sPassword = @vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V27" class="bodytxt" href="javascript:ShowComparison(V27, T27)">+</a></td><td nowrap>dbo.dt_validateloginparams_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T27"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_validateloginparams_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	-- This procedure should no longer be called;  dt_validateloginparams should be called instead.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- Calls are forwarded to dt_validateloginparams to maintain backward compatibility.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	exec dbo.dt_validateloginparams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V28" class="bodytxt" href="javascript:ShowComparison(V28, T28)">+</a></td><td nowrap>dbo.dt_vcsenabled</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T28"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_vcsenabled</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec @iReturn = master.dbo.sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 raiserror('', 16, -1) /* Can't Load Helper DLLC */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V29" class="bodytxt" href="javascript:ShowComparison(V29, T29)">+</a></td><td nowrap>dbo.dt_verstamp006</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T29"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	This procedure returns the version number of the stored</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**    procedures used by legacy versions of the Microsoft</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Visual Database Tools.  Version is 7.0.00.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_verstamp006</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select 7000</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V30" class="bodytxt" href="javascript:ShowComparison(V30, T30)">+</a></td><td nowrap>dbo.dt_verstamp007</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T30"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	This procedure returns the version number of the stored</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**    procedures used by the the Microsoft Visual Database Tools.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Version is 7.0.05.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_verstamp007</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select 7005</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V31" class="bodytxt" href="javascript:ShowComparison(V31, T31)">+</a></td><td nowrap>dbo.dt_whocheckedout</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T31"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_whocheckedout</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchObjectName varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchLoginName  varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchPassword   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        declare @vchReturnValue varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @vchReturnValue = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = master.dbo.sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												'WhoCheckedOut',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@vchReturnValue OUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">												@sPassword = @vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchReturnValue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V32" class="bodytxt" href="javascript:ShowComparison(V32, T32)">+</a></td><td nowrap>dbo.dt_whocheckedout_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T32"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_whocheckedout_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchObjectName nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchLoginName  nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchPassword   nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	-- This procedure should no longer be called;  dt_whocheckedout should be called instead.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- Calls are forwarded to dt_whocheckedout to maintain backward compatibility.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	exec dbo.dt_whocheckedout</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@chObjectType,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V33" class="bodytxt" href="javascript:ShowComparison(V33, T33)">+</a></td><td nowrap>dbo.sp_GetInfoForCheckIn</td><td nowrap align="center"><font class="added"><</font><font class="deleted">></font></td><td nowrap>Update on largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T33"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%">-- Procedure</td><td width="4%" align="center">==</td><td width="48%">-- Procedure</td></tr>
<tr><td>CREATE  procedure dbo.sp_GetInfoForCheckIn</td><td align="center">==</td><td>CREATE  procedure dbo.sp_GetInfoForCheckIn</td></tr>
<tr><td>	(</td><td align="center">==</td><td>	(</td></tr>
<tr><td>		@OrgId int,</td><td align="center">==</td><td>		@OrgId int,</td></tr>
<tr><td>		@EquipId int,</td><td align="center">==</td><td>		@EquipId int,</td></tr>
<tr><td>		@OrderId int=null,</td><td align="center">==</td><td>		@OrderId int=null,</td></tr>
<tr><td>		@vchEquipId varchar(50)=null output,</td><td align="center">==</td><td>		@vchEquipId varchar(50)=null output,</td></tr>
<tr><td>		@dmCurrentUnits decimal(19,8)=null output,</td><td align="center">==</td><td>		@dmCurrentUnits decimal(19,8)=null output,</td></tr>
<tr><td>		@vchMeasure varchar(255)=null output,</td><td align="center">==</td><td>		@vchMeasure varchar(255)=null output,</td></tr>
<tr><td>		@StatusId int=null output,</td><td align="center">==</td><td>		@StatusId int=null output,</td></tr>
<tr><td>		@dtScheduled datetime=null output,</td><td align="center">==</td><td>		@dtScheduled datetime=null output,</td></tr>
<tr><td>		@dtArrival datetime=null output,</td><td align="center">==</td><td>		@dtArrival datetime=null output,</td></tr>
<tr><td>		@bitStaying bit=null output,</td><td align="center">==</td><td>		@bitStaying bit=null output,</td></tr>
<tr><td>		@vchDropedOffBy varchar(50)=null output,</td><td align="center">==</td><td>		@vchDropedOffBy varchar(50)=null output,</td></tr>
<tr><td>		@bitSpare bit=null output,</td><td align="center">==</td><td>		@bitSpare bit=null output,</td></tr>
<tr><td>		@TechId int=null output</td><td align="center">==</td><td>		@TechId int=null output</td></tr>
<tr><td>	)</td><td align="center">==</td><td>	)</td></tr>
<tr><td>as</td><td align="center">==</td><td>as</td></tr>
<tr><td>	set nocount on</td><td align="center">==</td><td>	set nocount on</td></tr>
<tr><td><font class="modified">-- ????? ???????? ??? ?????????? Check In</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">-- Comment... Check In</font></td></tr>
<tr><td>/*</td><td align="center">==</td><td>/*</td></tr>
<tr><td>			insert into [EquipUnitLogs](</td><td align="center">==</td><td>			insert into [EquipUnitLogs](</td></tr>
<tr><td>				[OrgId],</td><td align="center">==</td><td>				[OrgId],</td></tr>
<tr><td>				[EquipId],</td><td align="center">==</td><td>				[EquipId],</td></tr>
<tr><td>				[LogTypeId],</td><td align="center">==</td><td>				[LogTypeId],</td></tr>
<tr><td>				[dtDate],</td><td align="center">==</td><td>				[dtDate],</td></tr>
<tr><td>				[dmUnits]</td><td align="center">==</td><td>				[dmUnits]</td></tr>
<tr><td>				)</td><td align="center">==</td><td>				)</td></tr>
<tr><td>			values(</td><td align="center">==</td><td>			values(</td></tr>
<tr><td>				@OrgId,</td><td align="center">==</td><td>				@OrgId,</td></tr>
<tr><td>				@EquipId,</td><td align="center">==</td><td>				@EquipId,</td></tr>
<tr><td>				1,</td><td align="center">==</td><td>				1,</td></tr>
<tr><td>				@dtCreated,</td><td align="center">==</td><td>				@dtCreated,</td></tr>
<tr><td>				@dmMileage</td><td align="center">==</td><td>				@dmMileage</td></tr>
<tr><td>				)</td><td align="center">==</td><td>				)</td></tr>
<tr><td>			update Equipments</td><td align="center">==</td><td>			update Equipments</td></tr>
<tr><td>			set dmCurrentUnits = @dmMileage</td><td align="center">==</td><td>			set dmCurrentUnits = @dmMileage</td></tr>
<tr><td>			where [Id] = @EquipId</td><td align="center">==</td><td>			where [Id] = @EquipId</td></tr>
<tr><td>			and OrgId = @OrgId</td><td align="center">==</td><td>			and OrgId = @OrgId</td></tr>
<tr><td>*/</td><td align="center">==</td><td>*/</td></tr>
<tr><td>	if isnull(@OrderId, 0) <> 0</td><td align="center">==</td><td>	if isnull(@OrderId, 0) <> 0</td></tr>
<tr><td>	begin -- editing mode</td><td align="center">==</td><td>	begin -- editing mode</td></tr>
<tr><td>		if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</td><td align="center">==</td><td>		if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</td></tr>
<tr><td>		begin</td><td align="center">==</td><td>		begin</td></tr>
<tr><td>			return -1</td><td align="center">==</td><td>			return -1</td></tr>
<tr><td>		end</td><td align="center">==</td><td>		end</td></tr>
<tr><td>		else</td><td align="center">==</td><td>		else</td></tr>
<tr><td>		begin</td><td align="center">==</td><td>		begin</td></tr>
<tr><td>			select 	@vchEquipId = E.vchEquipId,</td><td align="center">==</td><td>			select 	@vchEquipId = E.vchEquipId,</td></tr>
<tr><td>				@dmCurrentUnits = isnull(E.dmCurrentUnits, 0.0),</td><td align="center">==</td><td>				@dmCurrentUnits = isnull(E.dmCurrentUnits, 0.0),</td></tr>
<tr><td>				@vchMeasure = isnull(UM.vchName, ''),</td><td align="center">==</td><td>				@vchMeasure = isnull(UM.vchName, ''),</td></tr>
<tr><td>				@StatusId = WO.StatusId,</td><td align="center">==</td><td>				@StatusId = WO.StatusId,</td></tr>
<tr><td>				@dtScheduled = WO.dtScheduled,</td><td align="center">==</td><td>				@dtScheduled = WO.dtScheduled,</td></tr>
<tr><td>				@dtArrival = WO.dtArrival,</td><td align="center">==</td><td>				@dtArrival = WO.dtArrival,</td></tr>
<tr><td>				@bitStaying = WO.bitStaying,</td><td align="center">==</td><td>				@bitStaying = WO.bitStaying,</td></tr>
<tr><td>				@vchDropedOffBy = isnull(WO.vchDropedOffBy, ''),</td><td align="center">==</td><td>				@vchDropedOffBy = isnull(WO.vchDropedOffBy, ''),</td></tr>
<tr><td>				@bitSpare = (case when isnull(WO.SpareEquipId, 0) = 0 then 0 else 1 end),</td><td align="center">==</td><td>				@bitSpare = (case when isnull(WO.SpareEquipId, 0) = 0 then 0 else 1 end),</td></tr>
<tr><td>				@TechId = isnull(WO.intTechId, 0)</td><td align="center">==</td><td>				@TechId = isnull(WO.intTechId, 0)</td></tr>
<tr><td>			from WorkOrders WO</td><td align="center">==</td><td>			from WorkOrders WO</td></tr>
<tr><td>			inner join Equipments E</td><td align="center">==</td><td>			inner join Equipments E</td></tr>
<tr><td>			on WO.[Id] = @OrderId</td><td align="center">==</td><td>			on WO.[Id] = @OrderId</td></tr>
<tr><td>			and WO.OrgId = @OrgId</td><td align="center">==</td><td>			and WO.OrgId = @OrgId</td></tr>
<tr><td>			and WO.[EquipId] = E.[Id]</td><td align="center">==</td><td>			and WO.[EquipId] = E.[Id]</td></tr>
<tr><td>			and WO.OrgId = E.OrgId</td><td align="center">==</td><td>			and WO.OrgId = E.OrgId</td></tr>
<tr><td>			inner join EquipTypes ET</td><td align="center">==</td><td>			inner join EquipTypes ET</td></tr>
<tr><td>			on E.TypeId = ET.[Id]</td><td align="center">==</td><td>			on E.TypeId = ET.[Id]</td></tr>
<tr><td>			and E.OrgId = ET.OrgId</td><td align="center">==</td><td>			and E.OrgId = ET.OrgId</td></tr>
<tr><td>			left join UnitMeasures UM</td><td align="center">==</td><td>			left join UnitMeasures UM</td></tr>
<tr><td>			on ET.UnitMeasureId = UM.[Id]</td><td align="center">==</td><td>			on ET.UnitMeasureId = UM.[Id]</td></tr>
<tr><td>		end</td><td align="center">==</td><td>		end</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin -- adding mode</td><td align="center">==</td><td>	begin -- adding mode</td></tr>
<tr><td>		if not exists(select 'true' from Equipments E</td><td align="center">==</td><td>		if not exists(select 'true' from Equipments E</td></tr>
<tr><td>					inner join EquipTypes ET</td><td align="center">==</td><td>					inner join EquipTypes ET</td></tr>
<tr><td>					on E.[Id] = @EquipId</td><td align="center">==</td><td>					on E.[Id] = @EquipId</td></tr>
<tr><td>					and E.OrgId = @OrgId</td><td align="center">==</td><td>					and E.OrgId = @OrgId</td></tr>
<tr><td>					and E.TypeId = ET.[Id]</td><td align="center">==</td><td>					and E.TypeId = ET.[Id]</td></tr>
<tr><td>					and E.OrgId = ET.OrgId)</td><td align="center">==</td><td>					and E.OrgId = ET.OrgId)</td></tr>
<tr><td>		begin</td><td align="center">==</td><td>		begin</td></tr>
<tr><td>			return -1</td><td align="center">==</td><td>			return -1</td></tr>
<tr><td>		end</td><td align="center">==</td><td>		end</td></tr>
<tr><td>		else</td><td align="center">==</td><td>		else</td></tr>
<tr><td>		begin</td><td align="center">==</td><td>		begin</td></tr>
<tr><td>			select 	@vchEquipId = E.[vchEquipId],</td><td align="center">==</td><td>			select 	@vchEquipId = E.[vchEquipId],</td></tr>
<tr><td>				@vchMeasure = isnull(UM.vchName, ''),</td><td align="center">==</td><td>				@vchMeasure = isnull(UM.vchName, ''),</td></tr>
<tr><td>				@dmCurrentUnits = isnull(E.dmCurrentUnits, 0.0),</td><td align="center">==</td><td>				@dmCurrentUnits = isnull(E.dmCurrentUnits, 0.0),</td></tr>
<tr><td>				@StatusId = 1,</td><td align="center">==</td><td>				@StatusId = 1,</td></tr>
<tr><td>				@dtScheduled = null,</td><td align="center">==</td><td>				@dtScheduled = null,</td></tr>
<tr><td>				@dtArrival = null,</td><td align="center">==</td><td>				@dtArrival = null,</td></tr>
<tr><td>				@bitStaying = null,</td><td align="center">==</td><td>				@bitStaying = null,</td></tr>
<tr><td>				@vchDropedOffBy = '',</td><td align="center">==</td><td>				@vchDropedOffBy = '',</td></tr>
<tr><td>				@bitSpare = null,</td><td align="center">==</td><td>				@bitSpare = null,</td></tr>
<tr><td>				@TechId = 0</td><td align="center">==</td><td>				@TechId = 0</td></tr>
<tr><td>			from Equipments E</td><td align="center">==</td><td>			from Equipments E</td></tr>
<tr><td>			inner join EquipTypes ET</td><td align="center">==</td><td>			inner join EquipTypes ET</td></tr>
<tr><td>			on E.[Id] = @EquipId</td><td align="center">==</td><td>			on E.[Id] = @EquipId</td></tr>
<tr><td>			and E.OrgId = @OrgId</td><td align="center">==</td><td>			and E.OrgId = @OrgId</td></tr>
<tr><td>			and E.TypeId = ET.[Id]</td><td align="center">==</td><td>			and E.TypeId = ET.[Id]</td></tr>
<tr><td>			and E.OrgId = ET.OrgId</td><td align="center">==</td><td>			and E.OrgId = ET.OrgId</td></tr>
<tr><td>			left join UnitMeasures UM</td><td align="center">==</td><td>			left join UnitMeasures UM</td></tr>
<tr><td>			on ET.UnitMeasureId = UM.[Id]</td><td align="center">==</td><td>			on ET.UnitMeasureId = UM.[Id]</td></tr>
<tr><td>			</td><td align="center">==</td><td>			</td></tr>
<tr><td>			return 0</td><td align="center">==</td><td>			return 0</td></tr>
<tr><td>		end</td><td align="center">==</td><td>		end</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V34" class="bodytxt" href="javascript:ShowComparison(V34, T34)">+</a></td><td nowrap>dbo.sp_InitDB</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T34"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET ANSI_NULLS OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE PROCEDURE dbo.sp_InitDB AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">print 'Creating info of a new organization'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET ANSI_NULLS ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V35" class="bodytxt" href="javascript:ShowComparison(V35, T35)">+</a></td><td nowrap>dbo.sp_InitOrg</td><td nowrap align="center"><font class="added"><</font><font class="deleted">></font></td><td nowrap>Update on largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T35"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%">-- Procedure</td><td width="4%" align="center">==</td><td width="48%">-- Procedure</td></tr>
<tr><td>SET QUOTED_IDENTIFIER OFF</td><td align="center">==</td><td>SET QUOTED_IDENTIFIER OFF</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td>SET ANSI_NULLS OFF</td><td align="center">==</td><td>SET ANSI_NULLS OFF</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td><font class="modified">create procedure dbo.sp_InitOrg</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">CREATE procedure dbo.sp_InitOrg</font></td></tr>
<tr><td>as</td><td align="center">==</td><td>as</td></tr>
<tr><td>	set nocount on</td><td align="center">==</td><td>	set nocount on</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	declare @OrgId int</td><td align="center">==</td><td>	declare @OrgId int</td></tr>
<tr><td>	declare @dtCreated datetime</td><td align="center">==</td><td>	declare @dtCreated datetime</td></tr>
<tr><td>	declare @RC int</td><td align="center">==</td><td>	declare @RC int</td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="added"><<</font></td><td><font class="modified">	</font></td></tr>
<tr><td><font class="modified">	select @OrgId = 0, @dtCreated = getdate()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td>	-- Step 1. Organization Information</td><td align="center">==</td><td>	-- Step 1. Organization Information</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="added"><<</font></td><td><font class="modified">		select @OrgId = 0, @dtCreated = getdate()</font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="added"><<</font></td><td><font class="modified">		</font></td></tr>
<tr><td>		insert into [Orgs](</td><td align="center">==</td><td>		insert into [Orgs](</td></tr>
<tr><td>			[intBWAId],</td><td align="center">==</td><td>			[intBWAId],</td></tr>
<tr><td>			[vchName],</td><td align="center">==</td><td>			[vchName],</td></tr>
<tr><td>			[btActive],</td><td align="center">==</td><td>			[btActive],</td></tr>
<tr><td>			[dtCreated],</td><td align="center">==</td><td>			[dtCreated],</td></tr>
<tr><td>			[dtCurrentDate],</td><td align="center">==</td><td>			[dtCurrentDate],</td></tr>
<tr><td>			[vchLogo],</td><td align="center">==</td><td>			[vchLogo],</td></tr>
<tr><td>			[btPrint],</td><td align="center">==</td><td>			[btPrint],</td></tr>
<tr><td>			[vchFullName],</td><td align="center">==</td><td>			[vchFullName],</td></tr>
<tr><td>			[vchAddress1],</td><td align="center">==</td><td>			[vchAddress1],</td></tr>
<tr><td>			[vchAddress2],</td><td align="center">==</td><td>			[vchAddress2],</td></tr>
<tr><td>			[vchCity],</td><td align="center">==</td><td>			[vchCity],</td></tr>
<tr><td>			[vchProvince],</td><td align="center">==</td><td>			[vchProvince],</td></tr>
<tr><td>			[vchPostalCode],</td><td align="center">==</td><td>			[vchPostalCode],</td></tr>
<tr><td>			[vchPhone],</td><td align="center">==</td><td>			[vchPhone],</td></tr>
<tr><td>			[vchPhone2],</td><td align="center">==</td><td>			[vchPhone2],</td></tr>
<tr><td>			[vchFax],</td><td align="center">==</td><td>			[vchFax],</td></tr>
<tr><td>			[vchAcctNumber],</td><td align="center">==</td><td>			[vchAcctNumber],</td></tr>
<tr><td>			[vchContactName],</td><td align="center">==</td><td>			[vchContactName],</td></tr>
<tr><td>			[vchNotes],</td><td align="center">==</td><td>			[vchNotes],</td></tr>
<tr><td>			[vchWeb],</td><td align="center">==</td><td>			[vchWeb],</td></tr>
<tr><td>			[vchEmail]</td><td align="center">==</td><td>			[vchEmail]</td></tr>
<tr><td>			)</td><td align="center">==</td><td>			)</td></tr>
<tr><td>		values(	1,</td><td align="center">==</td><td>		values(	1,</td></tr>
<tr><td>			'Demo County',</td><td align="center">==</td><td>			'Demo County',</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			@dtCreated,</td><td align="center">==</td><td>			@dtCreated,</td></tr>
<tr><td>			@dtCreated,</td><td align="center">==</td><td>			@dtCreated,</td></tr>
<tr><td>			'DemoInc_45px.gif',</td><td align="center">==</td><td>			'DemoInc_45px.gif',</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'Demo County Department Of Education',</td><td align="center">==</td><td>			'Demo County Department Of Education',</td></tr>
<tr><td>			'222 Street Ave',</td><td align="center">==</td><td>			'222 Street Ave',</td></tr>
<tr><td>			'',</td><td align="center">==</td><td>			'',</td></tr>
<tr><td>			'Atlanta',</td><td align="center">==</td><td>			'Atlanta',</td></tr>
<tr><td>			'GA',</td><td align="center">==</td><td>			'GA',</td></tr>
<tr><td>			'30303',</td><td align="center">==</td><td>			'30303',</td></tr>
<tr><td>			'555-555-1212',</td><td align="center">==</td><td>			'555-555-1212',</td></tr>
<tr><td>			'',</td><td align="center">==</td><td>			'',</td></tr>
<tr><td>			'',</td><td align="center">==</td><td>			'',</td></tr>
<tr><td>			'',</td><td align="center">==</td><td>			'',</td></tr>
<tr><td>			'Patrick Clements',</td><td align="center">==</td><td>			'Patrick Clements',</td></tr>
<tr><td>			'',</td><td align="center">==</td><td>			'',</td></tr>
<tr><td>			'http://login.bigfleetsystem.com',</td><td align="center">==</td><td>			'http://login.bigfleetsystem.com',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>			)</td><td align="center">==</td><td>			)</td></tr>
<tr><td>		select @OrgId = scope_identity()</td><td align="center">==</td><td>		select @OrgId = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 1. An error occurred loading the new organization'</td><td align="center">==</td><td>		print 'Step 1. An error occurred loading the new organization'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 1. A new organization has been added to database'</td><td align="center">==</td><td>		print 'Step 1. A new organization has been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	-- Step 2. Equipment Types</td><td align="center">==</td><td>	-- Step 2. Equipment Types</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipTypes]([OrgId], [vchName], [InspectId], [UnitMeasureId])</td><td align="center">==</td><td>		insert into [EquipTypes]([OrgId], [vchName], [InspectId], [UnitMeasureId])</td></tr>
<tr><td>		select @OrgId, 'Bus', null, 1</td><td align="center">==</td><td>		select @OrgId, 'Bus', null, 1</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Van', null, 3</td><td align="center">==</td><td>		select @OrgId, 'Van', null, 3</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Truck', null, 2</td><td align="center">==</td><td>		select @OrgId, 'Truck', null, 2</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 2. An error occurred loading the new types of equipments'</td><td align="center">==</td><td>		print 'Step 2. An error occurred loading the new types of equipments'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 2. The new equipment types has been added to database'</td><td align="center">==</td><td>		print 'Step 2. The new equipment types has been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- Step 3. Equipment (Component) Makers Names being used in your company</td><td align="center">==</td><td>	-- Step 3. Equipment (Component) Makers Names being used in your company</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [EquipMakes]([OrgId], [vchMakeName])</td><td align="center">==</td><td>		insert into [EquipMakes]([OrgId], [vchMakeName])</td></tr>
<tr><td>		select @OrgId, 'All America'</td><td align="center">==</td><td>		select @OrgId, 'All America'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'International'</td><td align="center">==</td><td>		select @OrgId, 'International'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'CAT'</td><td align="center">==</td><td>		select @OrgId, 'CAT'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'ALLISION'</td><td align="center">==</td><td>		select @OrgId, 'ALLISION'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Ford'</td><td align="center">==</td><td>		select @OrgId, 'Ford'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Chevrolet'</td><td align="center">==</td><td>		select @OrgId, 'Chevrolet'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'CUM'</td><td align="center">==</td><td>		select @OrgId, 'CUM'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'DT'</td><td align="center">==</td><td>		select @OrgId, 'DT'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'ALLAMER'</td><td align="center">==</td><td>		select @OrgId, 'ALLAMER'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 3. An error occurred loading the makers names'</td><td align="center">==</td><td>		print 'Step 3. An error occurred loading the makers names'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 3. The new makers names has been added to database'</td><td align="center">==</td><td>		print 'Step 3. The new makers names has been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- Step 4. Models Names for different Types and Makers of Equipments</td><td align="center">==</td><td>	-- Step 4. Models Names for different Types and Makers of Equipments</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 1.</td><td align="center">==</td><td>		-- 1.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'All America'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'All America'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'BUS')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'BUS')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 2.</td><td align="center">==</td><td>		-- 2.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'International'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'International'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'BUS')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'BUS')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 3.</td><td align="center">==</td><td>		-- 3.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Ranger')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Ranger')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 4.</td><td align="center">==</td><td>		-- 4.</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Astro')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Astro')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 5.</td><td align="center">==</td><td>		-- 5.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Van'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Van'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Van')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Van')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 6.</td><td align="center">==</td><td>		-- 6.</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'F350')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'F350')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 7.</td><td align="center">==</td><td>		-- 7.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'Chevrolet'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'Chevrolet'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Van'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Van'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Van')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Van')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 8.</td><td align="center">==</td><td>		-- 8.</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Step Van')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Step Van')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 9.</td><td align="center">==</td><td>		-- 9.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Truck'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Truck'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Truck')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Truck')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		-- 10.</td><td align="center">==</td><td>		-- 10.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 0, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'Chevrolet'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'Chevrolet'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Truck'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Truck'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Astro')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Astro')</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 4. An error occurred loading the Models names'</td><td align="center">==</td><td>		print 'Step 4. An error occurred loading the Models names'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 4. The new Models names has been added to database'</td><td align="center">==</td><td>		print 'Step 4. The new Models names has been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- Step 5. Equipment Departments, Locations, Disposal Methods</td><td align="center">==</td><td>	-- Step 5. Equipment Departments, Locations, Disposal Methods</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Departments]([OrgId], [vchName])</td><td align="center">==</td><td>		insert into [Departments]([OrgId], [vchName])</td></tr>
<tr><td>		values(@OrgId, 'Transportation')</td><td align="center">==</td><td>		values(@OrgId, 'Transportation')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Locations]([OrgId], [vchName])</td><td align="center">==</td><td>		insert into [Locations]([OrgId], [vchName])</td></tr>
<tr><td>		values(@OrgId, 'Default')</td><td align="center">==</td><td>		values(@OrgId, 'Default')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [EquipDisposalMethods]([OrgId], [vchName], [btActive])</td><td align="center">==</td><td>		insert into [EquipDisposalMethods]([OrgId], [vchName], [btActive])</td></tr>
<tr><td>		select @OrgId, 'Sold', 1</td><td align="center">==</td><td>		select @OrgId, 'Sold', 1</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Salvaged', 1</td><td align="center">==</td><td>		select @OrgId, 'Salvaged', 1</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Auctioned', 1</td><td align="center">==</td><td>		select @OrgId, 'Auctioned', 1</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 5. An error occurred loading the Departments, Locations, Disposal Methods.'</td><td align="center">==</td><td>		print 'Step 5. An error occurred loading the Departments, Locations, Disposal Methods.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 5. New Departments (Locations, Disposal Methods) has been added to database'</td><td align="center">==</td><td>		print 'Step 5. New Departments (Locations, Disposal Methods) has been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- Step 6. Additional Custom Fields of Equipments</td><td align="center">==</td><td>	-- Step 6. Additional Custom Fields of Equipments</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [CustFieldDef](</td><td align="center">==</td><td>		insert into [CustFieldDef](</td></tr>
<tr><td>			[OrgId],</td><td align="center">==</td><td>			[OrgId],</td></tr>
<tr><td>			[DataTypeId],</td><td align="center">==</td><td>			[DataTypeId],</td></tr>
<tr><td>			[ComponentTypeId],</td><td align="center">==</td><td>			[ComponentTypeId],</td></tr>
<tr><td>			[NumberColumn],</td><td align="center">==</td><td>			[NumberColumn],</td></tr>
<tr><td>			[vchName],</td><td align="center">==</td><td>			[vchName],</td></tr>
<tr><td>			[vchNameText],</td><td align="center">==</td><td>			[vchNameText],</td></tr>
<tr><td>			[vchNameLookupTable],</td><td align="center">==</td><td>			[vchNameLookupTable],</td></tr>
<tr><td>			[vchNameFieldLookup],</td><td align="center">==</td><td>			[vchNameFieldLookup],</td></tr>
<tr><td>			[btRequired],</td><td align="center">==</td><td>			[btRequired],</td></tr>
<tr><td>			[intFieldTypeId],</td><td align="center">==</td><td>			[intFieldTypeId],</td></tr>
<tr><td>			[vchDefault],</td><td align="center">==</td><td>			[vchDefault],</td></tr>
<tr><td>			[vchHelp]</td><td align="center">==</td><td>			[vchHelp]</td></tr>
<tr><td>			)</td><td align="center">==</td><td>			)</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'vchCondition',</td><td align="center">==</td><td>			'vchCondition',</td></tr>
<tr><td>			'Condition',</td><td align="center">==</td><td>			'Condition',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			'Bus Condition, e.g.: EXCELLENT, GOOD, FAIR, POOR.'</td><td align="center">==</td><td>			'Bus Condition, e.g.: EXCELLENT, GOOD, FAIR, POOR.'</td></tr>
<tr><td>		from 	DataTypes as DT, EquipTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Equipment'</td><td align="center">==</td><td>		where 	DT.vchName = 'Equipment'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'dmCost',</td><td align="center">==</td><td>			'dmCost',</td></tr>
<tr><td>			'Cost',</td><td align="center">==</td><td>			'Cost',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			3,</td><td align="center">==</td><td>			3,</td></tr>
<tr><td>			'0.0',</td><td align="center">==</td><td>			'0.0',</td></tr>
<tr><td>			'Bus Cost'</td><td align="center">==</td><td>			'Bus Cost'</td></tr>
<tr><td>		from 	DataTypes as DT, EquipTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Equipment'</td><td align="center">==</td><td>		where 	DT.vchName = 'Equipment'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			2,</td><td align="center">==</td><td>			2,</td></tr>
<tr><td>			'vchColor',</td><td align="center">==</td><td>			'vchColor',</td></tr>
<tr><td>			'Color',</td><td align="center">==</td><td>			'Color',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			'Bus Color'</td><td align="center">==</td><td>			'Bus Color'</td></tr>
<tr><td>		from 	DataTypes as DT, EquipTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Equipment'</td><td align="center">==</td><td>		where 	DT.vchName = 'Equipment'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'intPassengers',</td><td align="center">==</td><td>			'intPassengers',</td></tr>
<tr><td>			'Passengers',</td><td align="center">==</td><td>			'Passengers',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			2,</td><td align="center">==</td><td>			2,</td></tr>
<tr><td>			'0',</td><td align="center">==</td><td>			'0',</td></tr>
<tr><td>			'Amount of passengers seats at the Bus'</td><td align="center">==</td><td>			'Amount of passengers seats at the Bus'</td></tr>
<tr><td>		from 	DataTypes as DT, EquipTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Equipment'</td><td align="center">==</td><td>		where 	DT.vchName = 'Equipment'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'vchColor',</td><td align="center">==</td><td>			'vchColor',</td></tr>
<tr><td>			'Color',</td><td align="center">==</td><td>			'Color',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			'Van Color'</td><td align="center">==</td><td>			'Van Color'</td></tr>
<tr><td>		from 	DataTypes as DT, EquipTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Equipment'</td><td align="center">==</td><td>		where 	DT.vchName = 'Equipment'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Van'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Van'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			2,</td><td align="center">==</td><td>			2,</td></tr>
<tr><td>			'vchNote',</td><td align="center">==</td><td>			'vchNote',</td></tr>
<tr><td>			'Note',</td><td align="center">==</td><td>			'Note',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>		from 	DataTypes as DT, EquipTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Equipment'</td><td align="center">==</td><td>		where 	DT.vchName = 'Equipment'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Van'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Van'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'vchColor',</td><td align="center">==</td><td>			'vchColor',</td></tr>
<tr><td>			'Color',</td><td align="center">==</td><td>			'Color',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			'Truck Color'</td><td align="center">==</td><td>			'Truck Color'</td></tr>
<tr><td>		from 	DataTypes as DT, EquipTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Equipment'</td><td align="center">==</td><td>		where 	DT.vchName = 'Equipment'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Truck'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Truck'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			2,</td><td align="center">==</td><td>			2,</td></tr>
<tr><td>			'vchNote',</td><td align="center">==</td><td>			'vchNote',</td></tr>
<tr><td>			'Note',</td><td align="center">==</td><td>			'Note',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>		from 	DataTypes as DT, EquipTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Equipment'</td><td align="center">==</td><td>		where 	DT.vchName = 'Equipment'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Truck'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Truck'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 6. An error occurred loading the Custom Fields for the Equipments.'</td><td align="center">==</td><td>		print 'Step 6. An error occurred loading the Custom Fields for the Equipments.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 6. Custom Fields for the new equipment types have been added to database'</td><td align="center">==</td><td>		print 'Step 6. Custom Fields for the new equipment types have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- Step 7. Equipment Components, Defaults</td><td align="center">==</td><td>	-- Step 7. Equipment Components, Defaults</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [EquipComponentTypes]([OrgId], [vchName])</td><td align="center">==</td><td>		insert into [EquipComponentTypes]([OrgId], [vchName])</td></tr>
<tr><td>		select @OrgId, 'Engine'</td><td align="center">==</td><td>		select @OrgId, 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @Orgid, 'Transmission'</td><td align="center">==</td><td>		select @Orgid, 'Transmission'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @Orgid, 'Chassis'</td><td align="center">==</td><td>		select @Orgid, 'Chassis'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [EquipComponentDefault](</td><td align="center">==</td><td>		insert into [EquipComponentDefault](</td></tr>
<tr><td>			[OrgId],</td><td align="center">==</td><td>			[OrgId],</td></tr>
<tr><td>			[ComponentTypeId],</td><td align="center">==</td><td>			[ComponentTypeId],</td></tr>
<tr><td>			[EquipmentTypeId]</td><td align="center">==</td><td>			[EquipmentTypeId]</td></tr>
<tr><td>			)</td><td align="center">==</td><td>			)</td></tr>
<tr><td>		select 	@OrgId,</td><td align="center">==</td><td>		select 	@OrgId,</td></tr>
<tr><td>			ECT.[Id],</td><td align="center">==</td><td>			ECT.[Id],</td></tr>
<tr><td>			ET.[Id]</td><td align="center">==</td><td>			ET.[Id]</td></tr>
<tr><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td><td align="center">==</td><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td></tr>
<tr><td>		where ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		where ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Engine'</td><td align="center">==</td><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId,</td><td align="center">==</td><td>		select 	@OrgId,</td></tr>
<tr><td>			ECT.[Id],</td><td align="center">==</td><td>			ECT.[Id],</td></tr>
<tr><td>			ET.[Id]</td><td align="center">==</td><td>			ET.[Id]</td></tr>
<tr><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td><td align="center">==</td><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td></tr>
<tr><td>		where ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		where ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Transmission'</td><td align="center">==</td><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Transmission'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId,</td><td align="center">==</td><td>		select 	@OrgId,</td></tr>
<tr><td>			ECT.[Id],</td><td align="center">==</td><td>			ECT.[Id],</td></tr>
<tr><td>			ET.[Id]</td><td align="center">==</td><td>			ET.[Id]</td></tr>
<tr><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td><td align="center">==</td><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td></tr>
<tr><td>		where ET.OrgId = @OrgId and ET.vchName = 'Bus'</td><td align="center">==</td><td>		where ET.OrgId = @OrgId and ET.vchName = 'Bus'</td></tr>
<tr><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Chassis'</td><td align="center">==</td><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Chassis'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId,</td><td align="center">==</td><td>		select 	@OrgId,</td></tr>
<tr><td>			ECT.[Id],</td><td align="center">==</td><td>			ECT.[Id],</td></tr>
<tr><td>			ET.[Id]</td><td align="center">==</td><td>			ET.[Id]</td></tr>
<tr><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td><td align="center">==</td><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td></tr>
<tr><td>		where ET.OrgId = @OrgId and ET.vchName = 'Van'</td><td align="center">==</td><td>		where ET.OrgId = @OrgId and ET.vchName = 'Van'</td></tr>
<tr><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Engine'</td><td align="center">==</td><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId,</td><td align="center">==</td><td>		select 	@OrgId,</td></tr>
<tr><td>			ECT.[Id],</td><td align="center">==</td><td>			ECT.[Id],</td></tr>
<tr><td>			ET.[Id]</td><td align="center">==</td><td>			ET.[Id]</td></tr>
<tr><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td><td align="center">==</td><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td></tr>
<tr><td>		where ET.OrgId = @OrgId and ET.vchName = 'Van'</td><td align="center">==</td><td>		where ET.OrgId = @OrgId and ET.vchName = 'Van'</td></tr>
<tr><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Transmission'</td><td align="center">==</td><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Transmission'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId,</td><td align="center">==</td><td>		select 	@OrgId,</td></tr>
<tr><td>			ECT.[Id],</td><td align="center">==</td><td>			ECT.[Id],</td></tr>
<tr><td>			ET.[Id]</td><td align="center">==</td><td>			ET.[Id]</td></tr>
<tr><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td><td align="center">==</td><td>		from EquipTypes as ET, EquipComponentTypes as ECT</td></tr>
<tr><td>		where ET.OrgId = @OrgId and ET.vchName = 'Truck'</td><td align="center">==</td><td>		where ET.OrgId = @OrgId and ET.vchName = 'Truck'</td></tr>
<tr><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Transmission'</td><td align="center">==</td><td>		and ECT.OrgId = @OrgId and ECT.vchName = 'Transmission'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 7. An error occurred loading the Equipment Components.'</td><td align="center">==</td><td>		print 'Step 7. An error occurred loading the Equipment Components.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 7. Equipment Components have been added to database'</td><td align="center">==</td><td>		print 'Step 7. Equipment Components have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- Step 8. Components Fields</td><td align="center">==</td><td>	-- Step 8. Components Fields</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [CustFieldDef](</td><td align="center">==</td><td>		insert into [CustFieldDef](</td></tr>
<tr><td>			[OrgId],</td><td align="center">==</td><td>			[OrgId],</td></tr>
<tr><td>			[DataTypeId],</td><td align="center">==</td><td>			[DataTypeId],</td></tr>
<tr><td>			[ComponentTypeId],</td><td align="center">==</td><td>			[ComponentTypeId],</td></tr>
<tr><td>			[NumberColumn],</td><td align="center">==</td><td>			[NumberColumn],</td></tr>
<tr><td>			[vchName],</td><td align="center">==</td><td>			[vchName],</td></tr>
<tr><td>			[vchNameText],</td><td align="center">==</td><td>			[vchNameText],</td></tr>
<tr><td>			[vchNameLookupTable],</td><td align="center">==</td><td>			[vchNameLookupTable],</td></tr>
<tr><td>			[vchNameFieldLookup],</td><td align="center">==</td><td>			[vchNameFieldLookup],</td></tr>
<tr><td>			[btRequired],</td><td align="center">==</td><td>			[btRequired],</td></tr>
<tr><td>			[intFieldTypeId],</td><td align="center">==</td><td>			[intFieldTypeId],</td></tr>
<tr><td>			[vchDefault],</td><td align="center">==</td><td>			[vchDefault],</td></tr>
<tr><td>			[vchHelp]</td><td align="center">==</td><td>			[vchHelp]</td></tr>
<tr><td>			)</td><td align="center">==</td><td>			)</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'EngineModelId',</td><td align="center">==</td><td>			'EngineModelId',</td></tr>
<tr><td>			'Model',</td><td align="center">==</td><td>			'Model',</td></tr>
<tr><td>			'EquipModels',</td><td align="center">==</td><td>			'EquipModels',</td></tr>
<tr><td>			'vchModelName',</td><td align="center">==</td><td>			'vchModelName',</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			8,</td><td align="center">==</td><td>			8,</td></tr>
<tr><td>			'0',</td><td align="center">==</td><td>			'0',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Component'</td><td align="center">==</td><td>		where 	DT.vchName = 'Component'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'vchPart',</td><td align="center">==</td><td>			'vchPart',</td></tr>
<tr><td>			'Part #',</td><td align="center">==</td><td>			'Part #',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Component'</td><td align="center">==</td><td>		where 	DT.vchName = 'Component'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			2,</td><td align="center">==</td><td>			2,</td></tr>
<tr><td>			'vchSerial',</td><td align="center">==</td><td>			'vchSerial',</td></tr>
<tr><td>			'Serial #',</td><td align="center">==</td><td>			'Serial #',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			'Serial number'</td><td align="center">==</td><td>			'Serial number'</td></tr>
<tr><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Component'</td><td align="center">==</td><td>		where 	DT.vchName = 'Component'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'TransModelId',</td><td align="center">==</td><td>			'TransModelId',</td></tr>
<tr><td>			'Model',</td><td align="center">==</td><td>			'Model',</td></tr>
<tr><td>			'EquipModels',</td><td align="center">==</td><td>			'EquipModels',</td></tr>
<tr><td>			'vchModelName',</td><td align="center">==</td><td>			'vchModelName',</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			8,</td><td align="center">==</td><td>			8,</td></tr>
<tr><td>			'0',</td><td align="center">==</td><td>			'0',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Component'</td><td align="center">==</td><td>		where 	DT.vchName = 'Component'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'vchPart',</td><td align="center">==</td><td>			'vchPart',</td></tr>
<tr><td>			'Part #',</td><td align="center">==</td><td>			'Part #',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Component'</td><td align="center">==</td><td>		where 	DT.vchName = 'Component'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			2,</td><td align="center">==</td><td>			2,</td></tr>
<tr><td>			'vchSerial',</td><td align="center">==</td><td>			'vchSerial',</td></tr>
<tr><td>			'Serial #',</td><td align="center">==</td><td>			'Serial #',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			'Serial number'</td><td align="center">==</td><td>			'Serial number'</td></tr>
<tr><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Component'</td><td align="center">==</td><td>		where 	DT.vchName = 'Component'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'ChasisModelId',</td><td align="center">==</td><td>			'ChasisModelId',</td></tr>
<tr><td>			'Model',</td><td align="center">==</td><td>			'Model',</td></tr>
<tr><td>			'EquipModels',</td><td align="center">==</td><td>			'EquipModels',</td></tr>
<tr><td>			'vchModelName',</td><td align="center">==</td><td>			'vchModelName',</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			8,</td><td align="center">==</td><td>			8,</td></tr>
<tr><td>			'0',</td><td align="center">==</td><td>			'0',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Component'</td><td align="center">==</td><td>		where 	DT.vchName = 'Component'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select	@OrgId,</td><td align="center">==</td><td>		select	@OrgId,</td></tr>
<tr><td>			DT.[Id],</td><td align="center">==</td><td>			DT.[Id],</td></tr>
<tr><td>			ET.[Id],</td><td align="center">==</td><td>			ET.[Id],</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'vchChassis',</td><td align="center">==</td><td>			'vchChassis',</td></tr>
<tr><td>			'Chassis #',</td><td align="center">==</td><td>			'Chassis #',</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			null,</td><td align="center">==</td><td>			null,</td></tr>
<tr><td>			0,</td><td align="center">==</td><td>			0,</td></tr>
<tr><td>			1,</td><td align="center">==</td><td>			1,</td></tr>
<tr><td>			'N''''',</td><td align="center">==</td><td>			'N''''',</td></tr>
<tr><td>			''</td><td align="center">==</td><td>			''</td></tr>
<tr><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td><td align="center">==</td><td>		from 	DataTypes as DT, EquipComponentTypes as ET</td></tr>
<tr><td>		where 	DT.vchName = 'Component'</td><td align="center">==</td><td>		where 	DT.vchName = 'Component'</td></tr>
<tr><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td><td align="center">==</td><td>		and	ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 8. An error occurred loading the Equipment Components Fields.'</td><td align="center">==</td><td>		print 'Step 8. An error occurred loading the Equipment Components Fields.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 8. Equipment Components Fields have been added to database'</td><td align="center">==</td><td>		print 'Step 8. Equipment Components Fields have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- Step 9. Models Names for different Types and Makers of Components</td><td align="center">==</td><td>	-- Step 9. Models Names for different Types and Makers of Components</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 1.</td><td align="center">==</td><td>		-- 1.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'All America'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'All America'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Engine')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Engine')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 2.</td><td align="center">==</td><td>		-- 2.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'International'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'International'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Engine')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Engine')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 3.</td><td align="center">==</td><td>		-- 3.</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, '360')</td><td align="center">==</td><td>		values(@OrgId, @RC, '360')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 4.</td><td align="center">==</td><td>		-- 4.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'CAT'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'CAT'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, '3208')</td><td align="center">==</td><td>		values(@OrgId, @RC, '3208')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 5.</td><td align="center">==</td><td>		-- 5.</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'C.7')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'C.7')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 6.</td><td align="center">==</td><td>		-- 6.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Engine')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Engine')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 7.</td><td align="center">==</td><td>		-- 7.</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Motor')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Motor')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 8.</td><td align="center">==</td><td>		-- 8.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'CUM'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'CUM'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, '8.3')</td><td align="center">==</td><td>		values(@OrgId, @RC, '8.3')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 9.</td><td align="center">==</td><td>		-- 9.</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, '5.9')</td><td align="center">==</td><td>		values(@OrgId, @RC, '5.9')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 10.</td><td align="center">==</td><td>		-- 10.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'DT'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'DT'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Engine'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, '466')</td><td align="center">==</td><td>		values(@OrgId, @RC, '466')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 11.</td><td align="center">==</td><td>		-- 11.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'All America'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'All America'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Transmission')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Transmission')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 12.</td><td align="center">==</td><td>		-- 12.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'International'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'International'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Transmission')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Transmission')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 13.</td><td align="center">==</td><td>		-- 13.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'ALLISION'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'ALLISION'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, '643')</td><td align="center">==</td><td>		values(@OrgId, @RC, '643')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 14.</td><td align="center">==</td><td>		-- 14.</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, '545')</td><td align="center">==</td><td>		values(@OrgId, @RC, '545')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 15.</td><td align="center">==</td><td>		-- 15.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Transmission')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Transmission')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 16.</td><td align="center">==</td><td>		-- 16.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'ALLAMER'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'ALLAMER'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Transmission'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, '545COM')</td><td align="center">==</td><td>		values(@OrgId, @RC, '545COM')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 17.</td><td align="center">==</td><td>		-- 17.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'All America'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'All America'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Chassis')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Chassis')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 18.</td><td align="center">==</td><td>		-- 18.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'International'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'International'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Chassis')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Chassis')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 18.</td><td align="center">==</td><td>		-- 18.</td></tr>
<tr><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td><td align="center">==</td><td>		insert into [EquipModelType]([OrgId], [MakeId], [btIsComponent], [intTypeId])</td></tr>
<tr><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td><td align="center">==</td><td>		select @OrgId, EM.[Id], 1, ET.[Id]</td></tr>
<tr><td>		from EquipMakes as EM, EquipComponentTypes as ET</td><td align="center">==</td><td>		from EquipMakes as EM, EquipComponentTypes as ET</td></tr>
<tr><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td><td align="center">==</td><td>		where EM.OrgId = @OrgId and vchMakeName = 'Ford'</td></tr>
<tr><td>		and ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td><td align="center">==</td><td>		and ET.OrgId = @OrgId and ET.vchName = 'Chassis'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td><td align="center">==</td><td>		insert into [EquipModels]([OrgId], [TypeId], [vchModelName])</td></tr>
<tr><td>		values(@OrgId, @RC, 'Chassis')</td><td align="center">==</td><td>		values(@OrgId, @RC, 'Chassis')</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 9. An error occurred loading the Models Names for Components.'</td><td align="center">==</td><td>		print 'Step 9. An error occurred loading the Models Names for Components.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 9.  Models Names for Components have been added to database'</td><td align="center">==</td><td>		print 'Step 9.  Models Names for Components have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- Step 10. Repair Categories/Items</td><td align="center">==</td><td>	-- Step 10. Repair Categories/Items</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [RepairCats]([OrgId], [vchName], [vchDesc])</td><td align="center">==</td><td>		insert into [RepairCats]([OrgId], [vchName], [vchDesc])</td></tr>
<tr><td>		select @OrgId, 'Brakes', ''</td><td align="center">==</td><td>		select @OrgId, 'Brakes', ''</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Steering', ''</td><td align="center">==</td><td>		select @OrgId, 'Steering', ''</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Engine', 'Engine,Battery,Radiator,Belts,Heater,Exhaust'</td><td align="center">==</td><td>		select @OrgId, 'Engine', 'Engine,Battery,Radiator,Belts,Heater,Exhaust'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Lights/Instruments/Elec', 'Lights,Fuses,Bulbs,Horn,Alternator'</td><td align="center">==</td><td>		select @OrgId, 'Lights/Instruments/Elec', 'Lights,Fuses,Bulbs,Horn,Alternator'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Transmisson', ''</td><td align="center">==</td><td>		select @OrgId, 'Transmisson', ''</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Tires', ''</td><td align="center">==</td><td>		select @OrgId, 'Tires', ''</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Body', 'Wipers,Doors,Glass,Seats,Stop Arms,Mirrors'</td><td align="center">==</td><td>		select @OrgId, 'Body', 'Wipers,Doors,Glass,Seats,Stop Arms,Mirrors'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Other', 'Bus Supplies'</td><td align="center">==</td><td>		select @OrgId, 'Other', 'Bus Supplies'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [RepairItems]([OrgId], [CatId], [vchDesc])</td><td align="center">==</td><td>		insert into [RepairItems]([OrgId], [CatId], [vchDesc])</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Drums'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Drums'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Valves'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Valves'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Brake Fluid'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Brake Fluid'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Power Steering'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Power Steering'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Steering'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Steering'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Coolant Filter'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Coolant Filter'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Starter'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Starter'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Radiator'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Radiator'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Thermostat'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Thermostat'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Heater'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Heater'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Anti-Freeze'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Anti-Freeze'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Battery Cable'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Battery Cable'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Air Filter'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Air Filter'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Alternator'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Alternator'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Fuel Filter'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Fuel Filter'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Water Pump'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Water Pump'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Fan Belts'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Fan Belts'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Oil'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Oil'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Oil Filter'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Oil Filter'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Switches'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Switches'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Lights'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Lights'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Horn'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Horn'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Transmisson'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Transmisson'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Tran Fluid'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Tran Fluid'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Tires'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Tires'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Tires'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Tires'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Body'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Body'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Body'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Other'</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Other'</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Other'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Other'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 10. An error occurred loading the Repair Categories/Items.'</td><td align="center">==</td><td>		print 'Step 10. An error occurred loading the Repair Categories/Items.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 10. Repair Categories/Items have been added to database'</td><td align="center">==</td><td>		print 'Step 10. Repair Categories/Items have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- 11. Schedules of Preventive Maintenances</td><td align="center">==</td><td>	-- 11. Schedules of Preventive Maintenances</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [PMSchedules]([OrgId], [vchName])</td><td align="center">==</td><td>		insert into [PMSchedules]([OrgId], [vchName])</td></tr>
<tr><td>		select @OrgId, 'Bus Normal PM List'</td><td align="center">==</td><td>		select @OrgId, 'Bus Normal PM List'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Bus Extended PM List'</td><td align="center">==</td><td>		select @OrgId, 'Bus Extended PM List'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Truck Normal PM List'</td><td align="center">==</td><td>		select @OrgId, 'Truck Normal PM List'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Fork Lift Normal PM List'</td><td align="center">==</td><td>		select @OrgId, 'Fork Lift Normal PM List'</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 11. An error occurred loading the PM Schedules.'</td><td align="center">==</td><td>		print 'Step 11. An error occurred loading the PM Schedules.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 11.  PM Schedules have been added to database'</td><td align="center">==</td><td>		print 'Step 11.  PM Schedules have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- 12. PM Items</td><td align="center">==</td><td>	-- 12. PM Items</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [PMServices]([OrgId], [RepairCatId], [vchDesc], [btRequiresRepair])</td><td align="center">==</td><td>		insert into [PMServices]([OrgId], [RepairCatId], [vchDesc], [btRequiresRepair])</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Adjust Valve Clearance', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Adjust Valve Clearance', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Air Conditioner Compressor', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Air Conditioner Compressor', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Air Filter', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Air Filter', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Alignment', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Alignment', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Alternator', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Alternator', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Brake Drum Shoe', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Brake Drum Shoe', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Transmission Service', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Transmission Service', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Oil/Filter Service', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Oil/Filter Service', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Brake Fluid', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Brake Fluid', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Brake Shoes', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Brake Shoes', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Cap, Rotor, & Wire', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Cap, Rotor, & Wire', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Catalytic Converter', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Catalytic Converter', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Change Windshield Wipers', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Change Windshield Wipers', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Body'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Clean Fuel Injectors/Carburetor', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Clean Fuel Injectors/Carburetor', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Clutch Cylinder', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Clutch Cylinder', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Control Arm Lower Ball Joint', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Control Arm Lower Ball Joint', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Cooling System Flush', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Cooling System Flush', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Disc Brake Calipers', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Disc Brake Calipers', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Drum Brake Cylinders', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Drum Brake Cylinders', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Drum Brake Shoes', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Drum Brake Shoes', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Engine Belts', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Engine Belts', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Engine Tune Up', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Engine Tune Up', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Exhaust Pipes', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Exhaust Pipes', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Fuel Filter', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Fuel Filter', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Fuel Injectors', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Fuel Injectors', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Fuel Pump', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Fuel Pump', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Heater Core', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Heater Core', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'PCV Valve', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'PCV Valve', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Power Steering Pump', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Power Steering Pump', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Steering'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Steering'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Radiator', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Radiator', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Radiator Hoses', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Radiator Hoses', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Engine'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Recharge A/C', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Recharge A/C', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Replace Brakes', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Replace Brakes', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Replace Parking Light', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Replace Parking Light', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Rotate Tires', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Rotate Tires', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Tires'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Tires'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Shock Absorbers', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Shock Absorbers', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Spark Plugs', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Spark Plugs', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Springs', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Springs', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Starter', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Starter', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Strutts', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Strutts', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Thermostat', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Thermostat', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Tie Rods', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Tie Rods', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Steering'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Steering'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Timing Belt', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Timing Belt', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Timing Chain', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Timing Chain', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Lights/Instruments/Elec'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Tires and Balance', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Tires and Balance', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Tires'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Tires'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Transmission Filter', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Transmission Filter', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Universal CV Joint', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Universal CV Joint', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Water Pump', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Water Pump', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Body'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, RC.[Id], 'Wheel Alignment', 0</td><td align="center">==</td><td>		select @OrgId, RC.[Id], 'Wheel Alignment', 0</td></tr>
<tr><td>		from RepairCats RC</td><td align="center">==</td><td>		from RepairCats RC</td></tr>
<tr><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td><td align="center">==</td><td>		where RC.OrgId = @OrgId and RC.vchName = 'Transmisson'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		</td><td align="center">==</td><td>		</td></tr>
<tr><td>		insert into [PMSchedDetails](</td><td align="center">==</td><td>		insert into [PMSchedDetails](</td></tr>
<tr><td>			[OrgId],</td><td align="center">==</td><td>			[OrgId],</td></tr>
<tr><td>			[PMSchedId],</td><td align="center">==</td><td>			[PMSchedId],</td></tr>
<tr><td>			[PMServiceId],</td><td align="center">==</td><td>			[PMServiceId],</td></tr>
<tr><td>			[UnitMeasureId],</td><td align="center">==</td><td>			[UnitMeasureId],</td></tr>
<tr><td>			[intDays],</td><td align="center">==</td><td>			[intDays],</td></tr>
<tr><td>			[dmUnits]</td><td align="center">==</td><td>			[dmUnits]</td></tr>
<tr><td>			)</td><td align="center">==</td><td>			)</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 50000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 50000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Adjust Valve Clearance'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Adjust Valve Clearance'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 90, 8000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 90, 8000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Oil/Filter Service'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Oil/Filter Service'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 30, 25000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 30, 25000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Transmission Service'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Transmission Service'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 50000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 50000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Adjust Valve Clearance'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Adjust Valve Clearance'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 40000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 40000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Brake Drum Shoe'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Brake Drum Shoe'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Brake Fluid'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Brake Fluid'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Brake Shoes'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Brake Shoes'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Disc Brake Calipers'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Disc Brake Calipers'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Drum Brake Cylinders'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Drum Brake Cylinders'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 40000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 40000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Drum Brake Shoes'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Drum Brake Shoes'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 180, 7500.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 180, 7500.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Replace Brakes'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Replace Brakes'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Power Steering Pump'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Power Steering Pump'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Tie Rods'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Tie Rods'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Air Conditioner Compressor'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Air Conditioner Compressor'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 365, 10000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 365, 10000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Air Filter'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Air Filter'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 20000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 20000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Alignment'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Alignment'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 60000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 60000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Cap, Rotor, & Wire'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Cap, Rotor, & Wire'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Catalytic Converter'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Catalytic Converter'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 90, 3000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 90, 3000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Clean Fuel Injectors/Carburetor'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Clean Fuel Injectors/Carburetor'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Clutch Cylinder'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Clutch Cylinder'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1095, 45000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1095, 45000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Cooling System Flush'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Cooling System Flush'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 60000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 60000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Engine Belts'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Engine Belts'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 60000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 60000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Engine Tune Up'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Engine Tune Up'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 80000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 80000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Exhaust Pipes'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Exhaust Pipes'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1095, 40000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1095, 40000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Fuel Filter'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Fuel Filter'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Fuel Injectors'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Fuel Injectors'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Fuel Pump'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Fuel Pump'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Heater Core'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Heater Core'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 40000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1460, 40000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'PCV Valve'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'PCV Valve'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 60000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 60000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Radiator'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Radiator'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 60000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 60000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Radiator Hoses'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Radiator Hoses'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Alternator'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Alternator'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Control Arm Lower Ball Joint'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Control Arm Lower Ball Joint'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Recharge A/C'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Recharge A/C'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 356, 8000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 356, 8000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Replace Parking Light'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Replace Parking Light'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Spark Plugs'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Spark Plugs'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Starter'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Starter'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 60000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 60000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Thermostat'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Thermostat'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 2190, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 2190, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Timing Belt'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Timing Belt'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 2190, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 2190, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Timing Chain'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Timing Chain'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Shock Absorbers'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Shock Absorbers'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 100000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Springs'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Springs'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 60000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 60000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Strutts'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Strutts'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Transmission Filter'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Transmission Filter'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Universal CV Joint'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Universal CV Joint'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 540, 20000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 540, 20000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Wheel Alignment'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Wheel Alignment'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 180, 7500.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 180, 7500.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Rotate Tires'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Rotate Tires'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1095, 40000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 1095, 40000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Tires and Balance'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Tires and Balance'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 30000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Change Windshield Wipers'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Change Windshield Wipers'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], NULL, 90000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Bus Extended PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Water Pump'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Water Pump'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 50000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 50000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Truck Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Truck Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Adjust Valve Clearance'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Adjust Valve Clearance'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 90, 8000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 90, 8000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Truck Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Truck Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Oil/Filter Service'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Oil/Filter Service'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 30, 25000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 30, 25000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Truck Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Truck Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Transmission Service'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Transmission Service'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 50000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 730, 50000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Fork Lift Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Fork Lift Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Adjust Valve Clearance'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Adjust Valve Clearance'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 90, 8000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 90, 8000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Fork Lift Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Fork Lift Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Oil/Filter Service'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Oil/Filter Service'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 30, 25000.00000000</td><td align="center">==</td><td>		select 	@OrgId, PMS.[Id], S.[Id], UM.[Id], 30, 25000.00000000</td></tr>
<tr><td>		from 	PMSchedules as PMS,</td><td align="center">==</td><td>		from 	PMSchedules as PMS,</td></tr>
<tr><td>			PMServices as S,</td><td align="center">==</td><td>			PMServices as S,</td></tr>
<tr><td>			UnitMeasures as UM</td><td align="center">==</td><td>			UnitMeasures as UM</td></tr>
<tr><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Fork Lift Normal PM List'</td><td align="center">==</td><td>		where 	PMS.OrgId = @OrgId and PMS.vchName = 'Fork Lift Normal PM List'</td></tr>
<tr><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Transmission Service'</td><td align="center">==</td><td>		and	S.OrgId = @OrgId and S.vchDesc = 'Transmission Service'</td></tr>
<tr><td>		and	UM.vchName = 'miles'</td><td align="center">==</td><td>		and	UM.vchName = 'miles'</td></tr>
<tr><td>		</td><td align="center">==</td><td>		</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 12. An error occurred loading the PM Items.'</td><td align="center">==</td><td>		print 'Step 12. An error occurred loading the PM Items.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 12.  PM Items have been added to database'</td><td align="center">==</td><td>		print 'Step 12.  PM Items have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- 14. Inspections, Inspection Items</td><td align="center">==</td><td>	-- 14. Inspections, Inspection Items</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Inspections]([OrgId], [vchName])</td><td align="center">==</td><td>		insert into [Inspections]([OrgId], [vchName])</td></tr>
<tr><td>		select @OrgId, 'Bus - Monthly Service Inspection'</td><td align="center">==</td><td>		select @OrgId, 'Bus - Monthly Service Inspection'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [InspectCats]([OrgId], [InspectId], [vchName], [tintOrder])</td><td align="center">==</td><td>		insert into [InspectCats]([OrgId], [InspectId], [vchName], [tintOrder])</td></tr>
<tr><td>		select @OrgId, @RC, 'Safety Devices', 1</td><td align="center">==</td><td>		select @OrgId, @RC, 'Safety Devices', 1</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, 'Brakes', 2</td><td align="center">==</td><td>		select @OrgId, @RC, 'Brakes', 2</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, 'Tires', 3</td><td align="center">==</td><td>		select @OrgId, @RC, 'Tires', 3</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, 'Front End', 4</td><td align="center">==</td><td>		select @OrgId, @RC, 'Front End', 4</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, 'Drive Train', 5</td><td align="center">==</td><td>		select @OrgId, @RC, 'Drive Train', 5</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, 'Body', 6</td><td align="center">==</td><td>		select @OrgId, @RC, 'Body', 6</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [InspectionItems]([OrgId], [InspectId], [InspectCatId], [vchDesc], [tintOrder], [btEnabled])</td><td align="center">==</td><td>		insert into [InspectionItems]([OrgId], [InspectId], [InspectCatId], [vchDesc], [tintOrder], [btEnabled])</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Stop Arm and Crossing Gate', 1, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Stop Arm and Crossing Gate', 1, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Flasher Lights and Strobe Lights', 2, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Flasher Lights and Strobe Lights', 2, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'First Aid Kit and Fire Extinguisher', 3, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'First Aid Kit and Fire Extinguisher', 3, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Body Fluid Clean-up Kit', 4, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Body Fluid Clean-up Kit', 4, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Disabled Vehicle Warning Devices', 5, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Disabled Vehicle Warning Devices', 5, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Turn Signals,Lights and Horn', 6, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Turn Signals,Lights and Horn', 6, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Dash Instruments, Gauges & Speedometer', 7, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Dash Instruments, Gauges & Speedometer', 7, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Safety Devices'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Service Brakes - Primary', 1, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Service Brakes - Primary', 1, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Service Brakes - Backup', 2, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Service Brakes - Backup', 2, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Parking Brake', 3, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Parking Brake', 3, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Pedal Pressure and Clearance', 4, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Pedal Pressure and Clearance', 4, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Air or Hydraulic Hoses', 5, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Air or Hydraulic Hoses', 5, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Air Pressure or Hydraulic Fluid', 6, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Air Pressure or Hydraulic Fluid', 6, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Brakes'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Front Tires: Tread -- Cuts/Cracks', 1, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Front Tires: Tread -- Cuts/Cracks', 1, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Tires'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Tires'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Read Tires: Tread -- Cuts/Cracks', 2, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Read Tires: Tread -- Cuts/Cracks', 2, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Tires'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Tires'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Tires Properly Inflated', 3, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Tires Properly Inflated', 3, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Tires'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Tires'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Spindles and Wheel Alignment', 1, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Spindles and Wheel Alignment', 1, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Front End'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Front End'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Tie Rods and Drag Links', 2, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Tie Rods and Drag Links', 2, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Front End'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Front End'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Front Springs, Clamps and Shackles', 3, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Front Springs, Clamps and Shackles', 3, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Front End'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Front End'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Power Steering Tight and Fluid Level', 4, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Power Steering Tight and Fluid Level', 4, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Front End'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Front End'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Governor Properly Set and Working', 1, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Governor Properly Set and Working', 1, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Fuel Line and Tank(s)', 2, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Fuel Line and Tank(s)', 2, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Fuel and Water Pumps', 3, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Fuel and Water Pumps', 3, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Oil and Air Filters', 4, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Oil and Air Filters', 4, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Motor Supports: Front and Rear', 5, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Motor Supports: Front and Rear', 5, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Exhaust System', 6, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Exhaust System', 6, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Fan Belt(s)', 7, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Fan Belt(s)', 7, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Alternator and Battery(ies)', 8, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Alternator and Battery(ies)', 8, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Starter', 9, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Starter', 9, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Engine Oil Level', 10, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Engine Oil Level', 10, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Transmission Fluid Level', 11, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Transmission Fluid Level', 11, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Coolant Level and Hoses', 12, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Coolant Level and Hoses', 12, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Univ. Joints and D. S. Bearings', 13, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Univ. Joints and D. S. Bearings', 13, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Rear Springs, Clamps and Shackles', 14, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Rear Springs, Clamps and Shackles', 14, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Wheel: Lug Bolts Tight', 15, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Wheel: Lug Bolts Tight', 15, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Bus Properly Lubricated', 16, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Bus Properly Lubricated', 16, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Drive Train'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Rear View and Cross-over Mirrors', 1, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Rear View and Cross-over Mirrors', 1, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Fenders, Cowl and Bumpers', 2, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Fenders, Cowl and Bumpers', 2, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Driver''s Seat and Seat Belt', 3, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Driver''s Seat and Seat Belt', 3, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Entrance Door, Steps and Stepwell Light', 4, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Entrance Door, Steps and Stepwell Light', 4, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Emergency Door(s) and Buzzer(s)', 5, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Emergency Door(s) and Buzzer(s)', 5, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Glass: Doors, Windows and Windshield', 6, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Glass: Doors, Windows and Windshield', 6, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Seats: Anchor, Upholstery and Cushion Attached', 7, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Seats: Anchor, Upholstery and Cushion Attached', 7, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Windshield Wiper and Washer', 8, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Windshield Wiper and Washer', 8, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, @RC, IC.[Id], 'Cleanliness/ Interior of Body', 9, 1</td><td align="center">==</td><td>		select @OrgId, @RC, IC.[Id], 'Cleanliness/ Interior of Body', 9, 1</td></tr>
<tr><td>		from InspectCats IC</td><td align="center">==</td><td>		from InspectCats IC</td></tr>
<tr><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td><td align="center">==</td><td>		where IC.OrgId = @OrgId and InspectId = @RC and vchName = 'Body'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [InspectionItems_PMSchedDetails]([OrgId], [InspectItemId], [PMSchedDetailId])</td><td align="center">==</td><td>		insert into [InspectionItems_PMSchedDetails]([OrgId], [InspectItemId], [PMSchedDetailId])</td></tr>
<tr><td>		select @OrgId, II.[Id], PMD.[Id]</td><td align="center">==</td><td>		select @OrgId, II.[Id], PMD.[Id]</td></tr>
<tr><td>		from InspectionItems II, PMSchedDetails PMD</td><td align="center">==</td><td>		from InspectionItems II, PMSchedDetails PMD</td></tr>
<tr><td>		where II.OrgId = @OrgId and II.InspectId = @RC and II.vchDesc = 'Engine Oil Level'</td><td align="center">==</td><td>		where II.OrgId = @OrgId and II.InspectId = @RC and II.vchDesc = 'Engine Oil Level'</td></tr>
<tr><td>		and PMD.OrgId = @OrgId and PMD.PMServiceId in (</td><td align="center">==</td><td>		and PMD.OrgId = @OrgId and PMD.PMServiceId in (</td></tr>
<tr><td>			select [Id]</td><td align="center">==</td><td>			select [Id]</td></tr>
<tr><td>			from PMServices</td><td align="center">==</td><td>			from PMServices</td></tr>
<tr><td>			where OrgId = @OrgId and vchDesc = 'Oil/Filter Service'</td><td align="center">==</td><td>			where OrgId = @OrgId and vchDesc = 'Oil/Filter Service'</td></tr>
<tr><td>			)</td><td align="center">==</td><td>			)</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, II.[Id], PMD.[Id]</td><td align="center">==</td><td>		select @OrgId, II.[Id], PMD.[Id]</td></tr>
<tr><td>		from InspectionItems II, PMSchedDetails PMD</td><td align="center">==</td><td>		from InspectionItems II, PMSchedDetails PMD</td></tr>
<tr><td>		where II.OrgId = @OrgId and II.InspectId = @RC and II.vchDesc = 'Transmission Fluid Level'</td><td align="center">==</td><td>		where II.OrgId = @OrgId and II.InspectId = @RC and II.vchDesc = 'Transmission Fluid Level'</td></tr>
<tr><td>		and PMD.OrgId = @OrgId and PMD.PMServiceId in (</td><td align="center">==</td><td>		and PMD.OrgId = @OrgId and PMD.PMServiceId in (</td></tr>
<tr><td>			select [Id]</td><td align="center">==</td><td>			select [Id]</td></tr>
<tr><td>			from PMServices</td><td align="center">==</td><td>			from PMServices</td></tr>
<tr><td>			where OrgId = @OrgId and vchDesc = 'Transmission Service'</td><td align="center">==</td><td>			where OrgId = @OrgId and vchDesc = 'Transmission Service'</td></tr>
<tr><td>			)</td><td align="center">==</td><td>			)</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 14. An error occurred loading the Inspection Items.'</td><td align="center">==</td><td>		print 'Step 14. An error occurred loading the Inspection Items.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 14. Inspection and his items have been added to database'</td><td align="center">==</td><td>		print 'Step 14. Inspection and his items have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- 15. Inspection Schedules and his details</td><td align="center">==</td><td>	-- 15. Inspection Schedules and his details</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [InspectSchedules]([OrgId], [vchName])</td><td align="center">==</td><td>		insert into [InspectSchedules]([OrgId], [vchName])</td></tr>
<tr><td>		select @OrgId, 'Schedule for Monthly Inspection of Buses'</td><td align="center">==</td><td>		select @OrgId, 'Schedule for Monthly Inspection of Buses'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [InspectSchedDetails]([OrgId], [InspectSchedId], [InspectionId], [TargetDaysOut], [MinimumDaysOut], [MaximumDaysOut])</td><td align="center">==</td><td>		insert into [InspectSchedDetails]([OrgId], [InspectSchedId], [InspectionId], [TargetDaysOut], [MinimumDaysOut], [MaximumDaysOut])</td></tr>
<tr><td>		select @OrgId, @RC, I.[Id], 30, 24, 36</td><td align="center">==</td><td>		select @OrgId, @RC, I.[Id], 30, 24, 36</td></tr>
<tr><td>		from Inspections as I</td><td align="center">==</td><td>		from Inspections as I</td></tr>
<tr><td>		where I.OrgId = @OrgId and I.vchName = 'Bus - Monthly Service Inspection'</td><td align="center">==</td><td>		where I.OrgId = @OrgId and I.vchName = 'Bus - Monthly Service Inspection'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 15. An error occurred loading the Inspection Schedules.'</td><td align="center">==</td><td>		print 'Step 15. An error occurred loading the Inspection Schedules.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 15. Inspection Schedules have been added to database'</td><td align="center">==</td><td>		print 'Step 15. Inspection Schedules have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	-- 16. Users Information</td><td align="center">==</td><td>	-- 16. Users Information</td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Groups]([OrgId], [vchDesc], [CanDelete])</td><td align="center">==</td><td>		insert into [Groups]([OrgId], [vchDesc], [CanDelete])</td></tr>
<tr><td>		select @OrgId, 'Administrators', 0</td><td align="center">==</td><td>		select @OrgId, 'Administrators', 0</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Managers', 1</td><td align="center">==</td><td>		select @OrgId, 'Managers', 1</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Users', 1</td><td align="center">==</td><td>		select @OrgId, 'Users', 1</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Everyone', 0</td><td align="center">==</td><td>		select @OrgId, 'Everyone', 0</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 'Super Admin', 1</td><td align="center">==</td><td>		select @OrgId, 'Super Admin', 1</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		----</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [Groups_Permissions]([OrgId], [GroupId], [PermissionId])</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 4</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 7</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 9</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 10</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 11</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 12</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 13</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 14</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 16</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Administrators'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 9</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 10</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 11</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 12</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 13</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 14</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 16</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Managers'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 9</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 10</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 11</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 12</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 13</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 14</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 16</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Users'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Everyone'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Everyone'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrgId, G.[Id], 17</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [Groups] as G where OrgId = @OrgId and vchDesc = 'Super Admin'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		----</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 1.</td><td align="center">==</td><td>		-- 1.</td></tr>
<tr><td>		insert into [Logins]([vchFirstName], [vchLastName], [vchEmail], [vchPass], [btActive], [Initials], [PIN], [dtCreated], [CreatedLoginId], [dtUpdated], [UpdatedLoginId], [salt])</td><td align="center">==</td><td>		insert into [Logins]([vchFirstName], [vchLastName], [vchEmail], [vchPass], [btActive], [Initials], [PIN], [dtCreated], [CreatedLoginId], [dtUpdated], [UpdatedLoginId], [salt])</td></tr>
<tr><td>		select 'Admin', 'DemoAdmin', 'demoadmin@bigfleetsystem.com', '294D413D2790A85118F4DC2DD7F5C1788B1F4D92', 1, 'AD', '12345', @dtCreated, 3, @dtCreated, 3, 'XZ3kTMA='</td><td align="center">==</td><td>		select 'Admin', 'DemoAdmin', 'demoadmin@bigfleetsystem.com', '294D413D2790A85118F4DC2DD7F5C1788B1F4D92', 1, 'AD', '12345', @dtCreated, 3, @dtCreated, 3, 'XZ3kTMA='</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_UserTypes]([UserId], [UserTypeId])</td><td align="center">==</td><td>		insert into [Logins_UserTypes]([UserId], [UserTypeId])</td></tr>
<tr><td>		values(@RC, 1) -- add technician</td><td align="center">==</td><td>		values(@RC, 1) -- add technician</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 2.</td><td align="center">==</td><td>		-- 2.</td></tr>
<tr><td>		select @RC = L.[Id]</td><td align="center">==</td><td>		select @RC = L.[Id]</td></tr>
<tr><td>		from Logins L</td><td align="center">==</td><td>		from Logins L</td></tr>
<tr><td>		where vchFirstName = 'Tom' and vchLastName = 'Pryor'</td><td align="center">==</td><td>		where vchFirstName = 'Tom' and vchLastName = 'Pryor'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td></tr>
<tr><td>		</td><td align="center">==</td><td>		</td></tr>
<tr><td>		-- 3.</td><td align="center">==</td><td>		-- 3.</td></tr>
<tr><td>		select @RC = L.[Id]</td><td align="center">==</td><td>		select @RC = L.[Id]</td></tr>
<tr><td>		from Logins L</td><td align="center">==</td><td>		from Logins L</td></tr>
<tr><td>		where vchFirstName = 'Patrick' and vchLastName = 'Clements'</td><td align="center">==</td><td>		where vchFirstName = 'Patrick' and vchLastName = 'Clements'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td></tr>
<tr><td>		</td><td align="center">==</td><td>		</td></tr>
<tr><td>		-- 4.</td><td align="center">==</td><td>		-- 4.</td></tr>
<tr><td>		select @RC = L.[Id]</td><td align="center">==</td><td>		select @RC = L.[Id]</td></tr>
<tr><td>		from Logins L</td><td align="center">==</td><td>		from Logins L</td></tr>
<tr><td>		where vchFirstName = 'Jon' and vchLastName = 'Vickers'</td><td align="center">==</td><td>		where vchFirstName = 'Jon' and vchLastName = 'Vickers'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td></tr>
<tr><td>		</td><td align="center">==</td><td>		</td></tr>
<tr><td>		-- 5.</td><td align="center">==</td><td>		-- 5.</td></tr>
<tr><td>		select @RC = L.[Id]</td><td align="center">==</td><td>		select @RC = L.[Id]</td></tr>
<tr><td>		from Logins L</td><td align="center">==</td><td>		from Logins L</td></tr>
<tr><td>		where vchFirstName = 'Alexey' and vchLastName = 'Gavrilov'</td><td align="center">==</td><td>		where vchFirstName = 'Alexey' and vchLastName = 'Gavrilov'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Administrators'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Super Admin'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Super Admin'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 6.</td><td align="center">==</td><td>		-- 6.</td></tr>
<tr><td>		insert into [Logins]([vchFirstName], [vchLastName], [vchEmail], [vchPass], [btActive], [Initials], [PIN], [dtCreated], [CreatedLoginId], [dtUpdated], [UpdatedLoginId], [salt])</td><td align="center">==</td><td>		insert into [Logins]([vchFirstName], [vchLastName], [vchEmail], [vchPass], [btActive], [Initials], [PIN], [dtCreated], [CreatedLoginId], [dtUpdated], [UpdatedLoginId], [salt])</td></tr>
<tr><td>		select 'Manager', 'DemoManager', 'demomanager@bigfleetsystem.com', '294D413D2790A85118F4DC2DD7F5C1788B1F4D92', 1, 'MD', '12345', @dtCreated, 3, @dtCreated, 3, 'XZ3kTMA='</td><td align="center">==</td><td>		select 'Manager', 'DemoManager', 'demomanager@bigfleetsystem.com', '294D413D2790A85118F4DC2DD7F5C1788B1F4D92', 1, 'MD', '12345', @dtCreated, 3, @dtCreated, 3, 'XZ3kTMA='</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_UserTypes]([UserId], [UserTypeId])</td><td align="center">==</td><td>		insert into [Logins_UserTypes]([UserId], [UserTypeId])</td></tr>
<tr><td>		values(@RC, 1) -- add technician</td><td align="center">==</td><td>		values(@RC, 1) -- add technician</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Managers'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Managers'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 7.</td><td align="center">==</td><td>		-- 7.</td></tr>
<tr><td>		select @RC = L.[Id]</td><td align="center">==</td><td>		select @RC = L.[Id]</td></tr>
<tr><td>		from Logins L</td><td align="center">==</td><td>		from Logins L</td></tr>
<tr><td>		where vchFirstName = 'Mike' and vchLastName = 'Ramey'</td><td align="center">==</td><td>		where vchFirstName = 'Mike' and vchLastName = 'Ramey'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Managers'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Managers'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 8.</td><td align="center">==</td><td>		-- 8.</td></tr>
<tr><td>		select @RC = L.[Id]</td><td align="center">==</td><td>		select @RC = L.[Id]</td></tr>
<tr><td>		from Logins L</td><td align="center">==</td><td>		from Logins L</td></tr>
<tr><td>		where vchFirstName = 'William' and vchLastName = 'Murphy'</td><td align="center">==</td><td>		where vchFirstName = 'William' and vchLastName = 'Murphy'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Managers'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Managers'</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		-- 9.</td><td align="center">==</td><td>		-- 9.</td></tr>
<tr><td>		insert into [Logins]([vchFirstName], [vchLastName], [vchEmail], [vchPass], [btActive], [Initials], [PIN], [dtCreated], [CreatedLoginId], [dtUpdated], [UpdatedLoginId], [salt])</td><td align="center">==</td><td>		insert into [Logins]([vchFirstName], [vchLastName], [vchEmail], [vchPass], [btActive], [Initials], [PIN], [dtCreated], [CreatedLoginId], [dtUpdated], [UpdatedLoginId], [salt])</td></tr>
<tr><td>		select 'Operator', 'DemoOperator', 'demooperator@bigfleetsystem.com', '294D413D2790A85118F4DC2DD7F5C1788B1F4D92', 1, 'OD', '12345', @dtCreated, 3, @dtCreated, 3, 'XZ3kTMA='</td><td align="center">==</td><td>		select 'Operator', 'DemoOperator', 'demooperator@bigfleetsystem.com', '294D413D2790A85118F4DC2DD7F5C1788B1F4D92', 1, 'OD', '12345', @dtCreated, 3, @dtCreated, 3, 'XZ3kTMA='</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		select @RC = scope_identity()</td><td align="center">==</td><td>		select @RC = scope_identity()</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td><td align="center">==</td><td>		insert into [Logins_Orgs]([UserId], [OrgId])</td></tr>
<tr><td>		values(@RC, @OrgId)</td><td align="center">==</td><td>		values(@RC, @OrgId)</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_UserTypes]([UserId], [UserTypeId])</td><td align="center">==</td><td>		insert into [Logins_UserTypes]([UserId], [UserTypeId])</td></tr>
<tr><td>		values(@RC, 2) -- add technician</td><td align="center">==</td><td>		values(@RC, 2) -- add technician</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td><td align="center">==</td><td>		insert into [Logins_Groups]([OrgId], [UserId], [GroupId])</td></tr>
<tr><td>		select @OrgId, @RC, G.[Id]</td><td align="center">==</td><td>		select @OrgId, @RC, G.[Id]</td></tr>
<tr><td>		from Groups G</td><td align="center">==</td><td>		from Groups G</td></tr>
<tr><td>		where OrgId = @OrgId and vchDesc = 'Users'</td><td align="center">==</td><td>		where OrgId = @OrgId and vchDesc = 'Users'</td></tr>
<tr><td>		</td><td align="center">==</td><td>		</td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td>		print 'Step 16. An error occurred loading the Users.'</td><td align="center">==</td><td>		print 'Step 16. An error occurred loading the Users.'</td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td>		print 'Step 16. Users have been added to database'</td><td align="center">==</td><td>		print 'Step 16. Users have been added to database'</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	-- 17. Operators Instructions</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">	-- 17. Operator?s Instructions</font></td></tr>
<tr><td>	begin transaction</td><td align="center">==</td><td>	begin transaction</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>		insert into [OperatorInstructions]([OrgId], [TypeId], [vchNote])</td><td align="center">==</td><td>		insert into [OperatorInstructions]([OrgId], [TypeId], [vchNote])</td></tr>
<tr><td>		select @OrgId, 3, 'Thank you for using Demo County''s new work order system.'</td><td align="center">==</td><td>		select @OrgId, 3, 'Thank you for using Demo County''s new work order system.'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 3, 'Please remember to go through the Departure Check-Out process when your bus has been serviced.'</td><td align="center">==</td><td>		select @OrgId, 3, 'Please remember to go through the Departure Check-Out process when your bus has been serviced.'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 4, 'While technicians serve your equipment at your disposal a special room where you can have a rest, watch TV/DVD etc.'</td><td align="center">==</td><td>		select @OrgId, 4, 'While technicians serve your equipment at your disposal a special room where you can have a rest, watch TV/DVD etc.'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 5, 'You have requested a spare equipment. Please read the following instructions about spare equipment:<ul type="circle"><li>You will need to go to the front desk to get the keys</li><li>All spare equipment will need to be returned upon c</td><td align="center">==</td><td>		select @OrgId, 5, 'You have requested a spare equipment. Please read the following instructions about spare equipment:<ul type="circle"><li>You will need to go to the front desk to get the keys</li><li>All spare equipment will need to be returned upon c</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 1, 'Thank you for using Demo County''s new work order system.'</td><td align="center">==</td><td>		select @OrgId, 1, 'Thank you for using Demo County''s new work order system.'</td></tr>
<tr><td>		union all</td><td align="center">==</td><td>		union all</td></tr>
<tr><td>		select @OrgId, 8, 'Please return the spare equipments keys to the front desk clerk.'</td><td align="center">==</td><td>		select @OrgId, 8, 'Please return the spare equipments keys to the front desk clerk.'</td></tr>
<tr><td>		</td><td align="center">==</td><td>		</td></tr>
<tr><td>	if @@Error <> 0</td><td align="center">==</td><td>	if @@Error <> 0</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		rollback transaction</td><td align="center">==</td><td>		rollback transaction</td></tr>
<tr><td><font class="modified">		print 'Step 17. An error occurred loading the Operators Instructions.'</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">		print 'Step 17. An error occurred loading the Operator?s Instructions.'</font></td></tr>
<tr><td>		return (99)</td><td align="center">==</td><td>		return (99)</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	else</td><td align="center">==</td><td>	else</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		commit transaction</td><td align="center">==</td><td>		commit transaction</td></tr>
<tr><td><font class="modified">		print 'Step 17. Operators Instructions have been added to database'</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">		print 'Step 17. Operator?s Instructions have been added to database'</font></td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>--rollback</td><td align="center">==</td><td>--rollback</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td>SET ANSI_NULLS ON</td><td align="center">==</td><td>SET ANSI_NULLS ON</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td>SET QUOTED_IDENTIFIER ON</td><td align="center">==</td><td>SET QUOTED_IDENTIFIER ON</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V36" class="bodytxt" href="javascript:ShowComparison(V36, T36)">+</a></td><td nowrap>dbo.sp_OrgsDetail</td><td nowrap align="center"><font class="added"><</font><font class="deleted">></font></td><td nowrap>Update on largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T36"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%">-- Procedure</td><td width="4%" align="center">==</td><td width="48%">-- Procedure</td></tr>
<tr><td>SET QUOTED_IDENTIFIER OFF</td><td align="center">==</td><td>SET QUOTED_IDENTIFIER OFF</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td>SET ANSI_NULLS OFF</td><td align="center">==</td><td>SET ANSI_NULLS OFF</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td><font class="modified">create procedure dbo.sp_OrgsDetail</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">CREATE   procedure dbo.sp_OrgsDetail</font></td></tr>
<tr><td>(</td><td align="center">==</td><td>(</td></tr>
<tr><td>	@Action char(1),</td><td align="center">==</td><td>	@Action char(1),</td></tr>
<tr><td>	@Id int output,</td><td align="center">==</td><td>	@Id int output,</td></tr>
<tr><td>	@vchName varchar(50)=null output,</td><td align="center">==</td><td>	@vchName varchar(50)=null output,</td></tr>
<tr><td>	@btActive bit=null output,</td><td align="center">==</td><td>	@btActive bit=null output,</td></tr>
<tr><td>	@dtCreated datetime=null output,</td><td align="center">==</td><td>	@dtCreated datetime=null output,</td></tr>
<tr><td>	@dtUpdated datetime=null output,</td><td align="center">==</td><td>	@dtUpdated datetime=null output,</td></tr>
<tr><td>	@vchLogo varchar(255)=null output,</td><td align="center">==</td><td>	@vchLogo varchar(255)=null output,</td></tr>
<tr><td>	@btPrint bit=null output,</td><td align="center">==</td><td>	@btPrint bit=null output,</td></tr>
<tr><td>	@vchFullName varchar(255)=null output,</td><td align="center">==</td><td>	@vchFullName varchar(255)=null output,</td></tr>
<tr><td>	@vchAddress1 varchar(50)=null output,</td><td align="center">==</td><td>	@vchAddress1 varchar(50)=null output,</td></tr>
<tr><td>	@vchAddress2 varchar(50)=null output,</td><td align="center">==</td><td>	@vchAddress2 varchar(50)=null output,</td></tr>
<tr><td>	@vchCity varchar(50)=null output,</td><td align="center">==</td><td>	@vchCity varchar(50)=null output,</td></tr>
<tr><td>	@vchProvince varchar(50)=null output,</td><td align="center">==</td><td>	@vchProvince varchar(50)=null output,</td></tr>
<tr><td>	@vchPostalCode varchar(30)=null output,</td><td align="center">==</td><td>	@vchPostalCode varchar(30)=null output,</td></tr>
<tr><td>	@vchPhone varchar(20)=null output,</td><td align="center">==</td><td>	@vchPhone varchar(20)=null output,</td></tr>
<tr><td>	@vchPhone2 varchar(20)=null output,</td><td align="center">==</td><td>	@vchPhone2 varchar(20)=null output,</td></tr>
<tr><td>	@vchFax varchar(20)=null output,</td><td align="center">==</td><td>	@vchFax varchar(20)=null output,</td></tr>
<tr><td>	@vchAcctNumber varchar(50)=null output,</td><td align="center">==</td><td>	@vchAcctNumber varchar(50)=null output,</td></tr>
<tr><td>	@vchContactName varchar(50)=null output,</td><td align="center">==</td><td>	@vchContactName varchar(50)=null output,</td></tr>
<tr><td><font class="modified">	@vchNotes varchar(7000)=null output,</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">	@vchNotes varchar(4000)=null output,</font></td></tr>
<tr><td>	@vchWeb varchar(75)=null output,</td><td align="center">==</td><td>	@vchWeb varchar(75)=null output,</td></tr>
<tr><td>	@vchEmail varchar(75)=null output	</td><td align="center">==</td><td>	@vchEmail varchar(75)=null output	</td></tr>
<tr><td>) as</td><td align="center">==</td><td>) as</td></tr>
<tr><td>	set nocount on</td><td align="center">==</td><td>	set nocount on</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	if @Action = 'S'</td><td align="center">==</td><td>	if @Action = 'S'</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		if not exists(select 'true' from Orgs where [Id] = @Id)</td><td align="center">==</td><td>		if not exists(select 'true' from Orgs where [Id] = @Id)</td></tr>
<tr><td>			return -1</td><td align="center">==</td><td>			return -1</td></tr>
<tr><td>		else</td><td align="center">==</td><td>		else</td></tr>
<tr><td>		begin</td><td align="center">==</td><td>		begin</td></tr>
<tr><td>			select 	@vchName = [vchName],</td><td align="center">==</td><td>			select 	@vchName = [vchName],</td></tr>
<tr><td>				@btActive = [btActive],</td><td align="center">==</td><td>				@btActive = [btActive],</td></tr>
<tr><td>				@dtCreated = [dtCreated],</td><td align="center">==</td><td>				@dtCreated = [dtCreated],</td></tr>
<tr><td>				@dtUpdated = [dtCurrentDate],</td><td align="center">==</td><td>				@dtUpdated = [dtCurrentDate],</td></tr>
<tr><td>				@vchLogo = [vchLogo],</td><td align="center">==</td><td>				@vchLogo = [vchLogo],</td></tr>
<tr><td>				@btPrint = [btPrint],</td><td align="center">==</td><td>				@btPrint = [btPrint],</td></tr>
<tr><td>				@vchFullName = [vchFullName],</td><td align="center">==</td><td>				@vchFullName = [vchFullName],</td></tr>
<tr><td>				@vchAddress1 = [vchAddress1],</td><td align="center">==</td><td>				@vchAddress1 = [vchAddress1],</td></tr>
<tr><td>				@vchAddress2 = [vchAddress2],</td><td align="center">==</td><td>				@vchAddress2 = [vchAddress2],</td></tr>
<tr><td>				@vchCity = [vchCity],</td><td align="center">==</td><td>				@vchCity = [vchCity],</td></tr>
<tr><td>				@vchProvince = [vchProvince],</td><td align="center">==</td><td>				@vchProvince = [vchProvince],</td></tr>
<tr><td>				@vchPostalCode = [vchPostalCode],</td><td align="center">==</td><td>				@vchPostalCode = [vchPostalCode],</td></tr>
<tr><td>				@vchPhone = [vchPhone],</td><td align="center">==</td><td>				@vchPhone = [vchPhone],</td></tr>
<tr><td>				@vchPhone2 = [vchPhone2],</td><td align="center">==</td><td>				@vchPhone2 = [vchPhone2],</td></tr>
<tr><td>				@vchFax = [vchFax],</td><td align="center">==</td><td>				@vchFax = [vchFax],</td></tr>
<tr><td>				@vchAcctNumber = [vchAcctNumber],</td><td align="center">==</td><td>				@vchAcctNumber = [vchAcctNumber],</td></tr>
<tr><td>				@vchContactName = [vchContactName],</td><td align="center">==</td><td>				@vchContactName = [vchContactName],</td></tr>
<tr><td>				@vchNotes = [vchNotes],</td><td align="center">==</td><td>				@vchNotes = [vchNotes],</td></tr>
<tr><td>				@vchWeb = [vchWeb],</td><td align="center">==</td><td>				@vchWeb = [vchWeb],</td></tr>
<tr><td>				@vchEmail = [vchEmail]</td><td align="center">==</td><td>				@vchEmail = [vchEmail]</td></tr>
<tr><td>			from 	[Orgs]</td><td align="center">==</td><td>			from 	[Orgs]</td></tr>
<tr><td>			where 	[Id] = @Id</td><td align="center">==</td><td>			where 	[Id] = @Id</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>			return 0</td><td align="center">==</td><td>			return 0</td></tr>
<tr><td>		end</td><td align="center">==</td><td>		end</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td>	if @Action = 'U'</td><td align="center">==</td><td>	if @Action = 'U'</td></tr>
<tr><td>	begin</td><td align="center">==</td><td>	begin</td></tr>
<tr><td>		if @Id = 0</td><td align="center">==</td><td>		if @Id = 0</td></tr>
<tr><td>		begin  -- insert a new organization</td><td align="center">==</td><td>		begin  -- insert a new organization</td></tr>
<tr><td>			insert into [Orgs](</td><td align="center">==</td><td>			insert into [Orgs](</td></tr>
<tr><td>				[intBWAId],</td><td align="center">==</td><td>				[intBWAId],</td></tr>
<tr><td>				[vchName],</td><td align="center">==</td><td>				[vchName],</td></tr>
<tr><td>				[btActive],</td><td align="center">==</td><td>				[btActive],</td></tr>
<tr><td>				[dtCreated],</td><td align="center">==</td><td>				[dtCreated],</td></tr>
<tr><td>				[dtCurrentDate],</td><td align="center">==</td><td>				[dtCurrentDate],</td></tr>
<tr><td>				[vchLogo],</td><td align="center">==</td><td>				[vchLogo],</td></tr>
<tr><td>				[btPrint],</td><td align="center">==</td><td>				[btPrint],</td></tr>
<tr><td>				[vchFullName],</td><td align="center">==</td><td>				[vchFullName],</td></tr>
<tr><td>				[vchAddress1],</td><td align="center">==</td><td>				[vchAddress1],</td></tr>
<tr><td>				[vchAddress2],</td><td align="center">==</td><td>				[vchAddress2],</td></tr>
<tr><td>				[vchCity],</td><td align="center">==</td><td>				[vchCity],</td></tr>
<tr><td>				[vchProvince],</td><td align="center">==</td><td>				[vchProvince],</td></tr>
<tr><td>				[vchPostalCode],</td><td align="center">==</td><td>				[vchPostalCode],</td></tr>
<tr><td>				[vchPhone],</td><td align="center">==</td><td>				[vchPhone],</td></tr>
<tr><td>				[vchPhone2],</td><td align="center">==</td><td>				[vchPhone2],</td></tr>
<tr><td>				[vchFax],</td><td align="center">==</td><td>				[vchFax],</td></tr>
<tr><td>				[vchAcctNumber],</td><td align="center">==</td><td>				[vchAcctNumber],</td></tr>
<tr><td>				[vchContactName],</td><td align="center">==</td><td>				[vchContactName],</td></tr>
<tr><td>				[vchNotes],</td><td align="center">==</td><td>				[vchNotes],</td></tr>
<tr><td>				[vchWeb],</td><td align="center">==</td><td>				[vchWeb],</td></tr>
<tr><td>				[vchEmail]</td><td align="center">==</td><td>				[vchEmail]</td></tr>
<tr><td>				)</td><td align="center">==</td><td>				)</td></tr>
<tr><td>			values(	1,</td><td align="center">==</td><td>			values(	1,</td></tr>
<tr><td>				@vchName,</td><td align="center">==</td><td>				@vchName,</td></tr>
<tr><td>				1,</td><td align="center">==</td><td>				1,</td></tr>
<tr><td>				@dtCreated,</td><td align="center">==</td><td>				@dtCreated,</td></tr>
<tr><td>				@dtCreated,</td><td align="center">==</td><td>				@dtCreated,</td></tr>
<tr><td>				@vchLogo,</td><td align="center">==</td><td>				@vchLogo,</td></tr>
<tr><td>				@btPrint,</td><td align="center">==</td><td>				@btPrint,</td></tr>
<tr><td>				@vchFullName,</td><td align="center">==</td><td>				@vchFullName,</td></tr>
<tr><td>				@vchAddress1,</td><td align="center">==</td><td>				@vchAddress1,</td></tr>
<tr><td>				@vchAddress2,</td><td align="center">==</td><td>				@vchAddress2,</td></tr>
<tr><td>				@vchCity,</td><td align="center">==</td><td>				@vchCity,</td></tr>
<tr><td>				@vchProvince,</td><td align="center">==</td><td>				@vchProvince,</td></tr>
<tr><td>				@vchPostalCode,</td><td align="center">==</td><td>				@vchPostalCode,</td></tr>
<tr><td>				@vchPhone,</td><td align="center">==</td><td>				@vchPhone,</td></tr>
<tr><td>				@vchPhone2,</td><td align="center">==</td><td>				@vchPhone2,</td></tr>
<tr><td>				@vchFax,</td><td align="center">==</td><td>				@vchFax,</td></tr>
<tr><td>				@vchAcctNumber,</td><td align="center">==</td><td>				@vchAcctNumber,</td></tr>
<tr><td>				@vchContactName,</td><td align="center">==</td><td>				@vchContactName,</td></tr>
<tr><td>				convert(text, @vchNotes),</td><td align="center">==</td><td>				convert(text, @vchNotes),</td></tr>
<tr><td>				@vchWeb,</td><td align="center">==</td><td>				@vchWeb,</td></tr>
<tr><td>				@vchEmail</td><td align="center">==</td><td>				@vchEmail</td></tr>
<tr><td>				)</td><td align="center">==</td><td>				)</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>				select @Id = scope_identity()</td><td align="center">==</td><td>				select @Id = scope_identity()</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>				return 0</td><td align="center">==</td><td>				return 0</td></tr>
<tr><td>		end</td><td align="center">==</td><td>		end</td></tr>
<tr><td>		else</td><td align="center">==</td><td>		else</td></tr>
<tr><td>		begin  -- update organization</td><td align="center">==</td><td>		begin  -- update organization</td></tr>
<tr><td>			if not exists(select 'true' from Orgs where [Id] = @Id)</td><td align="center">==</td><td>			if not exists(select 'true' from Orgs where [Id] = @Id)</td></tr>
<tr><td>				return -1</td><td align="center">==</td><td>				return -1</td></tr>
<tr><td>			else</td><td align="center">==</td><td>			else</td></tr>
<tr><td>			begin</td><td align="center">==</td><td>			begin</td></tr>
<tr><td>				update 	[Orgs]</td><td align="center">==</td><td>				update 	[Orgs]</td></tr>
<tr><td>				set 	[vchName]=@vchName,</td><td align="center">==</td><td>				set 	[vchName]=@vchName,</td></tr>
<tr><td>					[btActive]=@btActive,</td><td align="center">==</td><td>					[btActive]=@btActive,</td></tr>
<tr><td>					[dtCurrentDate]=@dtUpdated,</td><td align="center">==</td><td>					[dtCurrentDate]=@dtUpdated,</td></tr>
<tr><td>					[vchLogo]=@vchLogo,</td><td align="center">==</td><td>					[vchLogo]=@vchLogo,</td></tr>
<tr><td>					[btPrint]=@btPrint,</td><td align="center">==</td><td>					[btPrint]=@btPrint,</td></tr>
<tr><td>					[vchFullName]=@vchFullName,</td><td align="center">==</td><td>					[vchFullName]=@vchFullName,</td></tr>
<tr><td>					[vchAddress1]=@vchAddress1,</td><td align="center">==</td><td>					[vchAddress1]=@vchAddress1,</td></tr>
<tr><td>					[vchAddress2]=@vchAddress2,</td><td align="center">==</td><td>					[vchAddress2]=@vchAddress2,</td></tr>
<tr><td>					[vchCity]=@vchCity,</td><td align="center">==</td><td>					[vchCity]=@vchCity,</td></tr>
<tr><td>					[vchProvince]=@vchProvince,</td><td align="center">==</td><td>					[vchProvince]=@vchProvince,</td></tr>
<tr><td>					[vchPostalCode]=@vchPostalCode,</td><td align="center">==</td><td>					[vchPostalCode]=@vchPostalCode,</td></tr>
<tr><td>					[vchPhone]=@vchPhone,</td><td align="center">==</td><td>					[vchPhone]=@vchPhone,</td></tr>
<tr><td>					[vchPhone2]=@vchPhone2,</td><td align="center">==</td><td>					[vchPhone2]=@vchPhone2,</td></tr>
<tr><td>					[vchFax]=@vchFax,</td><td align="center">==</td><td>					[vchFax]=@vchFax,</td></tr>
<tr><td>					[vchAcctNumber]=@vchAcctNumber,</td><td align="center">==</td><td>					[vchAcctNumber]=@vchAcctNumber,</td></tr>
<tr><td>					[vchContactName]=@vchContactName,</td><td align="center">==</td><td>					[vchContactName]=@vchContactName,</td></tr>
<tr><td>					[vchNotes]=convert(text, @vchNotes),</td><td align="center">==</td><td>					[vchNotes]=convert(text, @vchNotes),</td></tr>
<tr><td>					[vchWeb]=@vchWeb,</td><td align="center">==</td><td>					[vchWeb]=@vchWeb,</td></tr>
<tr><td>					[vchEmail]=@vchEmail</td><td align="center">==</td><td>					[vchEmail]=@vchEmail</td></tr>
<tr><td>				where 	[Id]=@Id</td><td align="center">==</td><td>				where 	[Id]=@Id</td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td>				return 0</td><td align="center">==</td><td>				return 0</td></tr>
<tr><td>			end</td><td align="center">==</td><td>			end</td></tr>
<tr><td>		end</td><td align="center">==</td><td>		end</td></tr>
<tr><td>	end</td><td align="center">==</td><td>	end</td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="added"><<</font></td><td><font class="modified">	return 1</font></td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td>SET ANSI_NULLS ON</td><td align="center">==</td><td>SET ANSI_NULLS ON</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
<tr><td>SET QUOTED_IDENTIFIER ON</td><td align="center">==</td><td>SET QUOTED_IDENTIFIER ON</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V37" class="bodytxt" href="javascript:ShowComparison(V37, T37)">+</a></td><td nowrap>dbo.sp_SelectOrgsListFromUser</td><td nowrap align="center"><font class="added"><</font><font class="deleted">></font></td><td nowrap>Update on largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T37"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%">-- Procedure</td><td width="4%" align="center">==</td><td width="48%">-- Procedure</td></tr>
<tr><td><font class="modified">CREATE    PROCEDURE dbo.sp_SelectOrgsListFromUser</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">CREATE   PROCEDURE dbo.sp_SelectOrgsListFromUser</font></td></tr>
<tr><td>(</td><td align="center">==</td><td>(</td></tr>
<tr><td>		@UserId int</td><td align="center">==</td><td>		@UserId int</td></tr>
<tr><td>)</td><td align="center">==</td><td>)</td></tr>
<tr><td>AS</td><td align="center">==</td><td>AS</td></tr>
<tr><td>	set nocount on</td><td align="center">==</td><td>	set nocount on</td></tr>
<tr><td>	</td><td align="center">==</td><td>	</td></tr>
<tr><td>	select 	O.[Id],</td><td align="center">==</td><td>	select 	O.[Id],</td></tr>
<tr><td>		O.[intBWAId],</td><td align="center">==</td><td>		O.[intBWAId],</td></tr>
<tr><td><font class="modified">		O.[vchName],</font></td><td align="center"><font class="added"><</font><font class="deleted">></font></td><td><font class="modified">		O.[vchName]</font></td></tr>
<tr><td><font class="modified">		O.vchLogo</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td>	from Orgs O</td><td align="center">==</td><td>	from Orgs O</td></tr>
<tr><td>	inner join Logins_Orgs LO</td><td align="center">==</td><td>	inner join Logins_Orgs LO</td></tr>
<tr><td>	on O.[Id] = LO.OrgId</td><td align="center">==</td><td>	on O.[Id] = LO.OrgId</td></tr>
<tr><td>	and LO.UserId = @UserId</td><td align="center">==</td><td>	and LO.UserId = @UserId</td></tr>
<tr><td>	and O.btActive = 1</td><td align="center">==</td><td>	and O.btActive = 1</td></tr>
<tr><td>GO</td><td align="center">==</td><td>GO</td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V38" class="bodytxt" href="javascript:ShowComparison(V38, T38)">+</a></td><td nowrap>dbo.sp_SetAssociationsRepair</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T38"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 9/2/2004</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: The procedure set the association between serviced repair and</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- issue (reported Issue, PM Item, Inspection Item)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE   procedure dbo.sp_SetAssociationsRepair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@btChecked bit,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@vchType varchar(25),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@ItemId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@RepairId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@ServiceResultId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @btAssociation bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @countLinks int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @RepairItemId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @i int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @N int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @PMSchedDetailId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @tmp_pm table(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[Id] int identity(1, 1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		PMSchedDetailId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- to define, is there association? and also RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select 	@btAssociation  = (case when count(RM.[Id]) = 0 then 0 else 1 end),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairItemId = isnull(S.ItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from RepairMult RM</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	inner join (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select 	'RI' as Type,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RI.[Id] as [Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RI.RepairItemId as ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrderReportedIssues RI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where RI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and RI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and RI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select 	'PMI' as Type,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			PMI.[Id] as [Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			PMI.RepairItemId as ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and PMI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and PMI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select 	'II' as Type,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			II.[Id] as [Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			II.RepairItemId as ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrderInspectItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where II.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and II.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and II.OrgId = @OrgId	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		) S</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	on RM.RepairId = @RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and S.ItemId = RM.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and S.Type = @vchType	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	group by S.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if isnull(@btChecked, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- unchecked or nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if isnull(@btAssociation, 0) = 1 -- if the accosiation was then delete it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- unchecked [delete association]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- So when we is removing association between a source and repair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- we must know how many repaires has source. (See in RepairMult table)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- if the repair is alone then this link will be deleted (a row in RepairMult)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- and also we set null in ServiceResultId, ServiceCheckId and RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- fields in source table</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- if the repaires are many then we delete only link (the RepairMult row)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- for curent repair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @countLinks = count([Id])</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where ItemId = isnull(@RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			if @countLinks < 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				delete</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where RepairId = @RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and ItemId = isnull(@RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			if @countLinks = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if @vchType = 'RI'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set 	ServiceResultId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						ServiceCheckId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if @vchType = 'PMI'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update 	WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set 	ServiceResultId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						ServiceCheckId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if @vchType = 'II'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update 	WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set 	ServiceResultId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						ServiceCheckId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else -- nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- checked or nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if isnull(@btAssociation, 0) = 0 -- if the association wasn't then insert it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- checked [insert association]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- Well, first we set ServiceResultId to source's table,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- second, we define has the current source another repaires.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- if yes then we define the RepairItemId from source and create row in</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- RepairMult table with defined ItemId.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- if not, we generate a new ItemId and also create a new row for RepairMult.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- if the source is PM item then we keep the history for his.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @RepairItemId = S.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from (	select 	'RI' as Type,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					RI.[Id] as [Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					RI.RepairItemId as ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderReportedIssues RI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where RI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	'PMI' as Type,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					PMI.[Id] as [Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					PMI.RepairItemId as ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and PMI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and PMI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				union all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	'II' as Type,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					II.[Id] as [Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					II.RepairItemId as ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderInspectItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where II.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and II.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and II.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				) S</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where S.Type = @vchType</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and S.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			if isnull(@RepairItemId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @RepairItemId = isnull(max(ItemId), 0) + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			insert into [RepairMult](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[RepairId]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if @vchType = 'RI'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	ServiceResultId = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if @vchType = 'PMI'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	ServiceResultId = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">				if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from EquipPMHistory EH</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	PMI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	PMI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	EH.WorkOrderid = PMI.WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	EH.OrgId = PMI.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	EH.PMSchedDetailId = PMI.PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- insert history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					insert into EquipPMHistory (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						dtDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						dmUnits,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						WO.EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						PMI.PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						WO.dmMileage,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						@OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	PMI.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and  	PMI.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- update history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update 	EquipPMHistory</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set 	dtDate = getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						dmUnits = WO.dmMileage</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	PMI.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and  	PMI.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	EquipPMHistory.EquipId = WO.Equipid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and	EquipPMHistory.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and	EquipPMHistory.PMSchedDetailId = PMI.PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	EquipPMHistory.WorkOrderId = PMI.WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if @vchType = 'II'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	ServiceResultId = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">				-- updated the PM items that associated with current Inspection Item</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from InspectionItems_PMSchedDetails I_P</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join WorkOrderInspectItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	II.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and  	II.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	II.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and  	I_P.InspectItemId = II.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	I_P.OrgId = II.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update 	WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set 	ServiceCheckId = 3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						ServiceResultId = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	isnull(RepairItemId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	PMSchedDetailId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select 	I_P.PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from 	InspectionItems_PMSchedDetails I_P</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						inner join WorkOrderInspectItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						on 	II.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and  	II.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	II.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and  	I_P.InspectItemId = II.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	I_P.OrgId = II.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- in any case we must to update of PM history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- that this pm items was serviced</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- select all associated PM Items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					insert into @tmp_pm(PMSchedDetailId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select 	PMSD.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join Equipments E</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	WO.EquipId = E.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	WO.ORgId = E.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join PMSchedDetails PMSD</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	PMSD.PMSchedId = E.PMScheduleId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	PMSD.OrgId = E.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join InspectionItems_PMSchedDetails IP</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	IP.PMSchedDetailId = PMSD.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	IP.OrgId = PMSD.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join WorkOrderInspectItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	II.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	II.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	IP.InspectItemId = II.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	IP.OrgId = II.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @i = 1, @N = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- update the PM History</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					while @i <= @N</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select @PMSchedDetailId = PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from @tmp_pm</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						-- in history table is keeping the last check of detail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						-- if the record already there then editing else adding</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from EquipPMHistory EH</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							inner join WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	EH.WorkOrderid = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	EH.EquipId = WO.EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	EH.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	EH.PMSchedDetailId = @PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin -- insert history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							insert into EquipPMHistory (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								dtDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								dmUnits,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								WO.EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								@PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								WO.dmMileage,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								@OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where  	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin -- update history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							update 	EquipPMHistory</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							set 	dtDate = getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								dmUnits = WO.dmMileage</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and	EquipPMHistory.EquipId = WO.Equipid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and	EquipPMHistory.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and	EquipPMHistory.PMSchedDetailId = @PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	EquipPMHistory.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select @i = @i + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else -- nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V39" class="bodytxt" href="javascript:ShowComparison(V39, T39)">+</a></td><td nowrap>dbo.sp_SetInspectItemChecks</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T39"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 9/2/2004</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: The procedure set te check status to inspection items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- in work order and PM items associated with instection items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE   procedure dbo.sp_SetInspectItemChecks</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ItemId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceCheckId int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceResultId int=null, -- old result status</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @IsDelete bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @RepairItemId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @i int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @N int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @PMSchedDetailId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @tmp table(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[Id] int identity(1, 1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		RepairId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @tmp_pm table(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[Id] int identity(1, 1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		PMSchedDetailId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrderInspectItems where [Id] = @ItemId and OrgId = @OrgId and WorkOrderId = @OrderId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- select the link to serviced repairs if they is there</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select 	@RepairItemId = isnull(RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from 	WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		-- set a new check status for the Inspection item</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	ServiceCheckId = @ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			ServiceResultId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		-- updating the PM Items that was associated with an Inspection items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- The association store in a InspectionItems_PMSchedDetails</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		if isnull(@ServiceCheckId, 0) = 1 or isnull(@ServiceCheckId, 0) = 2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- update PM Items according to InspectionItems_PMSchedDetails</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from InspectionItems_PMSchedDetails I_P</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join WorkOrderInspectItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on 	II.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and  	II.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	II.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and  	I_P.InspectItemId = II.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	I_P.OrgId = II.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	ServiceCheckId = @ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					ServiceResultId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	PMSchedDetailId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select 	I_P.PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from 	InspectionItems_PMSchedDetails I_P</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join WorkOrderInspectItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on 	II.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and  	II.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	II.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and  	I_P.InspectItemId = II.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	I_P.OrgId = II.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- in any case we must to update of PM history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- that this pm items was serviced</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- select all associated PM Items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				insert into @tmp_pm(PMSchedDetailId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	PMSD.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join Equipments E</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	WO.EquipId = E.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	WO.ORgId = E.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join PMSchedDetails PMSD</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on 	PMSD.PMSchedId = E.PMScheduleId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	PMSD.OrgId = E.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join InspectionItems_PMSchedDetails IP</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on 	IP.PMSchedDetailId = PMSD.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	IP.OrgId = PMSD.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join WorkOrderInspectItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on 	II.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	II.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	IP.InspectItemId = II.ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	IP.OrgId = II.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @i = 1, @N = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				while @i <= @N</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @PMSchedDetailId  = PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from @tmp_pm</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- in history table is keeping the last check of detail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- if the record already there then editing else adding</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from EquipPMHistory EH</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						inner join WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	EH.WorkOrderid = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	EH.EquipId = WO.EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	EH.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	EH.PMSchedDetailId = @PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin -- insert history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						insert into EquipPMHistory (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							dtDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							dmUnits,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							WO.EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							@PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							WO.dmMileage,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							@OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where  	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin -- update history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						update 	EquipPMHistory</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						set 	dtDate = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							dmUnits = WO.dmMileage</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and	EquipPMHistory.EquipId = WO.Equipid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and	EquipPMHistory.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and	EquipPMHistory.PMSchedDetailId = @PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	EquipPMHistory.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @i = @i + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		if isnull(@ServiceResultId, 0) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- if the deleting repair has relate to an other PM items, Issues, and Inspection Items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- then don't delete repair and only update this Inspection Items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and [Id] <> @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- processing all repairs for delete</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				insert into @tmp(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">				select @i = 1, @N = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">				delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- deleting all repairs, if repair has other issues (or other item)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- then don't delete it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				while @i <= @N</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from @tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from @tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and [Id] in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from @tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @i = @i + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V40" class="bodytxt" href="javascript:ShowComparison(V40, T40)">+</a></td><td nowrap>dbo.sp_SetInspectWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T40"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 09/15/2005</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: creating of the Work Order with Inspection on future</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_SetInspectWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@EquipId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@dtScheduledDate datetime,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@InspectSchedDetailId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@dtCurrentDate datetime,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrderId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@WorkOrderNumber int=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @intOperatorId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @DataId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @WOInspectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	select @WorkOrderNumber = isnull(max(WorkOrderNumber), 0) + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where datediff(minute, dateadd(d, datediff(d, '', @dtCurrentDate), ''), dtCreated) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and datediff(minute, dtCreated, dateadd(day, 1, dateadd(d, datediff(d, '', @dtCurrentDate), ''))) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and isnull(EquipOperatorId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and isnull(TempOperatorId, 0) = 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @intOperatorId = @UserId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @intOperatorId = (case when isnull(EquipOperatorId, 0) = 0 then TempOperatorId else EquipOperatorId end)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	insert into [EquipData](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[dtUpdated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[vchOrdering],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[ftItemOrder],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[intSize]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @DataId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	insert into [WorkOrders](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[WorkOrderNumber],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[TypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[StatusId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[OperatorStatusId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[DataId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[btIsActive],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[intOperatorId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[intTechId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[dtScheduled],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[dtUpdated]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderNumber,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@DataId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@intOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtScheduledDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	select @OrderId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	insert into WorkOrderInspections(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[InspectSchedDetailId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[TechId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[dtReport],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[btIsProcessed]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	values(	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	select @WOInspectId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	insert into [WorkOrderInspectItems](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[WorkOrderInspectId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[ItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[ServiceResultId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[ServiceCheckId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[RepairItemId]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WOInspectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		II.[Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from InspectionItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	inner join InspectSchedDetails ISD</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	on ISD.[Id] = @InspectSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and ISD.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and II.InspectId = ISD.InspectionId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and II.OrgId = ISD.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and II.btEnabled = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	order by II.InspectCatId, II.tintOrder asc</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V41" class="bodytxt" href="javascript:ShowComparison(V41, T41)">+</a></td><td nowrap>dbo.sp_SetIssueChecks</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T41"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_SetIssueChecks</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ItemId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceCheckId int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceResultId int=null -- old result status</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @IsDelete bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @RepairItemId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @i int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @N int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	create table #tmp(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[Id] int identity(1, 1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		RepairId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrderReportedIssues where [Id] = @ItemId and OrgId = @OrgId and WorkOrderId = @OrderId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select 	@RepairItemId = isnull(RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if isnull(@ServiceResultId, 0) > 0 -- then delete the his repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- if the deleting repair has relate to an other PM items, Issues, and Inspection Items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- then don't delete repair and only update this PM items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and [Id] <> @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- processing all repairs for delete</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				insert into #tmp(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @i = 1, @N = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- deleting all repairs, if repair has other issues (or other item)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- then don't delete it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				while @i <= @N</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and [Id] in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @i = @i + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	ServiceCheckId = @ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			ServiceResultId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V42" class="bodytxt" href="javascript:ShowComparison(V42, T42)">+</a></td><td nowrap>dbo.sp_SetNewTechToWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T42"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 02/21/2006</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: Setting a new technician for work order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.sp_SetNewTechToWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@intTechId int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@dtCurrentDate datetime,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@UpdatedLoginId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set 	intTechId = isnull(@intTechId, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		intUpdatedBy = isnull(@UpdatedLoginId, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		dtUpdated = @dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V43" class="bodytxt" href="javascript:ShowComparison(V43, T43)">+</a></td><td nowrap>dbo.sp_SetPassword</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T43"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_SetPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@vchPass varchar(40),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@Salt varchar(10)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists(select 'true' from Logins where [Id] = @UserId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	Logins</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	vchPass = @vchPass,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			salt = @Salt</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @UserId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V44" class="bodytxt" href="javascript:ShowComparison(V44, T44)">+</a></td><td nowrap>dbo.sp_SetPINCode</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T44"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create  procedure dbo.sp_SetPINCode</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@chInitials char(3),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@vchPIN varchar(10)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists(select 'true' from Logins where [Id] = @UserId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	Logins</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	PIN = @vchPIN</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @UserId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V45" class="bodytxt" href="javascript:ShowComparison(V45, T45)">+</a></td><td nowrap>dbo.sp_SetPMItemChecks</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T45"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.sp_SetPMItemChecks</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ItemId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceCheckId int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceResultId int=null, -- old result status</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@CurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @IsDelete bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @RepairItemId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @i int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @N int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	create table #tmp(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[Id] int identity(1, 1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		RepairId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrderPMItems where [Id] = @ItemId and OrgId = @OrgId and WorkOrderId = @OrderId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @RepairItemId = isnull(RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if isnull(@ServiceResultId, 0) > 0 -- then delete the his repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- if the deleting repair has relate to an other PM items, Issues, and Inspection Items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- then don't delete repair and only update this PM items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and [Id] <> @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- processing all repairs for delete</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				insert into #tmp(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @i = 1, @N = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- deleting all repairs, if repair has other issues (or other item)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- then don't delete it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				while @i <= @N</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and [Id] in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @i = @i + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	ServiceCheckId = @ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			ServiceResultId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @ServiceCheckId = 1 or @ServiceCheckId = 2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- in history table is keeping the last check of detail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- if the record already there then editing else adding</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from EquipPMHistory EH</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	PMI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	PMI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	EH.WorkOrderid = PMI.WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	EH.OrgId = PMI.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	EH.PMSchedDetailId = PMI.PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- insert history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				insert into EquipPMHistory (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					dtDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					dmUnits,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					WO.EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@CurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					PMI.PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					WO.dmMileage,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	PMI.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and  	PMI.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- update history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	EquipPMHistory</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	dtDate = @CurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					dmUnits = WO.dmMileage</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	PMI.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and  	PMI.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	EquipPMHistory.EquipId = WO.Equipid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and	EquipPMHistory.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and	EquipPMHistory.PMSchedDetailId = PMI.PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	EquipPMHistory.WorkOrderId = PMI.WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V46" class="bodytxt" href="javascript:ShowComparison(V46, T46)">+</a></td><td nowrap>dbo.sp_SetRepairResult</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T46"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_SetRepairResult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchType varchar(25),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceResultId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ItemId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairDesc varchar(4000)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairItemId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairCatId int=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- SP is adding repair and refresh the ServiceResultId status into source table</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- if @RepairId = 0 then we create a new repair and new record into RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- i.e. it is meaning the repair is new, if RepairId not equal zero then</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- it mean the relationship between two issues (sorces) and one repair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- then we get ItemId from RepairMult and set it into RepairItemId of source</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- and we get out  the information about repair of @RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @MultItemId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@RepairId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @RepairItemId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into Repairs(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			vchDesc</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			isnull(@RepairDesc, '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @RepairId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @MultItemId = max(ItemId) + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [RepairMult](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[ItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[RepairId]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@MultItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- else we modify the RepairItemId column of WorkOrderPMItems table</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select top 1 @MultItemId = ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and RepairId = @RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@vchType, '') = 'RI'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	ServiceResultId = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId = @MultItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@vchType, '') = 'PMI'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	ServiceResultId = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId = @MultItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- in history table is keeping the last check of detail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- if the record already there then editing else adding</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from EquipPMHistory EH</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	PMI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	PMI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	EH.WorkOrderid = PMI.WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	EH.OrgId = PMI.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	EH.PMSchedDetailId = PMI.PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- insert history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into EquipPMHistory (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				dtDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				dmUnits,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				WO.EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				PMI.PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				WO.dmMileage,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	PMI.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and  	PMI.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- update history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update 	EquipPMHistory</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set 	dtDate = getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				dmUnits = WO.dmMileage</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from 	WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	PMI.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and  	PMI.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	PMI.[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where 	EquipPMHistory.EquipId = WO.Equipid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and	EquipPMHistory.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and	EquipPMHistory.PMSchedDetailId = PMI.PMSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	EquipPMHistory.WorkOrderId = PMI.WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@vchType, '') = 'II'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	ServiceResultId = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId = @MultItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select 	@RepairDesc = R.vchDesc,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairItemId = isnull(R.RepairItemId, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairCatId = isnull(RI.CatId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from Repairs R</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	left outer join RepairItems RI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	on R.RepairItemId = RI.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and R.OrgId = RI.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where R.[Id] = @RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and R.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V47" class="bodytxt" href="javascript:ShowComparison(V47, T47)">+</a></td><td nowrap>dbo.sp_SetRoadsideWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T47"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 07/27/2005</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: creating of the Work Order for Roadside Repair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_SetRoadsideWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@EquipId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@TechId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@dtCurrentDate datetime,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrderId int output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @WorkOrderNumber int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @intOperatorId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @DataId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if @OrderId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @WorkOrderNumber = isnull(max(WorkOrderNumber), 0) + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where datediff(minute, dateadd(d, datediff(d, '', @dtCurrentDate), ''), dtCreated) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and datediff(minute, dtCreated, dateadd(day, 1, dateadd(d, datediff(d, '', @dtCurrentDate), ''))) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and isnull(EquipOperatorId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and isnull(TempOperatorId, 0) = 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @intOperatorId = @TechId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @intOperatorId = (case when isnull(EquipOperatorId, 0) = 0 then TempOperatorId else EquipOperatorId end)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [EquipData](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtUpdated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[vchOrdering],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[ftItemOrder],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[intSize]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @DataId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [WorkOrders](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[WorkOrderNumber],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[TypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[StatusId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OperatorStatusId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DataId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[btIsActive],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[intOperatorId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[intTechId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtScheduled],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtUpdated]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@WorkOrderNumber,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@DataId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@intOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@TechId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @OrderId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V48" class="bodytxt" href="javascript:ShowComparison(V48, T48)">+</a></td><td nowrap>dbo.sp_SetWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T48"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 06/06/2005</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: selecting or creating of the Work Order for current Equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- if for current equipment there aren't the scheduled work order then</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- it will be created. If there are one work order then select him.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- If them more than one then we are selecting the one that has</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- the scheduled time by closer to the current moment.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_SetWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@EquipId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@dtCurrentDate datetime,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@dmCurrentUnits decimal(19, 8),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@OrderId int output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @Count int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @WorkOrderNumber int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @intOperatorId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @DataId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @OrderId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @Count = count([Id])</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where WO.StatusId = 3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and isnull(WO.OperatorStatusId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and WO.EquipId = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and datediff(minute, WO.dtScheduled, dateadd(d, 2, dateadd(d, datediff(d, '', @dtCurrentDate), ''))) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		if isnull(@Count, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- to create a new work order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @WorkOrderNumber = isnull(max(WorkOrderNumber), 0) + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where datediff(minute, dateadd(d, datediff(d, '', @dtCurrentDate), ''), dtCreated) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and datediff(minute, dtCreated, dateadd(day, 1, dateadd(d, datediff(d, '', @dtCurrentDate), ''))) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and isnull(EquipOperatorId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and isnull(TempOperatorId, 0) = 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @intOperatorId = @UserId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @intOperatorId = (case when isnull(EquipOperatorId, 0) = 0 then TempOperatorId else EquipOperatorId end)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [EquipData](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtUpdated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[vchOrdering],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ftItemOrder],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intSize]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @DataId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [WorkOrders](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderNumber],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[TypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[StatusId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[DataId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[btIsActive],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intOperatorId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtScheduled],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtUpdated]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderNumber,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@DataId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @OrderId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if isnull(@Count, 0) > 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- to define the needed order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select top 1 @OrderId = [Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where StatusId = 3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and isnull(OperatorStatusId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and EquipId = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and datediff(minute, dtScheduled, dateadd(d, 2, dateadd(d, datediff(d, '', @dtCurrentDate), ''))) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				order by dtScheduled asc</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- select current order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @OrderId = [Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where StatusId = 3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and isnull(OperatorStatusId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and datediff(minute, dtScheduled, dateadd(d, 2, dateadd(d, datediff(d, '', @dtCurrentDate), ''))) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and EquipId = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and dmCurrentUnits < @dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- update the current units of equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [EquipUnitLogs](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[LogTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtDate],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dmUnits]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set dmCurrentUnits = @dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	dmMileage = @dmCurrentUnits,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			intUpdatedBy = @UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtUpdated = @dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V49" class="bodytxt" href="javascript:ShowComparison(V49, T49)">+</a></td><td nowrap>dbo.sp_SigningEquipmentCheckIn</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T49"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_SigningEquipmentCheckIn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@chInitials char(3),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPIN varchar(10),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dmCurrentUnits decimal(19,8),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@btStaying bit,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchDropedOffBy varchar(50),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @EquipId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @UserId = [Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from Logins</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where Initials = @chInitials</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and PIN = @vchPIN</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select 	@EquipId = EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and 	[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@UserId, 0) <> 0 and isnull(@EquipId, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	OperatorStatusId = 1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtArrival = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[vchDropedOffBy] = @vchDropedOffBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			bitStaying = @btStaying,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			intUpdatedBy = @UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtUpdated = @dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and dmCurrentUnits < @dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- update the current units of equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [EquipUnitLogs](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[LogTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtDate],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dmUnits]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set dmCurrentUnits = @dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set 	[dmMileage] = @dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [SignedDocuments](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[UserId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtSignDate]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V50" class="bodytxt" href="javascript:ShowComparison(V50, T50)">+</a></td><td nowrap>dbo.sp_SigningEquipmentCheckOut</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T50"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_SigningEquipmentCheckOut</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@chInitials char(3),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPIN varchar(10),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchReleasedTo varchar(50),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @UserId = [Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from Logins</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where Initials = @chInitials</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and PIN = @vchPIN	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@UserId, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	OperatorStatusId = 2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			vchReleasedTo = @vchReleasedTo,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtDeparture = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			intUpdatedBy = @UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtUpdated = @dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [SignedDocuments](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[UserId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtSignDate]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V51" class="bodytxt" href="javascript:ShowComparison(V51, T51)">+</a></td><td nowrap>dbo.sp_SigningInspection</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T51"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Last Modification Date: 09/09/2005</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: Procedure sign the inspection from technician</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_SigningInspection</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@chInitials char(3),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPIN varchar(10)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @CountItems int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists(select 'true' from Logins where Initials = @chInitials and PIN = @vchPIN)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @CountItems = count([Id])</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where WorkOrderInspectId = @InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and (	isnull(ServiceCheckId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			or (	isnull(ServiceCheckId, 0) = 3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and isnull(ServiceResultId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @CountItems > 0 -- if there are uncompleted items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update WorkOrderInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set btIsProcessed = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [SignedDocuments](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[UserId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[DocumentId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[DocumentTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtSignDate]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				L.[Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@InspectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				getdate()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from Logins L</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where L.Initials = @chInitials</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and L.PIN = @vchPIN</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- the history table is keeping the inspection history</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- of equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into EquipInspectHistory (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				dtDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				InspectSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				WO.EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				ISD.[Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from 	WorkOrderInspections WI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on WI.[Id] = @InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WI.WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WI.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WI.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join InspectSchedDetails ISD</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on ISD.[Id] = WI.InspectSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and ISD.OrgId = WI.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V52" class="bodytxt" href="javascript:ShowComparison(V52, T52)">+</a></td><td nowrap>dbo.sp_SigningWorkOrderClose</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T52"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_SigningWorkOrderClose</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@chInitials char(3),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPIN varchar(10),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchCleanliness varchar(1000),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists(select 'true' from Logins where Initials = @chInitials and PIN = @vchPIN)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- create a new unserviced reported issues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		insert into WorkOrderReportedIssues(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[vchDesc],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[LastWorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[RepairCatId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[ServiceResultId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[ServiceCheckId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[RepairItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtReport])</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select 	RI.OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RI.EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RI.vchDesc + ' (item copied from work order #' + convert(varchar, year(WO.dtCreated)) + '-' + convert(varchar, month(WO.dtCreated)) + '-' + convert(varchar, day(WO.dtCreated)) + '-' + convert(varchar, WO.WorkOrderNumber) + ')',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RI.WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RI.RepairCatId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RI.dtReport</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrderReportedIssues RI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		inner join WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		on 	RI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	RI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	isnull(RI.ServiceCheckId, 0) = 3</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	isnull(RI.ServiceResultId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	RI.WorkOrderId = WO.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	RI.OrgId = WO.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- change status</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	StatusId = 2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtClosed = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			vchCleanliness = @vchCleanliness</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		-- sign to close</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [SignedDocuments](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[UserId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtSignDate]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			L.[Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			4,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from Logins L</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where L.Initials = @chInitials</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and L.PIN = @vchPIN</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V53" class="bodytxt" href="javascript:ShowComparison(V53, T53)">+</a></td><td nowrap>dbo.sp_SigningWorkOrderOpen</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T53"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE   procedure dbo.sp_SigningWorkOrderOpen</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@chInitials char(3),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchPIN varchar(10),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists(select 'true' from Logins where Initials = @chInitials and PIN = @vchPIN)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if exists(select 'true' from WorkOrders where [Id] = @WorkOrderId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set 	dtOpened = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				StatusId = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where 	[Id] = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [SignedDocuments](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[UserId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[DocumentId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[DocumentTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtSignDate]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				L.[Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				5,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from Logins L</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where L.Initials = @chInitials</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and L.PIN = @vchPIN</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V54" class="bodytxt" href="javascript:ShowComparison(V54, T54)">+</a></td><td nowrap>dbo.sp_SigningWorkOrderReOpen</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T54"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_SigningWorkOrderReOpen</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and StatusId = 2)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set 	dtOpened = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				StatusId = 6,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				OperatorStatusId = 1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				dtClosed = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				dtDeparture = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				dtUpdated = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				intUpdatedBy = @UserId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [SignedDocuments](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[UserId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[DocumentId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[DocumentTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtSignDate]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				6,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V55" class="bodytxt" href="javascript:ShowComparison(V55, T55)">+</a></td><td nowrap>dbo.sp_UpdateActiveWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T55"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.sp_UpdateActiveWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set btIsActive = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V56" class="bodytxt" href="javascript:ShowComparison(V56, T56)">+</a></td><td nowrap>dbo.sp_UpdateCheckInWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T56"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_UpdateCheckInWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	OperatorStatusId = 1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtArrival = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			intUpdatedBy = @UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtUpdated = @dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [SignedDocuments](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[UserId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtSignDate]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V57" class="bodytxt" href="javascript:ShowComparison(V57, T57)">+</a></td><td nowrap>dbo.sp_UpdateCheckOutWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T57"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_UpdateCheckOutWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	OperatorStatusId = 2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtDeparture = @dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			intUpdatedBy = @UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtUpdated = @dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into [SignedDocuments](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[UserId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[DocumentTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[dtSignDate]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V58" class="bodytxt" href="javascript:ShowComparison(V58, T58)">+</a></td><td nowrap>dbo.sp_UpdateEquipAssignedTempTo</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T58"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.sp_UpdateEquipAssignedTempTo</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UId int, /*UserId*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@EquipId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@TempOperatorId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchNote varchar(250)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @TempOperatorIdFrom int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @TempOperatorId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @TempOperatorId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @TempOperatorIdFrom = TempOperatorId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	insert into EquipAssignLogs (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			IsTemp,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			AssignedFrom,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			AssignedTo,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			AssignedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			vchNote,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtUpdated</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	values (	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@TempOperatorIdFrom,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@TempOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@vchNote,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			getdate()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	update Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set TempOperatorId = @TempOperatorId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where OrgId=@OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and [Id]=@EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V59" class="bodytxt" href="javascript:ShowComparison(V59, T59)">+</a></td><td nowrap>dbo.sp_UpdateEquipAssignedTo</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T59"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_UpdateEquipAssignedTo</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UId int, /*UserId*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@EquipId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@EquipOperatorId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchNote varchar(250)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @EquipOperatorIdFrom int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @EquipOperatorId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @EquipOperatorId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @EquipOperatorIdFrom = EquipOperatorId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	insert into EquipAssignLogs (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			IsTemp,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			AssignedFrom,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			AssignedTo,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			AssignedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			vchNote,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			dtUpdated</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	values (	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@EquipOperatorIdFrom,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@EquipOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@UId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@vchNote,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			getdate()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	update Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set EquipOperatorId = @EquipOperatorId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where OrgId=@OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and [Id]=@EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	-- if this equipment has the unclosed work orders then</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- system to reassign iperator for these orders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	update WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set intOperatorId = @EquipOperatorId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where EquipId = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and isnull(OperatorStatusId, 0) <> 2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V60" class="bodytxt" href="javascript:ShowComparison(V60, T60)">+</a></td><td nowrap>dbo.sp_UpdateEquipSpare</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T60"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_UpdateEquipSpare</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@SpareEquipId int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchNote varchar(250),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@IsOperator bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @TempOperatorId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @SpareEquipIdFrom int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- if the spare is updating then assign the spare equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if isnull(@IsOperator, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@SpareEquipIdFrom = SpareEquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@TempOperatorId = intOperatorId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where 	[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@SpareEquipIdFrom = SpareEquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@TempOperatorId = @UserId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where 	[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	[Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		if isnull(@SpareEquipIdFrom, 0) <> isnull(@SpareEquipId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- assign or unassign the spare equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if isnull(@SpareEquipIdFrom, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- unassign the old spare equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				insert into EquipAssignLogs (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					IsTemp,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					AssignedFrom,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					AssignedTo,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					AssignedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					vchNote,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					dtUpdated)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@SpareEquipIdFrom,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					TempOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					'checking in the spare equipment',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @SpareEquipIdFrom</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">				update Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set TempOperatorId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @SpareEquipIdFrom</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if isnull(@SpareEquipId, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin -- assign the new spare equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				insert into EquipAssignLogs (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					IsTemp,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					AssignedFrom,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					AssignedTo,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					AssignedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					vchNote,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					dtUpdated</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@SpareEquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					TempOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@TempOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					'checking out the spare equipment',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @SpareEquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">				update Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set TempOperatorId = @TempOperatorId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and [Id] = @SpareEquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if isnull(@SpareEquipId, -1) <> -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set 	SpareEquipId = @SpareEquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				bitStaying = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V61" class="bodytxt" href="javascript:ShowComparison(V61, T61)">+</a></td><td nowrap>dbo.sp_UpdateFutureInspections</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T61"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 08/16/2005</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: The procedure move inspection from future work order to</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- current work order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_UpdateFutureInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @oldOrderId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrderInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @oldOrderId = WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from [WorkOrderInspections]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	[WorkOrderInspectItems]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	[WorkOrderId] = @OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[ServiceCheckId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[ServiceResultId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			[RepairItemId] = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[WorkOrderInspectId] = @InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		update 	[WorkOrderInspections]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	[WorkOrderId] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		select 	@OrderId = @oldOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V62" class="bodytxt" href="javascript:ShowComparison(V62, T62)">+</a></td><td nowrap>dbo.sp_UpdateInActiveUser</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T62"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.sp_UpdateInActiveUser</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@btActive bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from Logins where [Id] = @UserId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update Logins</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set btActive = @btActive</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @UserId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V63" class="bodytxt" href="javascript:ShowComparison(V63, T63)">+</a></td><td nowrap>dbo.sp_UpdateInActiveWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T63"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.sp_UpdateInActiveWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set btIsActive = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V64" class="bodytxt" href="javascript:ShowComparison(V64, T64)">+</a></td><td nowrap>dbo.sp_UpdateInspectionItems</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T64"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_UpdateInspectionItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectItemId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceCheckId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrderInspectItems where [Id] = @InspectItemId and OrgId = @OrgId and WorkOrderId = @OrderId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update 	WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set 	ServiceCheckId = @ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			ServiceResultId = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @InspectItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V65" class="bodytxt" href="javascript:ShowComparison(V65, T65)">+</a></td><td nowrap>dbo.sp_UpdateInspections</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T65"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 09/09/2005</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: The procedure add/delete inspection to the work order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_UpdateInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@btChecked bit,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ItemId int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectSchedDetailId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @tbl table ([Id] int identity(1,1), RepairItemId int)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @tbl2 table (RepairId int)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @IsDelete bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @i int, @N int, @j int, @M int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@btChecked, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- remove inspection or nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if exists(select 'true' from WorkOrderInspections where [Id] = isnull(@ItemId, 0) and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- unchecked [delete item and his sub-items]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- define all RepairItemIds related to the Inspection</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			insert into @tbl(RepairItemId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where WorkOrderInspectId = isnull(@ItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and isnull(RepairItemId, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- processing all repairs, if repair has the other sources</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- as PM items or Issues then we don't delete this repair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- or else we delete records of RepairMult, PartsUsed and</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- Repairs tables</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @i = 1, @N = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			while @i <= @N</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join @tbl tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on PMI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and PMI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and PMI.RepairItemId = tmp.RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and tmp.[Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderReportedIssues RI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join @tbl tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on RI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RI.WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RI.RepairItemId = tmp.RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and tmp.[Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">				if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- deleting the relate records</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					insert into @tbl2(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and ItemId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from @tbl</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @j = 1, @M = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">					delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and ItemId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from @tbl</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">					-- deleting all repairs, if repair has other issues (or other item)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- then don't delete it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					while @j <= @M</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								from @tbl2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								where [Id] = @j</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								from @tbl2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								where [Id] = @j</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and [Id] in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								from @tbl2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								where [Id] = @j</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select @j = @j + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">				select @i = @i + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			-- delete inspection items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			delete from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [WorkOrderInspectId] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			-- delete inspection</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			delete from WorkOrderInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else -- nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- add inspection or nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrderInspections where [Id] = isnull(@ItemId, 0) and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- checked [insert item and his sub-items]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into WorkOrderInspections(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[InspectSchedDetailId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[TechId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtReport],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[btIsProcessed]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@InspectSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				WO.intTechId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			select @ItemId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			insert into [WorkOrderInspectItems](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderInspectId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceResultId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceCheckId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[RepairItemId])</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				II.[Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from InspectionItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join InspectSchedDetails ISD</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on ISD.[Id] = @InspectSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and ISD.InspectionId = II.InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and ISD.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and ISD.OrgId = II.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and II.btEnabled = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			order by II.InspectCatId, II.tintOrder asc</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			return @ItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else -- nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V66" class="bodytxt" href="javascript:ShowComparison(V66, T66)">+</a></td><td nowrap>dbo.sp_UpdateOpenWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T66"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_UpdateOpenWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@intTechId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dmCurrentUnits decimal(19,8),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchDropedOffBy varchar(50),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @EquipId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrders where OrgId=@OrgId and [Id]=@Id)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select 	@EquipId = EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and 	[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">		if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where EquipId = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and [OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and StatusId in (1, 4, 5, 6))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set 	[intTechId] = @intTechId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[vchDropedOffBy] = @vchDropedOffBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intUpdatedBy] = isnull(@UserId, intUpdatedBy),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtUpdated] = @dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update WorkOrderInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set TechId = @intTechId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where WorkOrderId = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and dmCurrentUnits < @dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				-- update the current units of equipment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				insert into [EquipUnitLogs](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[LogTypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[dtDate],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[dmUnits]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@dtCurrentDate,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set dmCurrentUnits = @dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	[dmMileage] = @dmCurrentUnits</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V67" class="bodytxt" href="javascript:ShowComparison(V67, T67)">+</a></td><td nowrap>dbo.sp_UpdatePMItems</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T67"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_UpdatePMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@btChecked bit,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ItemId int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@PMSchedDetailId int=null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @RepairItemId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @IsDelete bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	create table #tmp(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[Id] int identity(1, 1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		RepairId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@btChecked, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- unchecked or nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if exists(select 'true' from WorkOrderPMItems where [Id] = @ItemId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- unchecked [delete item and his sub-items]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- delete issues and all data relating to him</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- from RepairMult. Repairs and PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@RepairItemId = isnull(RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = isnull(@ItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if isnull(@RepairItemId, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and [Id] <> isnull(@ItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- processing all repairs for delete</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					insert into #tmp(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where [Id] = isnull(@ItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairId in (select RepairId from #tmp)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and [Id] in (select RepairId from #tmp)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where [Id] = isnull(@ItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				delete from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = isnull(@ItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else -- nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- checked or nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrderPMItems where [Id] = @ItemId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- checked [insert item and his sub-items]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [WorkOrderPMItems](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[PMSchedDetailId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceResultId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceCheckId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[RepairItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtReport]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				isnull(@PMSchedDetailId, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				getdate()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else -- nothing</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	drop table #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V68" class="bodytxt" href="javascript:ShowComparison(V68, T68)">+</a></td><td nowrap>dbo.sp_UpdatePositionInspectItem</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T68"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.sp_UpdatePositionInspectItem</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectItemId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Position int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	update 	InspectionItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set 	tintOrder = convert(tinyint, @Position)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	where 	[Id] = @InspectItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and 	InspectId = @InspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V69" class="bodytxt" href="javascript:ShowComparison(V69, T69)">+</a></td><td nowrap>dbo.sp_UpdateReOpenWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T69"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.sp_UpdateReOpenWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@intOperatorId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ReOpenCategoryId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCurrentDate datetime</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and [Id] = @OrderId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and StatusId = 2)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [ReOpenLogs](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ReOpenCategoryId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OperatorId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[TechnicianId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[daCreated]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ReOpenCategoryId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				intTechId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCurrentDate</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V70" class="bodytxt" href="javascript:ShowComparison(V70, T70)">+</a></td><td nowrap>dbo.sp_UpdateRepair</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T70"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 9/2/2004</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: The procedure edit repair or add repair and set association</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- between new repair and issue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_UpdateRepair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchType varchar(25),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ItemId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceResultId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairDesc varchar(4000)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairItemId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairCatId int=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- So, if RepairId is 0 then we create a new repair and associate him</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- with inputted issue if not, we only edit the existed repair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @RC int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if isnull(@RepairId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @RepairItemId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @RepairItemId = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert into Repairs(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			vchDesc</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			@OrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			isnull(@RepairDesc, '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select @RepairId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @vchType <> 'FREE'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			exec @RC = [dbo].sp_SetAssociationsRepair 1, @OrgId, @OrderId, @vchType, @ItemId, @RepairId, @ServiceResultId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		exec @RC = [dbo].sp_RepairCommonDetail 'U', @OrgId, @OrderId, @RepairId, @RepairDesc OUTPUT, @RepairItemId OUTPUT , @RepairCatId OUTPUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return @RC</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V71" class="bodytxt" href="javascript:ShowComparison(V71, T71)">+</a></td><td nowrap>dbo.sp_UpdateStayingWorkOrder</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T71"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_UpdateStayingWorkOrder</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrderId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@btStaying bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if not exists(select 'true' from WorkOrders where [Id] = @OrderId and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set bitStaying = @btStaying</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		where [Id] = @OrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V72" class="bodytxt" href="javascript:ShowComparison(V72, T72)">+</a></td><td nowrap>dbo.sp_WorkOrderDetail</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T72"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">----------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Author: Alexey Gavrilov</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Date: 06/06/2005</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- Description: The procedure get information about work order and his</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">-- equipment, update work order and ALTER  a new work order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">---------------------------------------------------------------------------</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_WorkOrderDetail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Action char(1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderNumber int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@EquipId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchEquipId varchar(50)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchEquipTypeName varchar(50)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchEquipMakeModel varchar(102)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchEquipYear varchar(25)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchVinSerial varchar(50)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@SpareEquipId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchSpareEquipId varchar(50)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@TypeId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchType varchar(50)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@StatusId int=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchStatus varchar(50)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OperatorStatusId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchOperatorStatus varchar(50)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@DataId int=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@btIsActive bit=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchDesc varchar(8000)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@intOperatorId int=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchOperatorName varchar(102)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@intTechId int=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchTechName varchar(102)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dmMileage decimal(19,8)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bitStaying int=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchDropedOffBy varchar(50)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchReleasedTo varchar(50)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchCleanliness varchar(1000)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtScheduled datetime=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtArrival datetime=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtOpened datetime=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCompleted datetime=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtClosed datetime=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtDeparture datetime=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@intCreatedBy int=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchCreatedBy varchar(102)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtCreated datetime=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@intUpdatedBy int=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchUpdatedBy varchar(102)=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtUpdated datetime=null OUTPUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@btWizardUpdate bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'S'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrders where OrgId=@OrgId and [Id]=@Id)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@WorkOrderNumber = WO.[WorkOrderNumber],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@EquipId = WO.[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchEquipId = E.vchEquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchEquipTypeName = isnull(ET.vchName, 'unknown'),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchEquipMakeModel = isnull(EMa.vchMakeName, 'unknown') + '/' + isnull(EMo.vchModelName, 'unknown'),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchEquipYear = isnull(E.intYear, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchVinSerial = ISNULL(E.vchVinSerial, ''),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@TypeId = WO.TypeId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchType = WOT.vchName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@StatusId = WO.[StatusId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchStatus = WOS.vchStatus,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OperatorStatusId = isnull(WO.OperatorStatusId, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchOperatorStatus = isnull(WOOS.vchStatus, ''),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@SpareEquipId = isnull(WO.SpareEquipId, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchSpareEquipId = isnull(SpE.vchEquipId, 'none'),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@DataId = WO.[DataId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@btIsActive = WO.btIsActive,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intOperatorId = isnull(WO.[intOperatorId], 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchOperatorName = (select case when isnull(WO.[intOperatorId], 0) = 0 then '' else LOP.vchLastName + ', ' + LOP.vchFirstName end),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intTechId = isnull(WO.[intTechId], 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchTechName = (select case when isnull(WO.[intTechId], 0) = 0 then '' else LOT.vchLastName + ', ' + LOT.vchFirstName end),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dmMileage = isnull(WO.[dmMileage], 0.0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@bitStaying = WO.[bitStaying],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchDropedOffBy = isnull(WO.[vchDropedOffBy], ''),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchReleasedTo = isnull(WO.[vchReleasedTo], ''),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchCleanliness = isnull(WO.[vchCleanliness], ''),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtScheduled = WO.[dtScheduled],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtArrival = WO.[dtArrival],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtOpened = WO.[dtOpened],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCompleted = WO.dtCompleted,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtClosed = WO.[dtClosed],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtDeparture = WO.[dtDeparture],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intCreatedBy = WO.[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCreated = WO.[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchCreatedBy = ISNULL(LOC.vchLastName, 'Unknown') + ', ' + ISNULL(LOC.vchFirstName, 'Unknown'),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intUpdatedBy = WO.[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchUpdatedBy = ISNULL(LOU.vchLastName, 'Unknown') + ', ' + ISNULL(LOU.vchFirstName, 'Unknown'),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtUpdated = WO.[dtUpdated]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from [WorkOrders] WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join Equipments E</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.EquipId = E.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	WO.OrgId = E.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	WO.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	WO.[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join EquipTypes ET</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	E.TypeId = ET.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	E.OrgId = ET.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join WorkOrderTypes WOT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.TypeId = WOT.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join EquipModels EMo</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	EMo.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	EMo.[Id] = E.ModelId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join EquipModelType EMT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	EMT.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	EMT.[Id] = EMo.TypeId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join EquipMakes EMa</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	EMa.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	EMa.[Id] = EMT.MakeId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join Equipments SpE</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	isnull(WO.SpareEquipId, 0) = SpE.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	WO.OrgId = SpE.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join WorkOrderStatus WOS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.StatusId = WOS.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join WorkOrderOperatorStatus WOOS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.OperatorStatusId = WOOS.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join Logins LOP</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.intOperatorId = LOP.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join Logins LOT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.intTechId = LOT.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join Logins LOC</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.intCreatedBy = LOC.[Id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			left outer join Logins LOU</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on 	WO.intUpdatedBy = LOU.[id]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'U'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @Id = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- insert Work Order and EquipData</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @WorkOrderNumber = isnull(max(WorkOrderNumber), 0) + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where datediff(minute, dateadd(d, datediff(d, '', @dtCreated), ''), dtCreated) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and datediff(minute, dtCreated, dateadd(day, 1, dateadd(d, datediff(d, '', @dtCreated), ''))) > 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and isnull(EquipOperatorId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and isnull(TempOperatorId, 0) = 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @intOperatorId = isnull(@intUpdatedBy, 6)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @intOperatorId = (case when isnull(EquipOperatorId, 0) = 0 then TempOperatorId else EquipOperatorId end)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from Equipments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			insert into [EquipData](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtUpdated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[vchOrdering],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ftItemOrder],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intSize]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intCreatedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCreated,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intUpdatedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCreated,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @DataId = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [WorkOrders](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderNumber],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[TypeId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[StatusId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[DataId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[btIsActive],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intOperatorId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtScheduled],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intCreatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtCreated],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intUpdatedBy],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtUpdated]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderNumber,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@TypeId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@StatusId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@DataId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intOperatorId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtScheduled,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intCreatedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCreated,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@intUpdatedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtCreated</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- update Work Order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true' from WorkOrders where OrgId=@OrgId and [Id]=@Id)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if isnull(@btWizardUpdate, 0) = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- update for wo_editAddInfo.aspx screen</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set 	[TypeId] = @TypeId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[dtScheduled] = @dtScheduled,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[intUpdatedBy] = @intUpdatedBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[dtUpdated] = @dtUpdated</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- update for wo_editWorkOrder.aspx</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update 	[WorkOrders]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set 	[TypeId] = @TypeId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[intTechId] = @intTechId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[bitStaying] = isnull(@bitStaying, bitStaying),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[vchDropedOffBy] = @vchDropedOffBy,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[vchReleasedTo] = @vchReleasedTo,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[vchCleanliness] = @vchCleanliness,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[dtScheduled] = isnull(@dtScheduled, dtScheduled),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[intUpdatedBy] = isnull(@intUpdatedBy, intUpdatedBy),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[dtUpdated] = @dtUpdated</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	[OrgId]=@OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	[Id]=@Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update WorkOrderInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set TechId = @intTechId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where WorkOrderId = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V73" class="bodytxt" href="javascript:ShowComparison(V73, T73)">+</a></td><td nowrap>dbo.sp_WorkOrderDetail_CustomFields</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T73"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  procedure dbo.sp_WorkOrderDetail_CustomFields</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Action char(1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Id int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@UserId int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar1 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar2 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar3 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar4 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar5 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar6 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar7 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar8 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar9 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar10 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar11 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar12 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar13 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar14 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar15 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar16 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar17 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar18 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar19 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar20 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar21 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar22 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar23 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar24 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar25 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar26 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar27 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar28 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar29 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar30 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar31 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@nvarchar32 nvarchar(255)=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@int1 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@int2 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@int3 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@int4 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@int5 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@int6 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@int7 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@int8 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@lookup1 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@lookup2 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@lookup3 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@lookup4 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@lookup5 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@lookup6 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@lookup7 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@lookup8 int=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@float1 float=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@float2 float=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@float3 float=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@float4 float=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@float5 float=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@float6 float=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@float7 float=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@float8 float=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@datetime1 datetime=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@datetime2 datetime=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@datetime3 datetime=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@datetime4 datetime=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@datetime5 datetime=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@datetime6 datetime=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@datetime7 datetime=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@datetime8 datetime=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bit1 bit=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bit2 bit=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bit3 bit=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bit4 bit=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bit5 bit=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bit6 bit=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bit7 bit=null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@bit8 bit=null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action='S'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- select</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrders WO inner join EquipData ED</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on WO.[Id] = @Id and WO.[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WO.[DataId] = ED.[Id] and  ED.[OrgId] = WO.[OrgId])</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true' from CustFieldDef where OrgId = @OrgId and DataTypeId = 3)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	WorkOrders.[Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					WorkOrders.[DataId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar1],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar2],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar3],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar4],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar5],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar6],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar7],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar8],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar9],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar10],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar11],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar12],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar13],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar14],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar15],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar16],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar17],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar18],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar19],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar20],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar21],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar22],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar23],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar24],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar25],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar26],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar27],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar28],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar29],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar30],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar31],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[nvarchar32],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[int1],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[int2],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[int3],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[int4],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[int5],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[int6],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[int7],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[int8],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[lookup1],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[lookup2],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[lookup3],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[lookup4],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[lookup5],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[lookup6],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[lookup7],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[lookup8],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[float1],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[float2],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[float3],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[float4],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[float5],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[float6],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[float7],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[float8],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[datetime1],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[datetime2],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[datetime3],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[datetime4],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[datetime5],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[datetime6],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[datetime7],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[datetime8],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[bit1],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[bit2],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[bit3],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[bit4],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[bit5],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[bit6],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[bit7],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					EquipData.[bit8]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				inner join EquipData</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				on EquipData.[Id] = WorkOrders.DataId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and EquipData.OrgId = WorkOrders.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrders.[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrders.[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action='U'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin -- update EquipData</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrders WO inner join EquipData ED</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on WO.[DataId] = ED.[Id] and WO.[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WO.[Id] = @Id and  ED.[OrgId] = WO.[OrgId])</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			update 	[EquipData]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set 	[OrgId]=@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[intUpdatedBy]=@UserId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtUpdated]=getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar1]=@nvarchar1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar2]=@nvarchar2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar3]=@nvarchar3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar4]=@nvarchar4,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar5]=@nvarchar5,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar6]=@nvarchar6,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar7]=@nvarchar7,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar8]=@nvarchar8,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar9]=@nvarchar9,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar10]=@nvarchar10,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar11]=@nvarchar11,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar12]=@nvarchar12,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar13]=@nvarchar13,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar14]=@nvarchar14,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar15]=@nvarchar15,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar16]=@nvarchar16,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar17]=@nvarchar17,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar18]=@nvarchar18,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar19]=@nvarchar19,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar20]=@nvarchar20,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar21]=@nvarchar21,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar22]=@nvarchar22,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar23]=@nvarchar23,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar24]=@nvarchar24,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar25]=@nvarchar25,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar26]=@nvarchar26,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar27]=@nvarchar27,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar28]=@nvarchar28,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar29]=@nvarchar29,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar30]=@nvarchar30,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar31]=@nvarchar31,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[nvarchar32]=@nvarchar32,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[int1]=@int1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[int2]=@int2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[int3]=@int3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[int4]=@int4,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[int5]=@int5,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[int6]=@int6,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[int7]=@int7,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[int8]=@int8,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[lookup1]=@lookup1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[lookup2]=@lookup2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[lookup3]=@lookup3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[lookup4]=@lookup4,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[lookup5]=@lookup5,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[lookup6]=@lookup6,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[lookup7]=@lookup7,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[lookup8]=@lookup8,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[float1]=@float1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[float2]=@float2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[float3]=@float3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[float4]=@float4,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[float5]=@float5,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[float6]=@float6,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[float7]=@float7,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[float8]=@float8,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[datetime1]=@datetime1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[datetime2]=@datetime2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[datetime3]=@datetime3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[datetime4]=@datetime4,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[datetime5]=@datetime5,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[datetime6]=@datetime6,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[datetime7]=@datetime7,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[datetime8]=@datetime8,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[bit1]=@bit1,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[bit2]=@bit2,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[bit3]=@bit3,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[bit4]=@bit4,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[bit5]=@bit5,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[bit6]=@bit6,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[bit7]=@bit7,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[bit8]=@bit8</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from 	WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where	WorkOrders.[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	WorkOrders.[OrgId] = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	EquipData.[Id] = WorkOrders.[DataId]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V74" class="bodytxt" href="javascript:ShowComparison(V74, T74)">+</a></td><td nowrap>dbo.sp_WorkOrderInspectionsDetail</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T74"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_WorkOrderInspectionsDetail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Action char(1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Id int output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectSchedDetailId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@TechId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtReport datetime=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@btIsProcessed bit=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @tbl table ([Id] int identity(1,1), RepairItemId int)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @tbl2 table ([Id] int identity(1, 1), RepairId int)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @IsDelete bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @i int, @N int, @j int, @M int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'S'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrderInspections where OrgId = @OrgId and [Id] = @Id)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@WorkOrderId = WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@InspectSchedDetailId = InspectSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@TechId = TechId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtReport = dtReport,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@btIsProcessed = btIsProcessed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrderInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'U'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @Id = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- insert</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into WorkOrderInspections(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[InspectSchedDetailId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[TechId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtReport],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[btIsProcessed]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@InspectSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				WO.intTechId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				getdate(),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrders WO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @Id = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [WorkOrderInspectItems](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderInspectId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceResultId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceCheckId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[RepairItemId]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@Id,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				II.[Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from InspectionItems II</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			inner join InspectSchedDetails ISD</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			on ISD.[Id] = @InspectSchedDetailId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and ISD.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and II.InspectId = ISD.InspectionId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and II.OrgId = ISD.OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and II.btEnabled = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			order by II.InspectCatId, II.tintOrder asc</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- update</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true' from WorkOrderInspections where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	[WorkOrderInspections]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	[WorkOrderId] = @WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[InspectSchedDetailId] = @InspectSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[TechId] = @TechId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[dtReport] = @dtReport,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[btIsProcessed] = @btIsProcessed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'D'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrderInspections where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- define all RepairItemIds related to the Inspection</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into @tbl(RepairItemId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where WorkOrderInspectId = isnull(@Id, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and isnull(RepairItemId, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- processing all repairs, if repair has the other sources</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- as PM items or Issues then we don't delete this repair</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- or else we delete records of RepairMult, PartsUsed and</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- Repairs tables</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @i = 1, @N = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			while @i <= @N</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderPMItems PMI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join @tbl tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on PMI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and PMI.WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and PMI.RepairItemId = tmp.RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and tmp.[Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderReportedIssues RI</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					inner join @tbl tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					on RI.OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RI.WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RI.RepairItemId = tmp.RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and tmp.[Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- deleting the relate records</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					insert into @tbl2(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and ItemId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from @tbl</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @j = 1, @M = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and ItemId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						from @tbl</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where [Id] = @i</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- deleting all repairs, if repair has other issues (or other item)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- then don't delete it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					while @j <= @M</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						if not exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								from @tbl2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								where [Id] = @j</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and RepairId in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								from @tbl2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								where [Id] = @j</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and [Id] in (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								from @tbl2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								where [Id] = @j</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select @j = @j + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @i = @i + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- delete inspection items</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			delete from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [WorkOrderInspectId] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- delete inspection</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			delete from WorkOrderInspections</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V75" class="bodytxt" href="javascript:ShowComparison(V75, T75)">+</a></td><td nowrap>dbo.sp_WorkOrderInspectItemsDetail</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T75"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE  PROCEDURE dbo.sp_WorkOrderInspectItemsDetail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Action char(1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Id int output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderInspectId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@InspectionItemId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceResultId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceCheckId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairItemId int=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'S'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if isnull(@Id, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true' from WorkOrderInspectItems where OrgId = @OrgId and WorkOrderInspectId = @WorkOrderInspectId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	@Id = [Id],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@WorkOrderId = WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@InspectionItemId = ItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@ServiceResultId = ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@ServiceCheckId = ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@RepairItemId = RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and WorkOrderInspectId = @WorkOrderInspectId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true' from WorkOrderInspectItems where OrgId = @OrgId and [Id] = @Id)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select 	@WorkOrderId = WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@WorkOrderInspectId = WorkOrderInspectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@InspectionItemId = ItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@ServiceResultId = ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@ServiceCheckId = ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					@RepairItemId = RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'U'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @Id = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- insert</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into WorkOrderInspectItems(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderInspectId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceResultId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceCheckId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[RepairItemId]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderInspectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@InspectionItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @Id = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- update</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true' from WorkOrderInspectItems where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	[WorkOrderInspectItems]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	[WorkOrderId] = @WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[WorkOrderInspectId] = @WorkOrderInspectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[ItemId] = @InspectionItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[ServiceResultId] = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[ServiceCheckId] = @ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[RepairItemId] = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V76" class="bodytxt" href="javascript:ShowComparison(V76, T76)">+</a></td><td nowrap>dbo.sp_WorkOrderPMItemsDetail</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T76"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE procedure dbo.sp_WorkOrderPMItemsDetail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Action char(1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Id int output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@PMSchedDetailId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceResultId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceCheckId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairItemId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtReport datetime=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @IsDelete bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	create table #tmp(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[Id] int identity(1, 1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		RepairId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'S'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrderPMItems where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@WorkOrderId = WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@PMSchedDetailId = PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceResultId = ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceCheckId = ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairItemId = RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtReport = dtReport</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'U'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @Id = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- insert</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into [WorkOrderPMItems](</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[PMSchedDetailId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceResultId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceCheckId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[RepairItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtReport]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				getdate()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @Id = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- update</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true' from WorkOrderPMItems where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				update 	[WorkOrderPMItems]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				set 	[WorkOrderId] = @WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[PMSchedDetailId] = @PMSchedDetailId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[ServiceResultId] = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[ServiceCheckId] = @ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[RepairItemId] = @RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					[dtReport]=@dtReport</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'D'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrderPMItems where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- delete issues and all data relating to him</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- from RepairMult. Repairs and PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@RepairItemId = isnull(RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if isnull(@RepairItemId, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and [Id] <> @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- processing all repairs for delete</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					insert into #tmp(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairId in (select RepairId from #tmp)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and [Id] in (select RepairId from #tmp)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				delete from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	drop table #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V77" class="bodytxt" href="javascript:ShowComparison(V77, T77)">+</a></td><td nowrap>dbo.sp_WorkOrderReportedIssuesDetail</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T77"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE   PROCEDURE dbo.sp_WorkOrderReportedIssuesDetail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Action char(1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@OrgId int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@Id int output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@EquipId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@vchDesc varchar(4000)=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@WorkOrderId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@LastWorkOrderId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairCatId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceResultId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@ServiceCheckId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@RepairItemId int=null output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		@dtReport datetime=null output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">AS</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @IsDelete bit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	create table #tmp(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		[Id] int identity(1, 1),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		RepairId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'S'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrderReportedIssues where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@vchDesc = vchDesc,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderId = WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@LastWorkOrderId = LastWorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@EquipId = EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairCatId = RepairCatId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceResultId = ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceCheckId = ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairItemId = RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@dtReport = dtReport</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'U'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if @Id = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- insert</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if isnull(@EquipId, 0) = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @EquipId = EquipId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				from WorkOrders</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			insert into WorkOrderReportedIssues(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[OrgId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[EquipId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[vchDesc],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[WorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[LastWorkOrderId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[RepairCatId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceResultId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[ServiceCheckId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[RepairItemId],</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				[dtReport]</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values(</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@OrgId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@vchDesc,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairCatId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				getdate()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select @Id = scope_identity()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin -- update</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if not exists(select 'true' from WorkOrderReportedIssues where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if isnull(@WorkOrderId, 0) <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- updating issue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					update 	 WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					set 	[EquipId] = @EquipId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[vchDesc] = @vchDesc,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[WorkOrderId] = @WorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[LastWorkOrderId] = @LastWorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[RepairCatId] = @RepairCatId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[ServiceResultId] = @ServiceResultId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[ServiceCheckId] = @ServiceCheckId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[RepairItemId] = @RepairItemId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						[dtReport] = @dtReport</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- unassign issue from order</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- update issue and delete all data relating to him</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					-- from RepairMult. Repairs and PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select 	@WorkOrderId = isnull(WorkOrderId, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						@RepairItemId = isnull(RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					if @RepairItemId <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and [Id] <> @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin -- processing all repairs for delete</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							insert into #tmp(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							update 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							set 	[WorkOrderId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[LastWorkOrderId] = @LastWorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[vchDesc] = @vchDesc,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[RepairCatId] = @RepairCatId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[ServiceResultId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[ServiceCheckId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[RepairItemId] = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and RepairId in (select RepairId from #tmp)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and [Id] in (select RepairId from #tmp)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							update 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							set 	[WorkOrderId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[LastWorkOrderId] = @LastWorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[vchDesc] = @vchDesc,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[RepairCatId] = @RepairCatId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[ServiceResultId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[ServiceCheckId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">								[RepairItemId] = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						update 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						set 	[WorkOrderId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							[LastWorkOrderId] = @LastWorkOrderId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							[vchDesc] = @vchDesc,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							[RepairCatId] = @RepairCatId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							[ServiceResultId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							[ServiceCheckId] = null,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">							[RepairItemId] = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">						and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if @Action = 'D'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists(select 'true' from WorkOrderReportedIssues where [Id] = @Id and OrgId = @OrgId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return -1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- delete issues and all data relating to him</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			-- from RepairMult. Repairs and PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			select 	@WorkOrderId = isnull(WorkOrderId, 0),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				@RepairItemId = isnull(RepairItemId, 0)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from 	WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where 	[Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			and 	OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if @RepairItemId <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				select @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderPMItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and [Id] <> @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if exists(select 'true'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from WorkOrderInspectItems</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and WorkOrderId = @WorkOrderId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select @IsDelete = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				if @IsDelete = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin -- processing all repairs for delete</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					insert into #tmp(RepairId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					select RepairId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from RepairMult</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where ItemId = @RepairItemId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from PartsUsed</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and RepairId in (select RepairId from #tmp)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from Repairs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and [Id] in (select RepairId from #tmp)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					delete from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">					and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				delete from WorkOrderReportedIssues</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				where [Id] = @Id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				and OrgId = @OrgId</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	drop table #tmp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
</table></td></tr>
</table></P></body></html>
