<html>
<head>
<title>SQL Delta Structure Comparison Report</title>
<script language="javascript">
   function ShowComparison(oLink, oDisplay) {
      if (oDisplay.style.display == 'none') {
         oDisplay.style.display = '';
         oLink.innerText = '-';
      } else {
         oDisplay.style.display = 'none';
         oLink.innerText = '+';
      }
   }
</script>
<style>
.headingtxt {font:16pt,verdana, Arial, Helvetica, sans-serif; font-weight: bold; background-color: #E8A623; color: #FFFFFF; line-height: 35px; BORDER-TOP: black 1px solid; BORDER-BOTTOM: black 1px solid}
.sectiontxt {font:12pt,verdana, Arial, Helvetica, sans-serif; font-weight: bold; color: #000000}
.datalink {font:12pt,verdana, Arial, Helvetica, sans-serif; font-weight: bold; text-decoration:none; color: blue}
.headertxt {font: 10pt, verdana, Arial, Helvetica, sans-serif; font-weight: bold; color: #000000}
.itemtxt {font: 10pt, verdana, Arial, Helvetica, sans-serif; color: #E8A623}
.bodytxt {font: 10pt, verdana, Arial, Helvetica, sans-serif; text-decoration:none; color: #000000}
.normlink {font: 10pt, verdana, Arial, Helvetica, sans-serif; text-decoration:none; color: blue}
.added {font: 10pt, verdana, Arial, Helvetica, sans-serif; color: red}
.deleted {font: 10pt, verdana, Arial, Helvetica, sans-serif; color: blue}
.smltxt {font: 8pt, Arial, Helvetica, sans-serif; color: #000000}
.modified {font: 8pt, Arial, Helvetica, sans-serif; color: red}
</style>
</head>
<body>
<P align="center" class="headingtxt">SQL Delta Structure Comparison Report</P>
<P align="left">
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr class="sectiontxt"><td>Databases</td></tr>
</table>
<table border="0" cellspacing="0" cellpadding="0" width="80%">
<tr height="4"><td colspan="3"></td></tr>
<tr><td width="1%"></td><td width="19%" nowrap class="itemtxt">Database A:</td><td width="80%" nowrap class="bodytxt">largo.BFS_Beta</td></tr>
<tr height="4"><td colspan="3"></td></tr>
<tr><td></td><td nowrap class="itemtxt">Database B:</td><td nowrap class="bodytxt">largo.BFS_Temp</td></tr>
<tr height="4"><td colspan="3"></td></tr>
<tr><td></td><td nowrap class="itemtxt">Comparison Date:</td><td nowrap class="bodytxt">4/27/2006</td></tr>
</table></P>
<P align="left"><div class="sectiontxt">Comparison Summary</div>
<table border="0" cellspacing="0" cellpadding="0" width="80%">
<tr height="15"><td colspan="2"></td></tr>
<tr><td width="1%"></td><td width="99%">
<table class="bodytxt" border="1" cellpadding="2" width="100%" bordercolordark="#FFFFFF">
<tr height="25" class="headertxt"><td width="30%" nowrap>Object Type</td><td width="17%" nowrap align="center">Identical</td><td width="18%" nowrap align="center">Missing From A</td><td width="18%" nowrap align="center">Missing From B</td><td width="17%" nowrap align="center">Modified</td></tr>
<tr height="25"><td nowrap><a href="#tables" class="normlink">Tables</a></td><td nowrap align="right">68&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap><a href="#views" class="normlink">Views</a></td><td nowrap align="right">1&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap><a href="#procedures" class="normlink">Procedures</a></td><td nowrap align="right">193&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">30&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap><a href="#triggers" class="normlink">Triggers</a></td><td nowrap align="right">13&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap><a href="#functions" class="normlink">Functions</a></td><td nowrap align="right">3&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Defaults</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Rules</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>User Types</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Users</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Roles</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
<tr height="25"><td nowrap>Full-Text Catalogs</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td><td nowrap align="right">&nbsp;</td></tr>
</table></td></tr></table></P>
<P align="left"><div class="sectiontxt">Comparison Results</div><table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr height="8"><td colspan="2"></td></tr>
<tr height="15"><td width="1%"></td><td><a name="procedures" class="itemtxt">Procedures</a></td></tr>
<tr height="8"><td colspan="2"></td></tr>
<tr><td></td><td width="99%">
<table class="bodytxt" border="1" cellpadding="2" width="100%" bordercolordark="#FFFFFF">
<tr height="25" class="headertxt"><td width="5%">&nbsp;</td><td width="30%" nowrap>Name</td><td width="10%" nowrap align="center">Status</td><td width="55%" nowrap align="center">Action</td></tr>
<tr height="25"><td nowrap align="center"><a id="V0" class="bodytxt" href="javascript:ShowComparison(V0, T0)">+</a></td><td nowrap>dbo.dt_addtosourcecontrol</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T0"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_addtosourcecontrol</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchSourceSafeINI varchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchProjectName   varchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment       varchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName     varchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword      varchar(255) =''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iStreamObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchDatabaseName varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @vchDatabaseName = db_name()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchParentId varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iObjectCount int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectCount = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* Create Project in SS */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                'AddProjectToSourceSafe',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchProjectName output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @@SERVERNAME,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchComment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OAGetProperty @iObjectId, 'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* Set Database Properties */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    begin tran SetProperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* add high level object */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iPropertyObjectId = dbo.dt_adduserobject_vcs 'VCSProjectID'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @vchParentId = CONVERT(varchar(255),@iPropertyObjectId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSProjectID', @vchParentId , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSProject' , @vchProjectName , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSSourceSafeINI' , @vchSourceSafeINI , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSSQLServer', @@SERVERNAME, NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid @iPropertyObjectId, 'VCSSQLDatabase', @vchDatabaseName, NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @@error <> 0 GOTO E_General_Error</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    commit tran SetProperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare cursorProcNames cursor for</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select convert(varchar(255), name) from sysobjects where type = 'P' and name not like 'dt_%'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    open cursorProcNames</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    while 1 = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        declare @vchProcName varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        fetch next from cursorProcNames into @vchProcName</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @@fetch_status <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            break</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select colid, text into #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        from syscomments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        where id = object_id(@vchProcName)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        order by colid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        declare @iCurProcLine int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        declare @iProcLines int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @iCurProcLine = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @iProcLines = (select count(*) from #ProcLines)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        while @iCurProcLine <= @iProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @pos int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @pos = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iCurLineSize int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iCurLineSize = len((select text from #ProcLines where colid = @iCurProcLine))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            while @pos <= @iCurLineSize</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                declare @vchProcLinePiece varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @vchProcLinePiece = convert(varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    substring((select text from #ProcLines where colid = @iCurProcLine),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                              @pos, 255 ))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                exec @iReturn = sp_OAMethod @iStreamObjectId, 'AddStream', @iReturnValue OUT, @vchProcLinePiece</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @pos = @pos + 255</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iCurProcLine = @iCurProcLine + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        drop table #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    'CheckIn_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sServerName = @@SERVERNAME,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sObjectName = @vchProcName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @iVCSFlags = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @iActionFlag = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sStream = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn = 0 select @iObjectCount = @iObjectCount + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	close cursorProcNames</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	deallocate cursorProcNames</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @vchProjectName</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iObjectCount</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_General_Error:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    /* this is an all or nothing.  No specific error messages */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V1" class="bodytxt" href="javascript:ShowComparison(V1, T1)">+</a></td><td nowrap>dbo.dt_addtosourcecontrol_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T1"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_addtosourcecontrol_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchSourceSafeINI nvarchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchProjectName   nvarchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment       nvarchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName     nvarchar(255) ='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword      nvarchar(255) =''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iStreamObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID nvarchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = N'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchDatabaseName varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @vchDatabaseName = db_name()</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchParentId nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iObjectCount int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectCount = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* Create Project in SS */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                'AddProjectToSourceSafe',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchProjectName output,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @@SERVERNAME,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @vchComment</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OAGetProperty @iObjectId, N'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* Set Database Properties */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    begin tran SetProperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* add high level object */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iPropertyObjectId = dbo.dt_adduserobject_vcs 'VCSProjectID'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @vchParentId = CONVERT(nvarchar(255),@iPropertyObjectId)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid_u @iPropertyObjectId, 'VCSProjectID', @vchParentId , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid_u @iPropertyObjectId, 'VCSProject' , @vchProjectName , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid_u @iPropertyObjectId, 'VCSSourceSafeINI' , @vchSourceSafeINI , NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid_u @iPropertyObjectId, 'VCSSQLServer', @@SERVERNAME, NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_setpropertybyid_u @iPropertyObjectId, 'VCSSQLDatabase', @vchDatabaseName, NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @@error <> 0 GOTO E_General_Error</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    commit tran SetProperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare cursorProcNames cursor for</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select convert(nvarchar(255), name) from sysobjects where type = N'P' and name not like N'dt_%'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    open cursorProcNames</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    while 1 = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        declare @vchProcName nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        fetch next from cursorProcNames into @vchProcName</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @@fetch_status <> 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            break</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select colid, text into #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        from syscomments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        where id = object_id(@vchProcName)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        order by colid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        declare @iCurProcLine int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        declare @iProcLines int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @iCurProcLine = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @iProcLines = (select count(*) from #ProcLines)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        while @iCurProcLine <= @iProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @pos int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @pos = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iCurLineSize int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iCurLineSize = len((select text from #ProcLines where colid = @iCurProcLine))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            while @pos <= @iCurLineSize</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                declare @vchProcLinePiece nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @vchProcLinePiece = convert(nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    substring((select text from #ProcLines where colid = @iCurProcLine),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                              @pos, 255 ))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                exec @iReturn = sp_OAMethod @iStreamObjectId, N'AddStream', @iReturnValue OUT, @vchProcLinePiece</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @pos = @pos + 255</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iCurProcLine = @iCurProcLine + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        drop table #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    'CheckIn_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sServerName = @@SERVERNAME,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sObjectName = @vchProcName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @iVCSFlags = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @iActionFlag = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sStream = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn = 0 select @iObjectCount = @iObjectCount + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	close cursorProcNames</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	deallocate cursorProcNames</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @vchProjectName</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iObjectCount</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_General_Error:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    /* this is an all or nothing.  No specific error messages */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror_u @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V2" class="bodytxt" href="javascript:ShowComparison(V2, T2)">+</a></td><td nowrap>dbo.dt_adduserobject</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T2"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Add an object to the dtproperties table</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_adduserobject</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	** Create the user object if it does not exist already</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin transaction</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert dbo.dtproperties (property) VALUES ('DtgSchemaOBJECT')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update dbo.dtproperties set objectid=@@identity</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where id=@@identity and property='DtgSchemaOBJECT'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	commit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return @@identity</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V3" class="bodytxt" href="javascript:ShowComparison(V3, T3)">+</a></td><td nowrap>dbo.dt_adduserobject_vcs</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T3"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_adduserobject_vcs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchProperty varchar(64)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    /*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    ** Create the user object if it does not exist already</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin transaction</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @iReturn = objectid from dbo.dtproperties where property = @vchProperty</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn IS NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            insert dbo.dtproperties (property) VALUES (@vchProperty)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            update dbo.dtproperties set objectid=@@identity</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    where id=@@identity and property=@vchProperty</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iReturn = @@identity</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    commit</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V4" class="bodytxt" href="javascript:ShowComparison(V4, T4)">+</a></td><td nowrap>dbo.dt_checkinobject</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T4"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_checkinobject</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchObjectName varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment    varchar(255)='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   varchar(255)='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iVCSFlags     int = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iActionFlag   int = 0,   /* 0 => AddFile, 1 => CheckIn */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream1     Text = '', /* There is a bug that if items are NULL they do not pass to OLE servers */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream2     Text = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream3     Text = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iPropertyObjectId  = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            /* Procedure Can have up to three streams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            Drop Stream, Create Stream, GRANT stream */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            begin tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            /* try to compile the streams */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec (@txStream1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec (@txStream2)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec (@txStream3)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        'CheckIn_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @iActionFlag = @iActionFlag,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sStream = @txStream2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAGetProperty @iObjectId, 'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            select colid, text into #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            from syscomments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            where id = object_id(@vchObjectName)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            order by colid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            declare @iCurProcLine int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iProcLines int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iCurProcLine = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iProcLines = (select count(*) from #ProcLines)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            while @iCurProcLine <= @iProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                declare @pos int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @pos = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                declare @iCurLineSize int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @iCurLineSize = len((select text from #ProcLines where colid = @iCurProcLine))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                while @pos <= @iCurLineSize</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    declare @vchProcLinePiece varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    select @vchProcLinePiece = convert(varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                        substring((select text from #ProcLines where colid = @iCurProcLine),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                  @pos, 255 ))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    exec @iReturn = sp_OAMethod @iStreamObjectId, 'AddStream', @iReturnValue OUT, @vchProcLinePiece</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    select @pos = @pos + 255</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @iCurProcLine = @iCurProcLine + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            drop table #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        'CheckIn_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @iActionFlag = @iActionFlag,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sStream = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            commit tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_Compile_Fail:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @lerror int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @lerror = @@error</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    rollback tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    RAISERROR (@lerror,16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iActionFlag = 1 rollback tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V5" class="bodytxt" href="javascript:ShowComparison(V5, T5)">+</a></td><td nowrap>dbo.dt_checkinobject_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T5"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_checkinobject_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchObjectName nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment    nvarchar(255)='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   nvarchar(255)='',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iVCSFlags     int = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iActionFlag   int = 0,   /* 0 => AddFile, 1 => CheckIn */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream1     Text = '', /* There is a bug that if items are NULL they do not pass to OLE servers */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream2     Text = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @txStream3     Text = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID nvarchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = N'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iPropertyObjectId  = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            /* Procedure Can have up to three streams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            Drop Stream, Create Stream, GRANT stream */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            begin tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            /* try to compile the streams */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec (@txStream1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec (@txStream2)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec (@txStream3)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        N'CheckIn_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @iActionFlag = @iActionFlag,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sStream = @txStream2</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAGetProperty @iObjectId, N'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            select colid, text into #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            from syscomments</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            where id = object_id(@vchObjectName)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            order by colid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            declare @iCurProcLine int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            declare @iProcLines int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iCurProcLine = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            select @iProcLines = (select count(*) from #ProcLines)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            while @iCurProcLine <= @iProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                declare @pos int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @pos = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                declare @iCurLineSize int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @iCurLineSize = len((select text from #ProcLines where colid = @iCurProcLine))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                while @pos <= @iCurLineSize</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    declare @vchProcLinePiece nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    select @vchProcLinePiece = convert(nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                        substring((select text from #ProcLines where colid = @iCurProcLine),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                  @pos, 255 ))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    exec @iReturn = sp_OAMethod @iStreamObjectId, N'AddStream', @iReturnValue OUT, @vchProcLinePiece</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                    select @pos = @pos + 255</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                select @iCurProcLine = @iCurProcLine + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            drop table #ProcLines</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        N'CheckIn_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @iActionFlag = @iActionFlag,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                        @sStream = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iActionFlag = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            commit tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @@error <> 0 GOTO E_Compile_Fail</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_Compile_Fail:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @lerror int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @lerror = @@error</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    rollback tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    RAISERROR (@lerror,16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iActionFlag = 1 rollback tran compile_all</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror_u @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V6" class="bodytxt" href="javascript:ShowComparison(V6, T6)">+</a></td><td nowrap>dbo.dt_checkoutobject</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T6"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_checkoutobject</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchObjectName varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment    varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iVCSFlags     int = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iActionFlag   int = 0/* 0 => Checkout, 1 => GetLatest, 2 => UndoCheckOut */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchTempText varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">/* this is for our strings */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iStreamObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        /* Procedure Can have up to three streams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">           Drop Stream, Create Stream, GRANT stream */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    'CheckOut_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @iActionFlag = @iActionFlag</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAGetProperty @iObjectId, 'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        create table #commenttext (id int identity, sourcecode varchar(255))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchTempText = 'STUB'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        while @vchTempText IS NOT NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAMethod @iStreamObjectId, 'GetStream', @iReturnValue OUT, @vchTempText OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            if (@vchTempText IS NOT NULL) insert into #commenttext (sourcecode) select @vchTempText</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select 'VCS'=sourcecode from #commenttext order by id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select 'SQL'=text from syscomments where id = object_id(@vchObjectName) order by colid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V7" class="bodytxt" href="javascript:ShowComparison(V7, T7)">+</a></td><td nowrap>dbo.dt_checkoutobject_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T7"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_checkoutobject_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchObjectName nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchComment    nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iVCSFlags     int = 0,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iActionFlag   int = 0/* 0 => Checkout, 1 => GetLatest, 2 => UndoCheckOut */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID nvarchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = N'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchTempText nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">/* this is for our strings */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iStreamObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        /* Procedure Can have up to three streams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">           Drop Stream, Create Stream, GRANT stream */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    N'CheckOut_StoredProcedure',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sComment = @vchComment,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sPassword = @vchPassword,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @iVCSFlags = @iVCSFlags,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @iActionFlag = @iActionFlag</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAGetProperty @iObjectId, N'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        create table #commenttext (id int identity, sourcecode nvarchar(255))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchTempText = N'STUB'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        while @vchTempText IS NOT NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAMethod @iStreamObjectId, N'GetStream', @iReturnValue OUT, @vchTempText OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            if (@vchTempText IS NOT NULL) insert into #commenttext (sourcecode) select @vchTempText</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select N'VCS'=sourcecode from #commenttext order by id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select N'SQL'=text from syscomments where id = object_id(@vchObjectName) order by colid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror_u @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V8" class="bodytxt" href="javascript:ShowComparison(V8, T8)">+</a></td><td nowrap>dbo.dt_displayoaerror</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T8"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE PROCEDURE dbo.dt_displayoaerror</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iObject int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iresult int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchOutput      varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @hr             int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchSource      varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchDescription varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @hr = sp_OAGetErrorInfo @iObject, @vchSource OUT, @vchDescription OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @vchOutput = @vchSource + ': ' + @vchDescription</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    raiserror (@vchOutput,16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V9" class="bodytxt" href="javascript:ShowComparison(V9, T9)">+</a></td><td nowrap>dbo.dt_displayoaerror_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T9"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">CREATE PROCEDURE dbo.dt_displayoaerror_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iObject int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iresult int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchOutput      nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @hr             int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchSource      nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @vchDescription nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @hr = sp_OAGetErrorInfo @iObject, @vchSource OUT, @vchDescription OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @vchOutput = @vchSource + ': ' + @vchDescription</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    raiserror (@vchOutput,16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V10" class="bodytxt" href="javascript:ShowComparison(V10, T10)">+</a></td><td nowrap>dbo.dt_droppropertiesbyid</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T10"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Drop one or all the associated properties of an object or an attribute</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_dropproperties objid, null or '' -- drop all properties of the object itself</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_dropproperties objid, property -- drop the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_droppropertiesbyid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		delete from dbo.dtproperties where objectid=@id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		delete from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V11" class="bodytxt" href="javascript:ShowComparison(V11, T11)">+</a></td><td nowrap>dbo.dt_dropuserobjectbyid</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T11"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Drop an object from the dbo.dtproperties table</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_dropuserobjectbyid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	delete from dbo.dtproperties where objectid=@id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V12" class="bodytxt" href="javascript:ShowComparison(V12, T12)">+</a></td><td nowrap>dbo.dt_generateansiname</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T12"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Generate an ansi name that is unique in the dtproperties.value column</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_generateansiname(@name varchar(255) output)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @prologue varchar(20)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @indexstring varchar(20)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @index integer</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @prologue = 'MSDT-A-'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @index = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	while 1 = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set @indexstring = cast(@index as varchar(20))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set @name = @prologue + @indexstring</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if not exists (select value from dtproperties where value = @name)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			break</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		set @index = @index + 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if (@index = 10000)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			goto TooMany</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">Leave:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">TooMany:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified"></font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @name = 'DIAGRAM'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	goto Leave</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V13" class="bodytxt" href="javascript:ShowComparison(V13, T13)">+</a></td><td nowrap>dbo.dt_getobjwithprop</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T13"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Retrieve the owner object(s) of a given property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getobjwithprop</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(30),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@value varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		raiserror('Must specify a property name.',-1,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return (1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@value is null)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select objectid id from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select objectid id from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where property=@property and value=@value</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V14" class="bodytxt" href="javascript:ShowComparison(V14, T14)">+</a></td><td nowrap>dbo.dt_getobjwithprop_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T14"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Retrieve the owner object(s) of a given property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getobjwithprop_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(30),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@uvalue nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		raiserror('Must specify a property name.',-1,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		return (1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@uvalue is null)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select objectid id from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select objectid id from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where property=@property and uvalue=@uvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V15" class="bodytxt" href="javascript:ShowComparison(V15, T15)">+</a></td><td nowrap>dbo.dt_getpropertiesbyid</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T15"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Retrieve properties by id's</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_getproperties objid, null or '' -- retrieve all properties of the object itself</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_getproperties objid, property -- retrieve the property specified</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getpropertiesbyid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select property, version, value, lvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where  @id=objectid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select property, version, value, lvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where  @id=objectid and @property=property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V16" class="bodytxt" href="javascript:ShowComparison(V16, T16)">+</a></td><td nowrap>dbo.dt_getpropertiesbyid_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T16"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	Retrieve properties by id's</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_getproperties objid, null or '' -- retrieve all properties of the object itself</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	dt_getproperties objid, property -- retrieve the property specified</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getpropertiesbyid_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	if (@property is null) or (@property = '')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select property, version, uvalue, lvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where  @id=objectid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		select property, version, uvalue, lvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where  @id=objectid and @property=property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V17" class="bodytxt" href="javascript:ShowComparison(V17, T17)">+</a></td><td nowrap>dbo.dt_getpropertiesbyid_vcs</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T17"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getpropertiesbyid_vcs</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @id       int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @property varchar(64),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @value    varchar(255) = NULL OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @value = (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select value</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                where @id=objectid and @property=property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                )</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V18" class="bodytxt" href="javascript:ShowComparison(V18, T18)">+</a></td><td nowrap>dbo.dt_getpropertiesbyid_vcs_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T18"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_getpropertiesbyid_vcs_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @id       int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @property varchar(64),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @value    nvarchar(255) = NULL OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @value = (</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select uvalue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                where @id=objectid and @property=property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                )</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V19" class="bodytxt" href="javascript:ShowComparison(V19, T19)">+</a></td><td nowrap>dbo.dt_isundersourcecontrol</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T19"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_isundersourcecontrol</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName varchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword  varchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iWhoToo      int = 0 /* 0 => Just check project; 1 => get list of objs */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iStreamObjectId   = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @vchTempText varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if (@vchProjectName IS NULL) or (@vchSourceSafeINI  IS NULL) or (@vchServerName IS NULL) or (@vchDatabaseName IS NULL)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        RAISERROR('Not Under Source Control',16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @iWhoToo = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        /* Get List of Procs in the project */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    'GetListOfObjects',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAGetProperty @iObjectId, 'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        create table #ObjectList (id int identity, vchObjectlist varchar(255))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchTempText = 'STUB'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        while @vchTempText IS NOT NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAMethod @iStreamObjectId, 'GetStream', @iReturnValue OUT, @vchTempText OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            if (@vchTempText IS NOT NULL) insert into #ObjectList (vchObjectlist ) select @vchTempText</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select vchObjectlist from #ObjectList order by id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V20" class="bodytxt" href="javascript:ShowComparison(V20, T20)">+</a></td><td nowrap>dbo.dt_isundersourcecontrol_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T20"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_isundersourcecontrol_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName nvarchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword  nvarchar(255) = '',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @iWhoToo      int = 0 /* 0 => Just check project; 1 => get list of objs */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @VSSGUID nvarchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @VSSGUID = N'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iReturnValue int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iReturnValue = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @iStreamObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select @iStreamObjectId   = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">	declare @vchTempText nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if (@vchProjectName IS NULL) or (@vchSourceSafeINI  IS NULL) or (@vchServerName IS NULL) or (@vchDatabaseName IS NULL)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        RAISERROR(N'Not Under Source Control',16,-1)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @iWhoToo = 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        /* Get List of Procs in the project */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    N'GetListOfObjects',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAGetProperty @iObjectId, N'GetStreamObject', @iStreamObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        create table #ObjectList (id int identity, vchObjectlist nvarchar(255))</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchTempText = N'STUB'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        while @vchTempText IS NOT NULL</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            exec @iReturn = sp_OAMethod @iStreamObjectId, N'GetStream', @iReturnValue OUT, @vchTempText OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">            if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">            if (@vchTempText IS NOT NULL) insert into #ObjectList (vchObjectlist ) select @vchTempText</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select vchObjectlist from #ObjectList order by id</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror_u @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    goto CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V21" class="bodytxt" href="javascript:ShowComparison(V21, T21)">+</a></td><td nowrap>dbo.dt_removefromsourcecontrol</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T21"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_removefromsourcecontrol</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec dbo.dt_droppropertiesbyid @iPropertyObjectId, null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    /* -1 is returned by dt_droppopertiesbyid */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @@error <> 0 and @@error <> -1 return 1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    return 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V22" class="bodytxt" href="javascript:ShowComparison(V22, T22)">+</a></td><td nowrap>dbo.dt_setpropertybyid</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T22"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	If the property already exists, reset the value; otherwise add property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		id -- the id in sysobjects of the object</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		property -- the name of the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		value -- the text value of the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		lvalue -- the binary value of the property (image)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_setpropertybyid</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@value varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@lvalue image</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @uvalue nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @uvalue = convert(nvarchar(255), @value)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists (select * from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- bump the version count for this row as we update it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update dbo.dtproperties set value=@value, uvalue=@uvalue, lvalue=@lvalue, version=version+1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- version count is auto-set to 0 on initial insert</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert dbo.dtproperties (property, objectid, value, uvalue, lvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values (@property, @id, @value, @uvalue, @lvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V23" class="bodytxt" href="javascript:ShowComparison(V23, T23)">+</a></td><td nowrap>dbo.dt_setpropertybyid_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T23"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	If the property already exists, reset the value; otherwise add property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		id -- the id in sysobjects of the object</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		property -- the name of the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		uvalue -- the text value of the property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**		lvalue -- the binary value of the property (image)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_setpropertybyid_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@id int,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@property varchar(64),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@uvalue nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	@lvalue image</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- If we are writing the name property, find the ansi equivalent.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	-- If there is no lossless translation, generate an ansi name.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	declare @avalue varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	set @avalue = null</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if (@uvalue is not null)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		if (convert(nvarchar(255), convert(varchar(255), @uvalue)) = @uvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			set @avalue = convert(varchar(255), @uvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			if 'DtgSchemaNAME' = @property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">				exec dbo.dt_generateansiname @avalue output</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	if exists (select * from dbo.dtproperties</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- bump the version count for this row as we update it</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		update dbo.dtproperties set value=@avalue, uvalue=@uvalue, lvalue=@lvalue, version=version+1</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			where objectid=@id and property=@property</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	else</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		-- version count is auto-set to 0 on initial insert</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		--</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">		insert dbo.dtproperties (property, objectid, value, uvalue, lvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">			values (@property, @id, @avalue, @uvalue, @lvalue)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V24" class="bodytxt" href="javascript:ShowComparison(V24, T24)">+</a></td><td nowrap>dbo.dt_validateloginparams</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T24"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_validateloginparams</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                'ValidateLoginParams',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @sPassword = @vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V25" class="bodytxt" href="javascript:ShowComparison(V25, T25)">+</a></td><td nowrap>dbo.dt_validateloginparams_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T25"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_validateloginparams_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchLoginName  nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    @vchPassword   nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID nvarchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = N'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                N'ValidateLoginParams',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                NULL,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                @sPassword = @vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror_u @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V26" class="bodytxt" href="javascript:ShowComparison(V26, T26)">+</a></td><td nowrap>dbo.dt_vcsenabled</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T26"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_vcsenabled</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId = 0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    if @iReturn <> 0 raiserror('', 16, -1) /* Can't Load Helper DLLC */</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V27" class="bodytxt" href="javascript:ShowComparison(V27, T27)">+</a></td><td nowrap>dbo.dt_verstamp006</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T27"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">/*</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**	This procedure returns the version number of the stored</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**    procedures used by the Microsoft Visual Database Tools.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">**    Current version is 7.0.00.</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">*/</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create procedure dbo.dt_verstamp006</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">	select 7000</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V28" class="bodytxt" href="javascript:ShowComparison(V28, T28)">+</a></td><td nowrap>dbo.dt_whocheckedout</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T28"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_whocheckedout</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchObjectName varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchLoginName  varchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchPassword   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID varchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = 'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        declare @vchReturnValue varchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @vchReturnValue = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    'WhoCheckedOut',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchReturnValue OUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sPassword = @vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchReturnValue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
<tr height="25"><td nowrap align="center"><a id="V29" class="bodytxt" href="javascript:ShowComparison(V29, T29)">+</a></td><td nowrap>dbo.dt_whocheckedout_u</td><td nowrap align="center"><font class="deleted">>></font></td><td nowrap>Delete from largo.BFS_Beta</td></tr>
<tr style="DISPLAY: none" id="T29"><td colspan="4">
<table class="smltxt" width="100%" cellspacing="0">
<tr><td width="48%"><font class="modified">-- Procedure</font></td><td width="4%" align="center"><font class="deleted">>></font></td><td width="48%"><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER OFF</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">create proc dbo.dt_whocheckedout_u</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @chObjectType  char(4),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchObjectName nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchLoginName  nvarchar(255),</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        @vchPassword   nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">as</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">set nocount on</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @iReturn int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">declare @iObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @iObjectId =0</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">declare @VSSGUID nvarchar(100)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">select @VSSGUID = N'SQLVersionControl.VCS_SQL'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @iPropertyObjectId int</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    select @iPropertyObjectId = (select objectid from dbo.dtproperties where property = 'VCSProjectID')</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    declare @vchProjectName   nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchSourceSafeINI nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchServerName    nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    declare @vchDatabaseName  nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSProject',       @vchProjectName   OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSourceSafeINI', @vchSourceSafeINI OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSQLServer',     @vchServerName    OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_getpropertiesbyid_vcs_u @iPropertyObjectId, 'VCSSQLDatabase',   @vchDatabaseName  OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    if @chObjectType = 'PROC'</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    begin</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OACreate @VSSGUID, @iObjectId OUT</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        declare @vchReturnValue nvarchar(255)</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">        select @vchReturnValue = ''</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        exec @iReturn = sp_OAMethod @iObjectId,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    N'WhoCheckedOut',</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @vchReturnValue OUT,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sProjectName = @vchProjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sSourceSafeINI = @vchSourceSafeINI,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sObjectName = @vchObjectName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sServerName = @vchServerName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sDatabaseName = @vchDatabaseName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sLoginName = @vchLoginName,</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">                                    @sPassword = @vchPassword</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        if @iReturn <> 0 GOTO E_OAError</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">        select @vchReturnValue</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">    end</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">CleanUp:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    return</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td></td><td align="center">==</td><td></td></tr>
<tr><td><font class="modified">E_OAError:</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    exec dbo.dt_displayoaerror_u @iObjectId, @iReturn</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">    GOTO CleanUp</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">SET QUOTED_IDENTIFIER ON</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
<tr><td><font class="modified">GO</font></td><td align="center"><font class="deleted">>></font></td><td><font class="modified"></font></td></tr>
</table></td></tr>
</table></td></tr>
</table></P></body></html>
